(***************************************************************)
(N10001 ORW   - KALIBROVKA DIAM DANDREA PO ZAMERU RENISHAW)
(N10002 OCRS  - AVTOKOREKCIJA OBICHNOGO INSTRUMENTA PO IZMERENIJAM RENISHAW)
(N10003 OCTS  - PROVERKA INSTYMENTA V NACHALE)
(N10004 OCTE  - PROVERKA INSTRUMENTA V KONCE)
(N10005 OCTI  - PROVERKA INSTRUMENTA NA POLOMKU)
(N10006 OTOSL - IZMERENIE INSTRYMENTA)
(N10007 OVC   - OBNULENIE GLOBALNIH PEREMENNIH)
(N10008 OUAX  - HP U-AXIS FOR TOOL-CHANGER tochka smeni)
(N10009 OBACK - BACKLACH COMPENSATION U-AXIS LUFT)
(N10010 OPHWD - OCRS, MACRO FOR PH)
(N10011 ORB   - VIRAVNIVANIE OSI B)
(N10012 ORPA  - PRIVJAZKA K DETALI PRI POMOSHI RENISHAW)
(N10013 OFFS  - TEORETICHESKOE POLOGENIE NULEVOI TOCHKI)
(N10014 OMCS  - KINEMATICHESKAJA TRANSFORMACIJA, AVTOPRIVJAZKA)
(N10015 OBSEL - VIBOR OBOROTOV)
(N10016 OPRS  - ORIENTACIJA SHPINDELJA)
(N10017 OPRW  - PRODUVKA SHARIKA RENISHAW T999 PRI POMOSHI BLUMA)
(N10018 OPRMV - UNIVERSALNAJA PROMIVKA PALLETi S ZAGATOI DETALU T996)
(N10019 OPRM  - TRAEKTORIJA PROMIVKI PALLET)
(N10020 OSKS  - PROCEDURA KALIBROVKI STANKA PROVERKA NA KAGDIE SUTKI)
(N10021 OHHE  - OBNULIT NULEVIE TOCHKI S No.1 po No.20 )
(N10022 OAPH  - AVTOPRIVJAZKA, POLOGENIE PRISPOSOBLENIJA NA STOLE, NOMER PALLETI)
(N10023 OCHP  - PROCEDURA SMENI PALLET)
(N10024 OCRR  - CALIBROVKA RENISHAW PO KOLCU, tolko NA KOLLONNE 150mm)
(N10025 OFOS  - VIVOD OSHIBKI NA FASTEMS - OSTANOVKA STANKA DLJA SNJATIJA STRUGKI S INSTRUMENTA)
(N10026 OFOU  - VIVOD OSHIBKI NA FASTEMS - OSTANOVKA STANKA DLJA PRODUVKI OTV OT STRUGKI)
(N10027 OPKLS - PROMIVKA i PRODUVKA ETALONA DLINNI INSTRUMENTA T998 PRI POMOSHI BLUM)
(N10028 OPKW  - PRODUVKA BLUMA PRI POMOSHI PRODUVOCHNOGO INSTRUMENTA T996)
(N10029 OEBS  - PROVERKA BIENIJA SHPINDELJA PRI POMOSHI ETALONA DLINI INSTRUMENTA T998 I BLUMA)
(N10030 OTSTB - PROVERKA NA POVTORJAEMOST IZM INSTR PO DIAM PRI POMOSHI ETALONA DLINI INSTRUMENTA T998 I BLUMA, SPOSOB - PEREOTKRITIE KRICHKI)
(N10031 OKK   - KALIBROVKA BLUM po Z i po Y s ZANESENIEM REZULTATOV KALIBROVKI PRI POMOSHI ETALONA DLINNI INSTRUMENTA T998)
(N10032 OKKP  - PROVERKA KALIBROVKI BLUMA NA PRAVILNOST POKAZANII po Z i po Y pri POMOSHI ETALONA DLINI INSTRUMENTA T998)
(N10033 OPRWB - PROMIVKA i PRODUVKA RENISHAW T999 PO VSEI DLINNE PRI POMOSHI BLUMA)
(N10034 OKFR  - ZAFIKSIROVAT, ZAPOMNIT VISOTU VIDVIGENIJA BLUMA PRI POMOSHI RENISHAW T999)
(N10035 OKPR  - PROVERIT VISOTU VIDVIGENIJA BLUMA PRI POMOSHI RENISHAW T999)
(N10036 OPRQ  - PROVERKA BIENIJA RENISHAW T999 V SHPINDELE PRI POMOSHI BLUMA)
(N10037 OTTT  - PERE-VIZOV INSTRUMENTA DLJA POPITKI PRODUVKI KONUSA INSTRUMENTA T996 T997)
(N10038 OPWW  - PRODUVKA KRISHKI BLUMA PRI POMOSHI PRODUVOCHNOGO INSTRUMENTA T996)
(N10039 OTSTA - PROVERKA NA POVTORJAEMOST IZM INSTR PO DIAM PRI POMOSHI ETALONA DLINI INSTRUMENTA T998 I BLUMA, SPOSOB - PROSTOi)
(N10040 OTSTC - PROVERKA NA POVTORJAEMOST IZM INSTR PO DIAM PRI POMOSHI ETALONA DLINI INSTRUMENTA T998 I BLUMA, SPOSOB - PERE-VIZOV INSTRUMENTA)
(N10041 OPRWA - PRODUVKA RENISHAW  T999 PO VSEI DLINNE PRI POMOSHI BLUMA)
(N10042 OPKLW - PRODUVKA ETALONA DLINNI INSTRUMENTA T998 PRI POMOSHI BLUMA)
(N10043 OPRTT - PRODUVKA INSTRUMENTA PRI POMOSHI BLUMA)
(N10044 OPTF  - VIVOD V VC900 GROUP + SERIAL  TOOL, PTOL=0 ACT_TOOL)
(N10045 OPPOT - POISK GNEZDA PO TG I TS, ZAPIS VC903)
(N10046 OPHWW - WRITE WEAR CORECTOR)
(N10047 OPHWR - READ vallue of WEAR OR CORECTOR in VC902)
(N10048 OBIP  - SAVE MAX WEAR U-axis/Std Tool, VIVOD V VC980 )
(N10049 OMIU  - COMPARE WEAR WITH STRUJKA, VIVOD V VSTOD[39] )
(N10050 OBMF  - IZMERENIE FREZERNOGO INSTRUMENTA)
(N10051 OBMU  - IZMERENIE DANDREA)
(N10052 OPRIN - VIVOD OTCHETA)
(N10053 OP01  -PRINT TO FILE OCTE OCTS OCTI)

N10001
ORW 
(KALIBROVKA DIAM DANDREA PO ZAMERU RENISHAW)
(CALL ORW PND=34.231 PCD=0 PTG=904 PTP=9970001 PR=30 PZOZ=30 PBLZ=45 )
(PND=PROGRAMIR D)
(PTP- SERIAL GROUP PRODUVOCHNOGO INSTRUMENTA)
IF [VIRD[01138] NE 1] GOTO NWRT  (PROVERKA 1=U AXIS )
IF [VORD[0000B] EQ 1] GOTO NEND
IF [VRSTT EQ 128] GOTO NEND
IF [VOKF EQ 1] GOTO NEND
VC284=0
CALL OPTF PTOL=0  (VIVOD V VC900 GROUP + SERIAL  TOOL, PTOL=0 ACT_TOOL)
PSTN=VC900 (SAVE TOOL NOMER)
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PTL=VTLCN (SAVE NOMER JACHEIKI)
NSTR8
PPUX=0.15 (DOPUSK AVTO-KORREKTIROVKI DIAMETRA DANDREA PRI IZMERENII RENISHAW)
PPUC=0.015 (DOPUSK RAZNICI SMESHENIJA CENTROV OTV PRI IZMERENII PO 3 TOCHKAM I PO 2 TOCHKAM)
PPUD=0.015 (DOPUSK RAZNICI IZM DIAMETROV OTV PRI IZMERENII PO 3 TOCHKAM I PO 2 TOCHKAM)
PPUO=0.02 (DOPUSK SMESHENIJA CENTROV OTV OT PROGRAMMNOGO)
CALL OUAX PPP=1
G94 G90

IF [PZOZ LE 0] GOTO NOTV1

(****BOBISHKA****)
IF [PTP EQ 0] GOTO NT50
TG=PTP M6
TG=999 (PRE-CALL RENISHAW)

(****PROMIVKA BOBISHKA****)

G56 HA
S333 M3
PWA=0
M51
GOTO N53

N52
M12
M59

N53
(X+)
G0 X=PND/2+ABS[PR] Y0
G0 Z=ABS[PR]
G1 Z=-ABS[PBLZ] F700
G04 F1.5
G1 Z=ABS[PR]
G0 Z=-ABS[PZOZ]
Z=ABS[PR]

(Y+)
G0 X=0 Y=PND/2+ABS[PR]
G0 Z=ABS[PR]
G1 Z=-ABS[PBLZ] F700
G04 F1.5
G1 Z=ABS[PR]
G0 Z=-ABS[PZOZ]
Z=ABS[PR]

(X-)
G0 X=-1*[PND/2+ABS[PR]] Y0
G0 Z=ABS[PR]
G1 Z=-ABS[PBLZ] F700
G04 F1.5
G1 Z=ABS[PR]
G0 Z=-ABS[PZOZ]
Z=ABS[PR]

(Y-)
G0 X=0 Y=-1*[PND/2+ABS[PR]]
G56 HA
G0 Z=ABS[PR]
G1 Z=-ABS[PBLZ] F700
G04 F1.5
G1 Z=ABS[PR]
G0 Z=-ABS[PZOZ]
Z=ABS[PR]

PWA=PWA+1
M9
IF [PWA EQ 1] GOTO N52

M5
G30 P1
GOTO NT51

NT50
TG=999

NT51
M6 (RENI IN SPINDLE)
CALL OPRW PAA=0
TF=PSTN
VC11=0
VC14=0
VC15=0
VC16=0
VC17=0
VC18=0
VC20=0
CALL OO18
G0 X0 Y0
G56 HA
G0 Z=ABS[PR]

CALL OO10 PMOD=6 PDI=PND PZIN=ABS[PR]+ABS[PZOZ] PUDT=30 PFA=20009 PF1=2000 PF2=1000 
PD1=VS30
PCX1=VS29
PCY1=VS28
VC17=PCX1
VC18=PCY1
VC20=PND-PD1

PUQR=VC20
PIUF=PD1

VC295=VTWOH[PTL]

PDW=[PD1-PND]
PDU=VTOFH[PTL]-VTWOH[PTL] (ZNACHENIE diametrA dandrea V TABLICE)
PNDU=VTOFH[PTL]+PND-PD1+PCD (VISCHITANNII NOVII POLNII DIAMETR DANDREA)
VTOFH[PTL]=PDU
VTWOH[PTL]=PNDU-PDU (NOVII IZNOS)
VIU4[PTL]=PND-PD1
IF [ABS[PCX1] GT PPUO] GOTO NUX1
IF [ABS[PCY1] GT PPUO] GOTO NUX1
IF [ABS[PDW] GE PPUX] GOTO NUX1 (SLISHKOM BOLSHAJA KORECCIJA)

GOTO NUX9

GOTO NUB01

NOTV1
(****OTVERSTIE****)
IF [PTP EQ 0] GOTO NT99
TG=PTP M6
TG=999 (PRE-CALL RENISHAW)

S333 M3
G0 X0 Y0
G56 HA
G0 Z0
M51
G1 Z=-ABS[PBLZ] F700
G04 F1
G1 Z0
M9
M5
M19
M12
M59
G04 F2
S333 M3
G1 Z=-ABS[PBLZ]
G1 Z0
G0 Z=-ABS[PZOZ]
G04 F3
M9
M5
G30 P1
GOTO NT999

NT99
TG=999

NT999
M6 (RENI IN SPINDLE)

CALL OPRW PAA=0
TF=PSTN

CALL OO18
G0 X0 Y0
G56 HA
G0 Z30
G04 F0.1
G0 Z=-ABS[PZOZ]
CALL OO10 PMOD=7 PDI=PND PMTR=1
PIUF=VS30 (fakt diametr OTVERSTIJA - ZAMER PO 3 TOCHKAM)
PICX=VS29 (CENTR OTV PO OSI X - ZAMER PO 3 TOCHKAM)
PICY=VS28 (CENTR OTV PO OSI Y - ZAMER PO 3 TOCHKAM)
G0 X0 Y0
CALL OO10 PMOD=11 PELI=PND POVT=3
PDDX=VS30 (fakt SHIRINA OTVERSTIJA - ZAMER PO 2 TOCHKAM PO OSI X)
PXCX=VS29 (CENTR OTV PO OSI X - ZAMER PO 2 TOCHKAM)
G0 X0 Y0
CALL OO10 PMOD=12 PELI=PND POVT=3
PDDY=VS30 (fakt SHIRINA OTVERSTIJA - ZAMER PO 2 TOCHKAM PO OSI Y)
PYCY=VS28 (CENTR OTV PO OSI Y - ZAMER PO 2 TOCHKAM)
CALL OO19
VC15=PDDX (fakt SHIRINA OTVERSTIJA - ZAMER PO 2 TOCHKAM PO OSI X)
VC11=PXCX (CENTR OTV PO OSI X - ZAMER PO 2 TOCHKAM)
VC16=PDDY (fakt SHIRINA OTVERSTIJA - ZAMER PO 2 TOCHKAM PO OSI Y)
VC14=PYCY (CENTR OTV PO OSI Y - ZAMER PO 2 TOCHKAM)
VC1=PICX+1
VC2=PXCX+1
VC17=VC1-VC2 (RAZNICA MEGDU IZM CENTR PO OSI X)
PCCX=VC17 (RAZNICA MEGDU IZM CENTR PO OSI X)
VC1=PICY+1
VC2=PYCY+1
VC18=VC1-VC2 (RAZNICA MEGDU IZM CENTR PO OSI Y)
PCCY=VC18 (RAZNICA MEGDU IZM CENTR PO OSI Y)
PXDR=ABS[PIUF-PDDX] (RAZNICA MEGDU IZM DIAM PO 3 TOCH I SHIRIN PO 2 TOCH PO OSI X)
PYDR=ABS[PIUF-PDDY] (RAZNICA MEGDU IZM DIAM PO 3 TOCH I SHIRIN PO 2 TOCH PO OSI Y)
VC19=PXDR (RAZNICA MEGDU IZM DIAM PO 3 TOCH I SHIRIN PO 2 TOCH PO OSI X)
VC20=PYDR (RAZNICA MEGDU IZM DIAM PO 3 TOCH I SHIRIN PO 2 TOCH PO OSI Y)
PUQR=PND-PIUF (ZAMERENNAJA raznica v diametrah SO ZNAKOM)

VC295=VTWOH[PTL]
IF [ABS[PCCX] GT PPUC] GOTO NUX1
IF [ABS[PCCY] GT PPUC] GOTO NUX1
IF [ABS[PXDR] GT PPUD] GOTO NUX1
IF [ABS[PYDR] GT PPUD] GOTO NUX1
IF [ABS[PICX] GT PPUC] GOTO NUX1
IF [PICY LT -0.045] GOTO NUX1
IF [PICY GT 0.01] GOTO NUX1
IF [ABS[PUQR] GE PPUX] GOTO NUX1

NUB01
PDU=VTOFH[PTL]-VTWOH[PTL] (ZNACHENIE diametrA dandrea V TABLICE)
PNDU=VTOFH[PTL]+PUQR+PCD (VISCHITANNII NOVII POLNII DIAMETR DANDREA)
VTOFH[PTL]=PDU
VTWOH[PTL]=PNDU-PDU (NOVII IZNOS)
VIU4[PTL]=PUQR
GOTO NUX9

NUX1
CALL OPRW PAA=0
G30 P1
M6
VIU4[PTL]=PUQR
(SLISHKOM BOLSHAJA AVTOKOREKCIJA PRI IZMERENII OTVERSTIJA RENISHAW + DANDREA, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=56 PAA=6 PND=PND PCD=PCD PTL=PTL PSTN=PSTN PSTG=PSTG PTP=PTP PZOZ=PZOZ PBLZ=PBLZ PUQR=PUQR PPUX=PPUX PIUF=PIUF PICX=PICX PICY=PICY
IF [VC284 EQ 1] GOTO NUX2
CALL OFOU PAA=PAA
GOTO NSTR8

NUX2
CALL OUAX PPP=1
VTLD3[PTL]=72
VTLD4[PTL]=128
VOKF=1
G30 P1
M63
G04 F1
M6
G04 F2
GOTO NEND

NUX9
CALL OPRW PAA=0
G04 F1
VIU4[PTL]=PUQR
CALL OPRIN PA=201 PAA=6 PND=PND PCD=PCD PTL=PTL PTP=PTP PZOZ=PZOZ PBLZ=PBLZ PUQR=PUQR PPUX=PPUX PIUF=PIUF PICX=PICX PICY=PICY PSTN=PSTN PSTG=PSTG
G04 F1
M6
G04 F1
GOTO NEND

NWRT (WRONG CALL ORW, NOT DANDREA IN SPINDEL)
G04 F1
VIU4[PTL]=PUQR
CALL OPRIN PA=204 PAA=6 PND=PND PCD=PCD PTL=PTL PTP=PTP PZOZ=PZOZ PBLZ=PBLZ PUQR=PUQR PPUX=PPUX PIUF=PIUF PICX=PICX PICY=PICY PSTN=PSTN PSTG=PSTG
CALL OUAX PPP=1
M63
G04 F1
M6
G04 F10
VTLD3[PTL]=72
VTLD4[PTL]=128
VOKF=1
NEND
RTS


N10002
OCRS
(AVTOKOREKCIJA OBICHNOGO INSTRUMENTA PO IZMERENIJAM RENISHAW)
VC285=PA
IF [VIRD[01138] EQ 1] GOTO NTBLU (ESLI DANDREA TO OSHIBKA)
IF [VORD[0000B] EQ 1] GOTO NEND
IF [VRSTT EQ 128] GOTO NEND
IF [VOKF EQ 1] GOTO NEND
IF [PH LE 10000] GOTO NWRNG
IF [PH GE 10003] GOTO NWRNG
VSZOX[49]=VTLCN (SAVE POT)
PCT=VTLCN

CALL OPTF PTOL=0
PSTN=VC900
PSTG=VTLGN[VTLCN]

PT1=VTLD1[PCT]
PT2=VTLD2[PCT]
G30 P1

IF [PA EQ 1] GOTO NPPP1 (PRODUVKA- OTVERSTIE ILI BOBISHKA)
IF [PA EQ 2] GOTO NPPP1 (PRODUVKA- PAZ VDOL OSI X ILI VISTUP VDOL OSI X)
IF [PA EQ 3] GOTO NPPP1 (PRODUVKA- PAZ VDOL OSI Y ILI VISTUP VDOL OSI Y)
GOTO NST2

NPPP1
IF [PR GT 0] GOTO NST2 (ESLI BOBISHKA ILI VISTUP TO VIHOD)
TG=997 M6
TG=999

G94 G90
G0 X=PX Y=PY
G56 HA
G0 Z=PZ+ABS[PR]
S333 M3
M12
M59
G04 F1
G0 Z=PZ-ABS[PZ1]
G04 F3
IF [PZ2 EQ 0] GOTO NX5
G0 Z=PZ-ABS[PZ2]
G04 F3
G0 Z=PZ-ABS[PZ1]
G04 F1
GOTO NX5

NX5
M5
M9
GOTO NST3

NST2
TG=999

NST3
G30 P1
M6
TF=PSTN

CALL OPRW PAA=0
G56 HA
G94 G90
CALL OO18

PWR1=0.07 (MAKSIMALNII DOPUSK KORRECCII NA RADIUS FREZI PRI IZMERENII RENISHAW)
PWZ1=0.05 (MAKSIMALNII DOPUSK KORRECCII NA DLINNU FREZI PRI IZMERENII RENISHAW)
PDW=0 (FAKT RAZNICA PO RADIUSU DLJA KOREKCII FREZI POSLE ZAMERA RENISHAW)
PWZ=0 (FAKT RAZNICA PO DLINNE DLJA KOREKCII FREZI POSLE ZAMERA RENISHAW)

VC11=9999
VC12=9999
VC13=9999
VC14=9999
PD1=9999
PD2=9999
PD3=9999
PP1=9999
PP2=9999
PP3=9999

IF [PA EQ 1] GOTO NP1 (OTVERSTIE ILI BOBISHKA)
(OTVERSTIE;CALL OCRS PA=1 PX=0 PY=0 PZ=0 PM=30 PCD=0 PCO1=0.02 PZ1=15 PZ2=0 PR=-30 PH=10001)
(BOBISKA;CALL OCRS PA=1 PX=0 PY=0 PZ=0 PM=30 PCD=0 PCO1=0.02 PZ1=15 PZ2=0 PR=30 PH=10001)
IF [PA EQ 2] GOTO NP2 (PAZ VDOL OSI X ILI VISTUP VDOL OSI X)
(PAZ_X;CALL OCRS PA=2 PX=-19.503 PY=0 PZ=108 PM=26.194 PCD=0 PCO1=0.015 PZ1=4 PZ2=4.2 PR=-30 PH=10001)
(NARUGNII_X;CALL OCRS PA=2 PX=-19.503 PY=0 PZ=108 PM=26.194 PCD=0 PCO1=0.015 PZ1=4 PZ2=4.2 PR=30 PH=10001)
IF [PA EQ 3] GOTO NP3 (PAZ VDOL OSI Y ILI VISTUP VDOL OSI Y)
(PAZ_Y;CALL OCRS PA=3 PX=-19.503 PY=0 PZ=108 PM=26.194 PCD=0 PCO1=0.015 PZ1=4 PZ2=4.2 PR=-30 PH=10001)
(NARUGNII_Y;CALL OCRS PA=3 PX=-19.503 PY=0 PZ=108 PM=26.194 PCD=0 PCO1=0.015 PZ1=4 PZ2=4.2 PR=30 PH=10001)
IF [PA EQ 4] GOTO NP4 (TOCHKA PO OSI X V PLUS ILI V MINUS)
(X_PLUS;CALL OCRS PA=4 PX=0 PY=0 PZ=0 PCD=0 PCO1=0.02 PZ1=15 PZ2=0 PR=-30 PH=10001)
(X_MINUS;CALL OCRS PA=4 PX=0 PY=0 PZ=0 PCD=0 PCO1=0.02 PZ1=15 PZ2=0 PR=30 PH=10001)
IF [PA EQ 5] GOTO NP5 (TOCHKA PO OSI Y V PLUS ILI V MINUS)
(Y_PLUS;CALL OCRS PA=5 PX=0 PY=0 PZ=0 PCD=0 PCO1=0.02 PZ1=15 PZ2=0 PR=-30 PH=10001)
(Y_MINUS;CALL OCRS PA=5 PX=0 PY=0 PZ=0 PCD=0 PCO1=0.02 PZ1=15 PZ2=0 PR=30 PH=10001)
IF [PA EQ 6] GOTO NP6 (TOCHKA PO OSI Z)
(Z;CALL OCRS PA=6 PX=0 PY=0 PZ=0 PCD=0 PCO1=0.02 PZ1=15 PZ2=0 PR=30 PH=10001)
GOTO NEND

NP1 (OTVERSTIE ILI BOBISHKA)
G0 X=PX Y=PY
Z=PZ+ABS[PR]
G04 F0.5
IF [PR GT 0] GOTO NOD1

NID1 (OTVERSTIE GLUBINA 1)
Z=PZ-ABS[PZ1]
CALL OO10 PMOD=7 PDI=PM
PD1=VS30
PCX1=VS29
PCY1=VS28
VC11=PCX1
VC12=PCY1
IF [PZ2 EQ 0] GOTO NPE1

NID2 (OTVERSTIE GLUBINA 2)
Z=PZ-ABS[PZ2] 
CALL OO10 PMOD=7 PDI=PM
PD2=VS30
PCX2=VS29
PCY2=VS28
VC13=PCX2
VC14=PCY2
PCO2=ABS[PD1-PD2]
GOTO NPE2

NPE1 (TOLKO ODNA GLUBINA)
PDW=[PD1-PM]/2
IF [ABS[PDW] GE PWR1] GOTO NTW1 (SLISHKOM BOLSHAJA KORECCIJA, 1 GLUBINA PO Z)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NPE2 (DVE GLUBINI)
PD3=[PD1+PD2]/2
PDW=[PD3-PM]/2
IF [ABS[PDW] GE PWR1] GOTO NTW1 (SLISHKOM BOLSHAJA KORECCIJA, 2 GLUBINA PO Z)
IF [PCO2 GE PCO1] GOTO NTBL1 (OTVERSTIE)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NOD1 (BOBISHKA GLUBINA 1)
G0 Z=PZ+ABS[PR] 
CALL OO10 PMOD=6 PDI=PM PZIN=ABS[PR]+ABS[PZ1] PUDT=ABS[PR] PFA=20009 PF1=2000 PF2=1000 
PD1=VS30
PCX1=VS29
PCY1=VS28
VC11=PCX1
VC12=PCY1
IF [PZ2 EQ 0] GOTO NPOE1

NOD2 (BOBISHKA GLUBINA 2)
G0 Z=PZ+ABS[PR] 
CALL OO10 PMOD=6 PDI=PM PZIN=ABS[PR]+ABS[PZ2] PUDT=ABS[PR]
PD2=VS30
PCX2=VS29
PCY2=VS28
VC13=PCX2
VC14=PCY2
PCO2=ABS[PD1-PD2]
GOTO NPOE2

NPOE1 (TOLKO ODNA GLUBINA)
PDW=[PD1-PM]/-2
IF [ABS[PDW] GE PWR1] GOTO NTW3 (SLISHKOM BOLSHAJA KORECCIJA, 1 GLUBINA PO Z)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NPOE2 (DVE GLUBINI)
PD3=[PD1+PD2]/2
PDW=[PD3-PM]/-2
IF [ABS[PDW] GE PWR1] GOTO NTW3 (SLISHKOM BOLSHAJA KORECCIJA, 2 GLUBINA PO Z)
IF [PCO2 GE PCO1] GOTO NTBL2 (BOBISHKA)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NP2 (PAZ iLi VISTUP IZM +-X)
G0 X=PX Y=PY
Z=PZ+ABS[PR]
G04 F0.5
IF [PR GT 0] GOTO NXP1

NIP1 (VNUTRENNIi PAZ IZM +-X GLUBINA 1)
Z=PZ-ABS[PZ1]
CALL OO10 PMOD=11 PELI=PM POVT=10
PP1=VS30
PCX1=VS29
VC11=PCX1
IF [PZ2 EQ 0] GOTO NPE3

NIP2 (VNUTRENNIi PAZ IZM +-X GLUBINA 2)
Z=PZ-ABS[PZ2]
CALL OO10 PMOD=11 PELI=PM POVT=10 
PP2=VS30
PCX2=VS29
VC13=PCX2
PCO2=ABS[PP1-PP2]
GOTO NPE4

NPE3 (TOLKO ODNA GLUBINA)
PDW=[PP1-PM]/2
IF [ABS[PDW] GE PWR1] GOTO NTW5 (SLISHKOM BOLSHAJA KORECCIJA, 1 GLUBINA PO Z)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NPE4 (DVE GLUBINI)
PP3=[PP1+PP2]/2
PDW=[PP3-PM]/2
IF [ABS[PDW] GE PWR1] GOTO NTW5 (SLISHKOM BOLSHAJA KORECCIJA, 2 GLUBINA PO Z)
IF [PCO2 GE PCO1] GOTO NTBL3 (VNUTRI PO X)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NXP1 (NARUGNIi VISTUP IZM +-X GLUBINA 1)
G0 Z=PZ+ABS[PR] 
CALL OO10 PMOD=11 PELI=PM PIN=ABS[PR]+ABS[PZ1] PUDT=ABS[PR] POVT=10 PF1=2000 
PP1=VS30
PCX1=VS29
VC11=PCX1
IF [PZ2 EQ 0] GOTO NPOE3

NOP2  (NARUGNIi VISTUP IZM +-X GLUBINA 2)
G0 Z=PZ+ABS[PR] 
CALL OO10 PMOD=11 PELI=PM PIN=ABS[PR]+ABS[PZ2] PUDT=ABS[PR] POVT=10 PF1=2000 
PP2=VS30
PCX2=VS29
VC13=PCX2
PCO2=ABS[PP1-PP2]
GOTO NPOE4

NPOE3 (TOLKO ODNA GLUBINA)
PDW=[PP1-PM]/-2
IF [ABS[PDW] GE PWR1] GOTO NTW7 (SLISHKOM BOLSHAJA KORECCIJA, 1 GLUBINA PO Z)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NPOE4 (DVE GLUBINI)
PP3=[PP1+PP2]/2
PDW=[PP3-PM]/-2
IF [ABS[PDW] GE PWR1] GOTO NTW7 (SLISHKOM BOLSHAJA KORECCIJA, 2 GLUBINA PO Z)
IF [PCO2 GE PCO1] GOTO NTBL4 (SNARUGE PO X)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NP3 (PAZ iLi VISTUP IZM +-Y)
G0 X=PX Y=PY
Z=PZ+ABS[PR]
G04 F0.5
IF [PR GT 0] GOTO NYP1

NPY1 (VNUTRENNIi PAZ IZM +-Y GLUBINA 1)
Z=PZ-ABS[PZ1] 
CALL OO10 PMOD=12 PELI=PM POVT=10  
PP1=VS30
PCY1=VS28
VC12=PCY1
IF [PZ2 EQ 0] GOTO NPE5

NPY2 (VNUTRENNIi PAZ IZM +-Y GLUBINA 2)
Z=PZ-ABS[PZ2] 
CALL OO10 PMOD=12 PELI=PM POVT=10 
PP2=VS30
PCY2=VS28
VC14=PCY2
PCO2=ABS[PP1-PP2]
GOTO NPE6

NPE5 (TOLKO ODNA GLUBINA)
PDW=[PP1-PM]/2
IF [ABS[PDW] GE PWR1] GOTO NTW9 (SLISHKOM BOLSHAJA KORECCIJA, 1 GLUBINA PO Z)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NPE6 (DVE GLUBINI)
PP3=[PP1+PP2]/2
PDW=[PP3-PM]/2
IF [ABS[PDW] GE PWR1] GOTO NTW9 (SLISHKOM BOLSHAJA KORECCIJA, 2 GLUBINA PO Z)
IF [PCO2 GE PCO1] GOTO NTBL5 (VNUTRI PO Y)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NYP1 (NARUGNIi VISTUP IZM +-Y GLUBINA 1)
G0 Z=PZ+ABS[PR] 
CALL OO10 PMOD=12 PELI=PM PIN=ABS[PR]+ABS[PZ1] PUDT=ABS[PR] POVT=10 
PP1=VS30
PCY1=VS28
VC12=PCY1
IF [PZ2 EQ 0] GOTO NPOE5

NYP2  (NARUGNIi VISTUP IZM +-Y GLUBINA 2)
G0 Z=PZ+ABS[PR] 
CALL OO10 PMOD=12 PELI=PM PIN=ABS[PR]+ABS[PZ2] PUDT=ABS[PR] POVT=10 
PP2=VS30
PCY2=VS28
VC14=PCY2
PCO2=ABS[PP1-PP2]
GOTO NPOE6

NPOE5 (TOLKO ODNA GLUBINA)
PDW=[PP1-PM]/-2
IF [ABS[PDW] GE PWR1] GOTO NTW11 (SLISHKOM BOLSHAJA KORECCIJA, 1 GLUBINA PO Z)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NPOE6 (DVE GLUBINI)
PP3=[PP1+PP2]/2
PDW=[PP3-PM]/-2
IF [ABS[PDW] GE PWR1] GOTO NTW11 (SLISHKOM BOLSHAJA KORECCIJA, 2 GLUBINA PO Z)
IF [PCO2 GE PCO1] GOTO NTBL6 (SNARUGE PO Y)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NP4 (STENKA IZM PO OSI X)
PM=PX
G0 Y=PY X=PX+PR
G0 Z=PZ-ABS[PZ1]
CALL OO10 PMOD=1 PEI=PX PUDT=ABS[PR] POVT=10 
PP1=VS29
PP3=PP1
PCO2=0
IF [PZ2 EQ 0] GOTO NPE7
Z=PZ-ABS[PZ2]
CALL OO10 PMOD=1 PEI=PX PUDT=ABS[PR] POVT=10 
PP2=VS29
PP3=[PP1+PP2]/2
PCO2=ABS[PP1-PP2]

NPE7
IF [PR GT 0] GOTO NPL1
PDW=PP3-PX
IF [ABS[PDW] GE PWR1] GOTO NTW13 (SLISHKOM BOLSHAJA KORECCIJA, NAPRAVLENIE +X)
IF [PCO2 GE PCO1] GOTO NTBL7 (TOCHKA VDOL OSI X)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NPL1
PDW=[PP3-PX]*-1
IF [ABS[PDW] GE PWR1] GOTO NTW13 (SLISHKOM BOLSHAJA KORECCIJA, NAPRAVLENIE -X)
IF [PCO2 GE PCO1] GOTO NTBL7 (TOCHKA VDOL OSI X)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NP5 (STENKA IZM PO OSI Y)
PM=PY
G0 Y=PY+PR  X=PX
Z=PZ-ABS[PZ1]
CALL OO10 PMOD=2 PEI=PY PUDT=ABS[PR] POVT=10 
PP1=VS28
PP3=PP1
PCO2=0
IF [PZ2 EQ 0] GOTO NPE9
Z=PZ-ABS[PZ2]
CALL OO10 PMOD=2 PEI=PY PUDT=ABS[PR] POVT=10 
PP2=VS28
PCO2=ABS[PP1-PP2]
PP3=[PP1+PP2]/2

NPE9
IF [PR GT 0] GOTO NPL2
PDW=PP3-PY
IF [ABS[PDW] GE PWR1] GOTO NTW15 (SLISHKOM BOLSHAJA KORECCIJA, NAPRAVLENIE +Y)
IF [PCO2 GE PCO1] GOTO NTBL8 (TOCHKA VDOL OSI Y)

CALL OPHWD PCT=PCT PDW=PDW PH=PH
GOTO NEND

NPL2
PDW=[PP3-PY]*-1
IF [ABS[PDW] GE PWR1] GOTO NTW15 (SLISHKOM BOLSHAJA KORECCIJA, NAPRAVLENIE -Y)
IF [PCO2 GE PCO1] GOTO NTBL8 (TOCHKA VDOL OSI Y)

CALL OPHWD PCT=PCT PDW=PDW PH=PH 
GOTO NEND

NP6 (PLOSKOST IZM PO OSI Z)
PM=PZ
G0 X=PX Y=PY
Z=PZ+ABS[PR]
CALL OO10 PMOD=3 PEI=PZ PUDT=ABS[PR] POVT=10
PZ3=VS27
PWZ=VS27-PZ
IF [ABS[PWZ] GE PWZ1] GOTO NTW17 (SLISHKOM BOLSHAJA KORECCIJA, PO OSI Z)

IF [PH EQ 10001] GOTO NQ001
GOTO NQ002
NQ001
VTWOH[PCT]=VTWOH[PCT]-PWZ
GOTO NFEN

NQ002
IF [PH EQ 10002] GOTO NQ022
GOTO NQ003
NQ022
VIU1[PCT]=VIU1[PCT]-PWZ
GOTO NFEN

NQ003
IF [PH EQ 10003] GOTO NQ033

NQ033
VIU3[PCT]=VIU3[PCT]-PWZ

NFEN
GOTO NEND

NTBL1 (PREVISHENA KONUSNOST OTVERSTIJA PRI IZMERENII RENISHAW, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=36 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PD1=PD1 PD2=PD2 PD3=PD3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTBL2 (PREVISHENA KONUSNOST BOBISHKI PRI IZMERENII RENISHAW, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=40 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PD1=PD1 PD2=PD2 PD3=PD3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTBL3 (PREVISHENA KONUSNOST PAZA PRI IZMERENII RENISHAW VDOL OSI X, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=41 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PP1=PP1 PP2=PP2 PP3=PP3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTBL4 (PREVISHENA KONUSNOST VISTUPA PRI IZMERENII RENISHAW VDOL OSI X, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=42 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PP1=PP1 PP2=PP2 PP3=PP3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTBL5 (PREVISHENA KONUSNOST PAZA PRI IZMERENII RENISHAW VDOL OSI Y, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=43 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PP1=PP1 PP2=PP2 PP3=PP3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTBL6 (PREVISHENA KONUSNOST VISTUPA PRI IZMERENII RENISHAW VDOL OSI Y, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=44 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PP1=PP1 PP2=PP2 PP3=PP3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTBL7 (PREVISHENA KONUSNOST STENKI PRI IZMERENII RENISHAW VDOL OSI X, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=45 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PP1=PP1 PP2=PP2 PP3=PP3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTBL8 (PREVISHENA KONUSNOST STENKI PRI IZMERENII RENISHAW VDOL OSI Y, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=46 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PP1=PP1 PP2=PP2 PP3=PP3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTW1 (BOLSHAJA KORECCIJA PRI IZMERENII RENISHAW V OTVERSTII , INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=47 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PD1=PD1 PD2=PD2 PD3=PD3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTW3 (BOLSHAJA KORECCIJA PRI IZMERENII RENISHAW BOBISHKI, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=48 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PD1=PD1 PD2=PD2 PD3=PD3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTW5 (BOLSHAJA KORECCIJA PRI IZMERENII RENISHAW PAZA PO X, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=49 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PP1=PP1 PP2=PP2 PP3=PP3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTW7 (BOLSHAJA KORECCIJA PRI IZMERENII RENISHAW VISTUPA PO X, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=50 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PP1=PP1 PP2=PP2 PP3=PP3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTW9 (BOLSHAJA KORECCIJA PRI IZMERENII RENISHAW PAZA PO Y, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=51 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PP1=PP1 PP2=PP2 PP3=PP3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTW11 (BOLSHAJA KORECCIJA PRI IZMERENII RENISHAW VISTUPA PO Y, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=52 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PP1=PP1 PP2=PP2 PP3=PP3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTW13 (BOLSHAJA KORECCIJA PRI IZMERENII RENISHAW STENKI PO X, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=53 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PP1=PP1 PP2=PP2 PP3=PP3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTW15 (BOLSHAJA KORECCIJA PRI IZMERENII RENISHAW STENKI PO Y, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=54 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PP1=PP1 PP2=PP2 PP3=PP3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NTW17 (BOLSHAJA KORECCIJA PRI IZMERENII RENISHAW PLOSKOSTI PO Z, INSTR. ZABL., PALLETA ZABL.)
CALL OPRIN PA=55 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PM=PM PZ=PZ PZ3=PZ3 PWZ=PWZ PWZ1=PWZ1 PSTN=PSTN PSTG=PSTG
GOTO NENDX

NWRNG (WRONG INPUT DATA)
CALL OPRIN PA=501 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PM=PM PZ=PZ PZ3=PZ3 PWZ=PWZ PWZ1=PWZ1 PSTN=PSTN PSTG=PSTG
VOKF=1
GOTO NFIN

NENDX
CALL OO19
CALL OPRW PAA=0
G30 P1
M6
VTLD1[PCT]=PT1
VTLD2[PCT]=PT2
G04 F1

VTLD3[PCT]=72
VTLD4[PCT]=128

G30 P1
M63
G04 F1
M6
G04 F2
VOKF=1
GOTO NFIN

NTBLU (NE VOZMOGNO ISPOLSOVAT FREZERNII VID IZMERENIJA RENISHAW, V PARE S DANDREA, PALLETA ZABLOKIROVANA)
CALL OPRIN PA=37 PAA=4 PH=PH PM=PM PCO1=PCO1 PX=PX PY=PY PZ=PZ PZ1=PZ1 PZ2=PZ2 PSTN=PSTN PSTG=PSTG PCT=PCT
G30 P1
CALL OUAX PPP=1
M63
G04 F1
M6
G04 F2
VOKF=1
GOTO NFIN

NEND
CALL OO19
CALL OPRW PAA=0
G30 P1
M6
VTLD1[PCT]=PT1
VTLD2[PCT]=PT2
VIU3[PCT]=PWZ (VELICHINA AVTOKOREKCII OCRS Z)
IF [PDW EQ 0] GOTO NFIN
VIU4[PCT]=PDW (VELICHINA AVTOKOREKCII OCRS R)
CALL OPRIN PA=202 PAA=4 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PD1=PD1 PD2=PD2 PD3=PD3 PP1=PP1 PP2=PP2 PP3=PP3 PSTN=PSTN PSTG=PSTG
NFIN
VSZOX[49]=0
RTS


N10003
OCTS (PROVERKA INSTYMENTA V NACHALE)
(CALL OCTS PMIN=4.8 PH=10001 PTR=PTR PX=PX PTZ=PTZ PTYP=PTYP PLE1=0.2 PLE2=0.3 PLE3=0.1 PZ=PZ PA=PA PV=PV PRU=+-1;12.5;25;37.5)
CALL OUAX
IF[PTYP NE 2] NTYP1
PX=0
NTYP1
VSTOD[50]=1 (old tool)
IF [VTWOH[VTLCN] NE 0] GOTO NVR01

NVR03
VTWOH[VTLCN]=0
VTWOD[VTLCN]=0
VIU1[VTLCN]=0
VIU2[VTLCN]=0
VIU3[VTLCN]=0
VIU4[VTLCN]=0
VSTOD[50]=0 (NEW TOOL IN SPINDLE)

NVR01
IF [VIRD[01138] NE 1] GOTO NVC28
VC286=VIU1[VTLCN]
VC287=VTWOH[VTLCN]
GOTO NDAL

NVC28
VC286=VTWOH[VTLCN]
VC287=VTWOD[VTLCN]

NDAL
CALL OPTF PTOL=0
PSTN=VC900 (SAVE TOOL NOMER)
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PTL=VTLCN (SAVE NOMER JACHEIKI)
(\SAVE TOOL DATA/)
PTN=PSTN
PTG=PSTG

VC211=1 (CYCL OCTS)
VC212=PMIN
VC213=PH
VC214=ABS[PTR]
VC215=ABS[PX]
VC216=ABS[PZ]
VC217=PTZ
VC218=PTYP
VC219=PLE1
VC220=PLE2
VC221=PLE3
VC222=PA
VC223=PV
VC224=PTIM
VC225=PTN
VC226=PTG
VC228=PRU
VSTOD[48]=PRU
VC229=PSP
IF [VORD[0000B] EQ 1] GOTO NEND
IF [VRSTT EQ 128] GOTO NEND
IF [VOKF EQ 1] GOTO NEND
IF [VTLCN EQ 0] GOTO NPOK
IF [VTLD2[VTLCN] EQ 1] GOTO NXT
VTLD2[VTLCN]=1
VTLD3[VTLCN]=72
VTLD4[VTLCN]=128

NXT
(SAVE ACTIVE TOOL DATA)
CALL OPTF PTOL=0
PSTN=VC900 (SAVE TOOL NOMER)
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PTL=VTLCN (SAVE NOMER JACHEIKI)
(\SAVE TOOL DATA/)
PTN=PSTN
PTG=PSTG
VC297=VTLD8[VTLCN]
VC296=0
PTIM=PMIN*0.8
PPOT=0
IF [VTLD4[VTLCN] NE 0] GOTO NPOT
IF [VTLD8[VTLCN] GE PTIM] GOTO NLT
 
NPOT0
PPOT=0
NPOT (poisk dublja s dostatochnim vremenem)
PPOT=PPOT
PPOT=PPOT+1
IF [PPOT EQ 172] GOTO NPOK
PTOL=VPTNO[PPOT]
CALL OPTF PTOL=PTOL  (read/save tool in pot)
VC1=PTOL
IF [PTOL EQ 0] GOTO NPOT 
IF [PSTN EQ VC900] GOTO NPOT 
IF [VTLGN[PTOL] NE VTLGN[VTLCN]] GOTO NPOT 
IF [VTLD4[PTOL] NE 0] GOTO NPOT 
IF [VTLD8[PTOL] LE PTIM] GOTO NPOT 

CALL OUAX PPP=1
TF=VC900 M6

(SAVE ACTIVE TOOL DATA)
CALL OPTF PTOL=0
PSTN=VC900 (SAVE TOOL NOMER)
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PTL=VTLCN (SAVE NOMER JACHEIKI)
PTN=PSTN
PTG=PSTG
(\SAVE TOOL DATA/)
VC297=VTLD8[VTLCN]
VSTOD[50]=1 (old tool)
IF [VTWOH[VTLCN] NE 0] GOTO NVH01

NVH03
VTWOH[VTLCN]=0
VTWOD[VTLCN]=0
VIU1[VTLCN]=0
VIU2[VTLCN]=0
VIU3[VTLCN]=0
VIU4[VTLCN]=0
VSTOD[50]=0 (NEW TOOL IN SPINDLE)

NVH01
IF [VIRD[01138] NE 1] GOTO NVH28
VC286=VIU1[VTLCN]
VC287=VTWOH[VTLCN]

NVH28
VC286=VTWOH[VTLCN]
VC287=VTWOD[VTLCN]
IF [VTLD4[PTOL] NE 0] GOTO NPOT

NLT
IF [VTLD8[VTLCN] EQ VTLD7[VTLCN]] GOTO NLT1

NXT5
IF [VTWOH[VTLCN] EQ 0] GOTO NLT1

NXT1
IF [VC900 EQ VC298] GOTO NEND (POVT ZAMER)

NLT1
PTN=VC900
PTG=VTLGN[VTLCN]
VC224=PTIM  
VC225=PTN
VC226=PTG
VC227=VTLCN
(PROMIVKA)
IF [VIRD[01138] NE 1]  NSOJ
M51 
M8
G4 F15
M9

NSOJ
CALL OTOSL PS=0 PTIM=VC224 PTN=PTN PTG=PTG

IF [VTLD4[VTLCN] NE 0] GOTO NPOT0
IF [VIRD[01138] EQ 1] GOTO NEND
IF [PTYP NE 1] GOTO NXT10
GOTO NEND

NPOK
CALL OP01 PAA=99 PS=0
VOKF=1
IF [VTLCN EQ 0] GOTO NEND
M63
G04 F1
M6
G04 F2
GOTO NEND

NXT10
CALL OPHWR PH=PH PDH=2 PCT=0 PCW=2 (READ DATA FOR RADIUS WEAR ACTIVE TOOL TO VC901)
IF [VC902 NE 0] GOTO NEND

NEND
IF [VIRD[01138] EQ 1] GOTO NUND
VIU3[PTL]=0
VIU4[PTL]=0

NUND
M145
G30 P1
RTS


N10004 
OCTE
(PROVERKA INSTRUMENTA V KONCE)
(CALL OCTE PMIN=4.8 PH=10001 PTR=0.8 PTZ=6 PTYP=1 PLE1=0.1 PLE2=0.3 PLE3=0.06 PX=PX PZ=PZ PRU=+-1;12.5;25;37.5)
IF[PTYP NE 2] NTYP1
PX=0
NTYP1
VSTOD[50]=1 (OLD TOOL IN SPINDLE)
CALL OPTF PTOL=0
PSTN=VC900 (SAVE TOOL NOMER)
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PTL=VTLCN (SAVE NOMER JACHEIKI)
(\SAVE TOOL DATA/)
PTN=PSTN
PTG=PSTG

VC211=2 (CYCL OCTE)
VC212=PMIN
VC213=PH
VC214=ABS[PTR]
VC215=ABS[PX]
VC216=ABS[PZ]
VC217=PTZ
VC218=PTYP
VC219=PLE1
VC220=PLE2
VC221=PLE3
VC222=PA
VC223=PV
VC224=PTIM
VC225=PTN
VC226=PTG
VC228=PRU
VSTOD[48]=PRU
VC229=PSP
IF [VORD[0000B] EQ 1] GOTO NEND
IF [VRSTT EQ 128] GOTO NEND
IF [VOKF EQ 1] GOTO NEND
IF [VTLD2[VTLCN] EQ 1] GOTO NXT
VTLD2[VTLCN]=1
VTLD3[VTLCN]=72
VTLD4[VTLCN]=128
GOTO NF2

NXT
CALL OUAX
(SAVE ACTIVE TOOL DATA)
CALL OPTF PTOL=0
PSTN=VC900 (SAVE TOOL NOMER)
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PTL=VTLCN (SAVE NOMER JACHEIKI)
(\SAVE TOOL DATA/)

VC298=PSTN (POSLEDNII ZAMERENNII INSTRUMENT)
VC296=VC297-VTLD8[VTLCN]
VC297=VTLD8[VTLCN]
IF [VC296 LE 45] GOTO NXT52
CALL OPRMV PAA=2

NXT52
PRA2=0

NLT3
PTN=PSTN
PTG=PSTG
CALL OTOSL PS=1
IF [VOKF EQ 1] GOTO NF1
IF [VTLD4[VTLCN] NE 0] GOTO NF2
GOTO NEND

NF1
VOKF=1

NF2
M63
G04 F1
M6
G04 F2

NEND
IF [VIRD[01138] EQ 1] GOTO NUS1
VIU3[PTL]=0
VIU4[PTL]=0

NUS1
M145
G30 P1
RTS


N10005 
OCTI (PROVERKA INSTRUMENTA NA POLOMKU)
(CALL OCTI PMIN=3 PH=10002 PTR=0.2 PTZ=0 PTYP=1 PLE2=0.2 PRU=PRU)
IF[PTYP NE 2] NTYP1
PX=0
NTYP1
VSTOD[50]=1 (OLD TOOL IN SPINDLE)

CALL OPTF PTOL=0
PSTN=VC900 (SAVE TOOL NOMER)
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PTL=VTLCN (SAVE NOMER JACHEIKI)
(\SAVE TOOL DATA/)
PTN=PSTN
PTG=PSTG

VC211=3 (CYCL OCTI)
VC212=PMIN
VC213=PH
VC214=ABS[PTR]
VC215=ABS[PX]
VC216=ABS[PZ]
VC217=PTZ
VC218=PTYP
VC219=PLE1
VC220=PLE2
VC221=PLE3
VC222=PA
VC223=PV
VC224=PTIM
VC225=PTN
VC226=PTG
VC228=PRU
VSTOD[48]=PRU
VC229=PSP
(PROVERKA INSTRUMENTA NA POLOMKU)
(CALL OCTI PMIN=3 PH=10002 PTR=0.2 PTZ=0 PTYP=1 PLE2=0.2 PRU=PRU)
PLE1=0.1
PLE3=0.06
VC219=PLE1
VC221=PLE3
IF [VORD[0000B] EQ 1] GOTO NEND
IF [VRSTT EQ 128] GOTO NEND
IF [VOKF EQ 1] GOTO NEND
IF [VTLD2[VTLCN] EQ 1] GOTO NXT
VTLD2[VTLCN]=1
VTLD3[VTLCN]=72
VTLD4[VTLCN]=128

NXT
VC296=VC297-VTLD8[VTLCN]
VC297=VTLD8[VTLCN]
PRA3=0

(SAVE ACTIVE TOOL DATA)
CALL OPTF PTOL=0
PSTN=VC900 (SAVE TOOL NOMER)
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PTL=VTLCN (SAVE NOMER JACHEIKI)
(\SAVE TOOL DATA/)

NLT4
PTN=PSTN
PTG=PSTG
CALL OTOSL PS=2

IF [VOKF EQ 1] GOTO NF1
IF [VTLD4[VTLCN] NE 0] GOTO NF2
GOTO NEND

NF1
VOKF=1

NF2
M63
G04 F1
M6
G04 F2

NEND
M145
G30 P1
VC1=VOKF
RTS


N10006
OTOSL (IZMERENIE INSTRYMENTA)
(OTOSL PAA=1,2,3 PS=0,1,2 PTIM=PTIM PMIN=PMIN PTN=PTN PTG=PTG PH=PH PTZ=PTZ PTYP=PTYP PLE1=PLE1 PLE2=PLE2 PLE3=PLE3)
VSTOH[40]=1
PAA=VC211
PMIN=VC212
PH=VC213
PTR=VC214
PX=VC215
PZ=VC216
PTZ=VC217
PTYP=VC218
PLE1=VC219
PLE2=VC220
PLE3=VC221
PA=VC222
PV=VC223
PTIM=VC224
PTN=VC225
PTG=VC226
PRU=VC228
PSP=VC229
PIZM=0
VC229=VC228 (SDVIG U OSI SO ZNAKOM)
IF [PRU GT 0] GOTO NDOT0
PRU=1 (BOBISHKA)
GOTO NDOT1

NDOT0
PRU=0 (OTVERSTIE)

NDOT1
VC228=PRU
IF [VOKF EQ 1] GOTO NEND
IF [PS EQ 1] GOTO NIF8 (ESLI OCTE, TO ZAMERIT')
IF [VTLD4[VTLCN] NE 0] GOTO NEND

NIF8
IF [PTYP LT 0] GOTO NPW8
IF [PTYP GE 6] GOTO NPW8
VOK1=0
PLQS=0.06 (DOPUSK REZKOGO IZMENENIJA IZNOSA - NALIPANIE STRUGKI ILI SKOL PLASTINKI)
VC230=PLQS
IF [VIRD[01138] EQ 1] GOTO NEX02
(STANDART TOOL DATA INPUT)
VTOD3[VTLCN]=0
VC970=VTOFH[VTLCN]-VTWOH[VTLCN]  (HA)
VC971=VTWOH[VTLCN]               (HA_W)
VC972=VTOFD[VTLCN]-VTWOD[VTLCN]  (DA)
VC973=VTWOD[VTLCN]               (DA_W)
VC974=VTOH2[VTLCN]-VIU1[VTLCN] (HB)
VC975=VIU1[VTLCN]                (HB_w)
VC976=VTOD2[VTLCN]-VIU2[VTLCN] (DB)
VC977=VIU2[VTLCN]                (DB_W)
VC978=VTOH3[VTLCN]               (COMP VIRTUAL-L)
VC979=VIU3[VTLCN]                (i Z-COR OCRS RENISHAW)
VC980=VTOD3[VTLCN]               (=0)
VC981=VIU4[VTLCN]                (i R-COR OCRS RENISHAW)

PLE4=PLE1
IF [VTOFH[VTLCN] LT 90] GOTO NPW1  (Lmin)
IF [VTOFH[VTLCN] GE 400] GOTO NPW1  (Lmax)
IF [VTOFD[VTLCN] LT 0.25] GOTO NPW2  (Dsmall)
IF [PTYP EQ 0] GOTO NPZM1
IF [PTYP EQ 2] GOTO NPZM1
IF [VTOFD[VTLCN] GT 120] GOTO NPW2  (Dmax-75)
GOTO NPZM2

NPZM1
IF [VTOFD[VTLCN] GT 58.1] GOTO NPW2  (Dmax)

NPZM2
IF [PTYP NE 3] GOTO NWR01
IF [VTOH2[VTLCN] LT 90] GOTO NPW1  (Lmin)
IF [VTOH2[VTLCN] GE 400] GOTO NPW1  (Lmax)

NWR01
PUQL=VIU3[VTLCN]    (VELICHINA AVTOKOREKCII POSLE OCRS RENISHAW DLINNA)
PUQR=VIU4[VTLCN]    (VELICHINA AVTOKOREKCII POSLE OCRS RENISHAW RADIUS)
VIU3[VTLCN]=0
VIU4[VTLCN]=0
PLFL=VTOH3[VTLCN]   (KOMPENSACIJA NA DLINNU INSTRUMENTA DO VIRT PERESECHENIJA)
IF [PS NE 2] GOTO NEX01
VIU3[VTLCN]=PUQL
VIU4[VTLCN]=PUQR
GOTO NEX01 (to measure)

NEX02 (U-axis input data)
IF [PH NE 10002] GOTO NPW7 
VTOFD[VTLCN]=0
VTWOD[VTLCN]=0
VTOD2[VTLCN]=0
VIU2[VTLCN]=0
PUQL=VIU3[VTLCN] (VELICHINA AVTOKOREKCII POSLE ... RENISHAW DLINNA)
PUQR=VIU4[VTLCN]    (VELICHINA AVTOKOREKCII POSLE ORW RENISHAW RADIUS)
VIU4[VTLCN]=0
VIU3[VTLCN]=0
IF [PS NE 2] GOTO NEX021 (ESLI NE OCTI TO STERETb)
VIU3[VTLCN]=PUQL
VIU4[VTLCN]=PUQR

NEX021
VSTOH[1]=VTOD3[VTLCN]
VC970=VTOFH[VTLCN]-VTWOH[VTLCN]  (-D)
VC971=VTWOH[VTLCN]               (D_W)
VC972=VTOFD[VTLCN]-VTWOD[VTLCN]  (=0)
VC973=VTWOD[VTLCN]               (=0)
VC974=VTOH2[VTLCN]-VIU1[VTLCN]   (HB)
VC975=VIU1[VTLCN]                (HB_W)
VC976=VTOD2[VTLCN]               (=0)
VC977=VIU2[VTLCN]                (=0)
VC978=VTOH3[VTLCN]-VIU3[VTLCN]   (HC)
VC979=PUQL                       (HC_W)
VC980=0                          (=0)
VC981=PUQR                       (i D-COR ORW RENISHAW)
PUUR=VC980                       (UGOL PODVOROTA 1Zth)
PTM=PUQR
VSTOD[46]=VC974
VSTOD[45]=VC978
VSTOD[44]=VC970/-2
IF[VSTOD[50] NE 0] GOTO NTM0
VIU5[VTLCN]=VTOH2[VTLCN] (SAVE BASE LENGHT1)
VIU6[VTLCN]=VTOH3[VTLCN] (SAVE BASE LENGHT2)

NTM0
IF [VTOH2[VTLCN] GE 400] GOTO NPW3 (Lmax)
IF [PRU NE 1] GOTO NTOH2
(BOBISHKA)
IF [VTOH2[VTLCN] LE 280] GOTO NPW3 (Lmin FOR OD)
IF [VTOFH[VTLCN] GE 100] GOTO NPW4 (Dmax OD)
GOTO NWR05

NTOH2
(OTVERSTIE)
IF [VTOH2[VTLCN] LE 235] GOTO NPW3 (Lmin)
IF [VTOFH[VTLCN] LE -150] GOTO NPW4 (Dmax ID)

NWR05
IF [PTYP NE 5] GOTO NWR02
IF [VTOH3[VTLCN] LE 235] GOTO NPW3 (Lmin)
IF [VTOH3[VTLCN] GE 400] GOTO NPW3 (Lmax)

NWR02
VC284=0 (MARKER DLJA PROPUSKA POVTORNOGO ZAMERA)

NEX01                                 
(DOPUSK BIENIJA)    
VC980=0
PBLK=0.08 (dopusk bienija na dlinnu frezi so smennimi plastinami)
PBLM=0.04 (dopusk bienija na dlinnu monolitnoi frezi)
IF [PTR GT 0.19] GOTO NXT36
PQ=PBLM
GOTO NXT37

NXT36
PQ=PBLK

NXT37
(PARAMETERS OF THE BLUM)
(PH=VTLCN. TOOL LENGTH MEMORY OFFSET)
(PD=VTLCN. TOOL RADIUS MEMORY OFFSET)
(PB=1 -3=MEASURE NT,-2=CONTROL NT,-1=CHECK NT,0=MEASURE,1=CHECK,2=CONTROL,3=MEASURE NT)
(PE=0 TYPE  0=LENGTH+RADUIS,1=LENGTH,2=RADIUS)
(PM=+-  -1. SPECIAL FUNCTION -2,-1,1,2)
(PZ=PZ 5. LENGTH OFFSET FOR RADIUS MEASUREMENT)
(PX=PY 4.5 RADIUS OFFSET FOR LENGTH MEASUREMENT)
(PS=PLE2 0.05 MAXIMUM WEAR TOOL LENGTH)
(PT=PLE2 0.05 MAXIMUM WEAR TOOL RADIUS)
(PC=PTZ 3. NUMBER OF CUTTING EDGES)
(PQ=PQ 0.1 ALLOWED RUNOUT TOLERANCE)
(PW=0 ADDITIONAL LENGTH CORRECTION)
(PU=0 ADDITIONAL RADIUS CORRECTION)
(PA=3. NUMBER OF MEASUREMENTS)
(PR=0.01 MAX. VARIATION OF MEAS. RESULTS)

VC100=0 (SBROS SOSTOJANIJA OSHIBKI)
IF [VTLGN[VTLCN] NE 998] GOTO NGRU1
VSZOZ[45]=VTOH3[VTLCN]
VTOH3[VTLCN]=0

NGRU1
VC284=0
VC282=0
PZAM=0 (KOLVO DOP ZAMEROV)
PALM=0 (SKIP 1 RAZ ALARM BLUM 8.9.10.15)
GOTO NBC3

NBC1
IF [VC100 EQ 0] NBR1
IF [PALM GE 1] NBR1

PALM=PALM+1
VC282=VC282-1 (OTKAT SCHETCHIKA)

NBR1
VC556=VC556+1
M59
G4F1
M9

NBC3
CALL OBSEL
G04 F0.2
IF [VIRD[01138] EQ 1] NMEU
CALL OBMF PH=PH PTR=PTR PTZ=PTZ PTYP=PTYP PLE1=PLE1 PLE2=PLE2 PLE3=PLE3 PZ=PZ PA=PA PV=PV PX=PX PQ=PQ PSK=PS PRU=PRU
GOTO NSK1

NMEU
CALL OBMU PH=PH PTR=PTR PTZ=PTZ PTYP=PTYP PLE1=PLE1 PLE2=PLE2 PLE3=PLE3 PZ=PZ PA=PA PV=PV PX=PX PQ=PQ PSK=PS PRU=PRU

NSK1
PIZM=PIZM+1
IF [[VC100+VSTOD[50]] EQ 0] NID0
CALL OMIU
IF [VSTOD[39] GE PLQS] GOTO NVC284 (IZNOS UVELICHELSJA)
GOTO NVCA

NVC284
IF [VC284 EQ [PZAM+1]] GOTO NBC2 (MARKER DLJA PROPUSKA POVTORNOGO ZAMERA)

NVCA
IF [PALM  GE 1] NBR2
IF [VC100 EQ 4] GOTO NBC1
IF [VC100 EQ 7] GOTO NBC1
IF [VC100 EQ 8] GOTO NBC1
IF [VC100 EQ 9] GOTO NBC1
IF [VC100 EQ 10] GOTO NBC1
IF [VC100 EQ 15] GOTO NBC1
IF [VC100 EQ 16] GOTO NBC1
IF [VC100 EQ 19] GOTO NBC1

NBR2
IF [VC100 EQ 4] GOTO NBC2
IF [VC100 EQ 7] GOTO NBC2
IF [VC100 EQ 8] GOTO NBC2
IF [VC100 EQ 9] GOTO NBC2
IF [VC100 EQ 10] GOTO NBC2
IF [VC100 EQ 15] GOTO NBC2
IF [VC100 EQ 16] GOTO NBC2
IF [VC100 EQ 19] GOTO NBC2

CALL OMIU
IF [VSTOD[39] GE PLQS] GOTO NEFT (CHECK STRUJKA)
GOTO NBC4

NBC2
IF [VC282 LE PZAM] GOTO NBC1 (POVT ZAMER)
IF [VC282 GE [PZAM+2.]] GOTO NBC5 (SNJTIE STRUGKI NE POMOGLO)

NEFT CALL OFOS PLQF=VSTOD[39] PAA=PAA PLQS=PLQS(SNJTIE STRUGKI)
IF [VIRD[01138] EQ 1] GOTO NU13
VC961=VC993
VC962=VC994
GOTO NBC1

NU13
VC961=VIU1[VTLCN]
VC962=VTWOH[VTLCN]
GOTO NBC1

NBC5 (BLOKIROVKI)
VTLD3[VTLCN]=72
VTLD4[VTLCN]=128
IF [PS EQ 0] GOTO NBC4 (OCTS)
VOKF=1 (pallet block esli OCTE OCTI)

NBC4
IF [VTLGN[VTLCN] NE 998] GOTO NGRU2
VTOH3[VTLCN]=VSZOZ[45]

NGRU2
CALL OBIP (SAVE MAX WEAR VC980)

IF [PS EQ 0] GOTO NPS0 (OCTS)
IF [PS EQ 1] GOTO NPS1 (OCTE)
IF [PS EQ 2] GOTO NPS2 (OCTI)

NPS0 (OCTS)
IF [VC975 NE 0] GOTO NZER
VIU5[VTLCN]=VTOH2[VTLCN]
NZER
(CHECK WEAR 0)
IF [VTWOH[VTLCN] NE 0] GOTO NWTD96
VTWOH[VTLCN]=0.001
NWTD96
IF [VTWOD[VTLCN] NE 0] GOTO NPSO
VTWOD[VTLCN]=0.001
NPSO
IF [PTYP NE 3] GOTO NPS73
IF [VIU1[VTLCN] NE 0] GOTO NPS73
VIU1[VTLCN]=0.001
NPS73

CALL OMIU
IF [VSTOD[39] LT PLQS] GOTO NID0 (CHECK STRUJKA)
CALL OPRIN PA=327 PAA=PAA PLQF=VSTOD[39] PIZM=PIZM PLQS=PLQS
GOTO NEND
NID0
IF[VSTOD[50] NE 0] NIF10
IF [VIRD[01138] NE 1] GOTO NID73
IF [ABS[VSTOD[38]] GE PLE3] GOTO NPW7 (RAZNICA S OPTIKOI POSLE OCTS)
GOTO NID74
NID73 IF [VC990 EQ 1] GOTO NPW7 (RAZNICA S OPTIKOI)
NID74 IF [VC286 NE 0] GOTO NIF10
IF [VC287 NE 0] GOTO NIF10
IF [ABS[VC980] GE PLE3] GOTO NPW7 (RAZNICA S OPTIKOI POSLE OCTS)
GOTO NEND (CHECK WEAR 0)
NIF10
IF [ABS[VC980] GE PLE2] GOTO NPW9 (POLOMKA ZUBA POSLE OCTS)
IF [ABS[VC980] GE PLE1] GOTO NPW6 (IZNOS ZUBA POSLE OCTS)
IF [VC100 NE 0] GOTO NPMA    (CHECK ALARM MEASURE)
GOTO NEND (CHECK WEAR 0)

NPS1 (OCTE)
(CHECK WEAR 0)   
IF [VTWOH[VTLCN] NE 0] GOTO NWTD97
VTWOH[VTLCN]=0.001
NWTD97
IF [VTWOD[VTLCN] NE 0] GOTO NPS10
VTWOD[VTLCN]=0.001
NPS10
IF [PTYP NE 3] GOTO NPS74
IF [VIU1[VTLCN] NE 0] GOTO NPS74
VIU1[VTLCN]=0.001
NPS74

CALL OMIU
IF [VSTOD[39] LT PLQS] GOTO NID1 (CHECK STRUJKA)
CALL OPRIN PA=327 PAA=PAA PLQF=VSTOD[39] PIZM=PIZM PLQS=PLQS
GOTO NEND
NID1
IF [ABS[VC980] GE PLE2] GOTO NPW5 (POLOMKA ZUBA POSLE OCTE)
IF [ABS[VC980] GE PLE1] GOTO NPW6 (IZNOS ZUBA POSLE OCTE)
IF [VC100 NE 0] GOTO NPMA    (CHECK ALARM MEASURE)
GOTO NEND (V KONEC)

NPS2 (OCTI - esli octi vernut vse obratno i viiti)
CALL OMIU
IF [VSTOD[39] LT PLQS] GOTO NID2 (CHECK STRUJKA)
CALL OPRIN PA=327 PAA=PAA PLQF=VSTOD[39] PIZM=PIZM PLQS=PLQS
GOTO NPV3
NID2
VC294=VTWOH[VTLCN] (VC294=VC971)
IF [ABS[VC980] GE PLE2] GOTO NPW5 (POLOMKA ZUBA POSLE OCTI)
IF [ABS[VC980] GE PLE1] GOTO NPMA (IZNOS ZUBA POSLE OCTI)
IF [VC100 NE 0] GOTO NPMA 

NPV3
IF [VIRD[01138] EQ 1] GOTO NPS201
VTOFH[VTLCN]=VC970               (HA)
VTWOH[VTLCN]=VC971               (HA_W)
VTOH2[VTLCN]=VC974+VC975         (HB+HB_W)
VIU1[VTLCN]=VC975                (HB_W)
VTOFD[VTLCN]=VC972               (DA)
VTWOD[VTLCN]=VC973               (DA_W)
GOTO NPS202

NPS201
VTOFH[VTLCN]=VC970              (-D)
VTWOH[VTLCN]=VC971              (D_W)
VTOH2[VTLCN]=VC974+VC975        (HB+HB_W)
VIU1[VTLCN]=VC975               (HB_W)
VTOH3[VTLCN]=VC978+VC979        (HC+HC_W)
VIU3[VTLCN]=VC979               (HC_W)
NPS202
GOTO NEND (V KONEC)

(Alarms)
NPW1 (V TABLICE NEVERNO UKAZANA DLINNA INSTRUMENTA, INSTRUMENT ZABLOKIROVAN)
CALL OP01 PAA=01 PS=PS  
GOTO NTB1

NPW2 (V TABLICE NEVERNO UKAZAN RADIUS INSTRUMENTA, INSTRUMENT ZABLOKIROVAN)
CALL OP01 PAA=02 PS=PS 
GOTO NTB1

NPW3 (V TABLICE NEVERNO UKAZANA DLINA DANDREA, INSTRUMENT ZABLOKIROVAN)
CALL OP01 PAA=03 PS=PS 
GOTO NTB1

NPW4 (V TABLICE NEVERNO UKAZAN DIAMETR DANDREA, INSTRUMENT ZABLOKIROVAN)
CALL OP01 PAA=04 PS=PS  
GOTO NTB1

NPW5 (POLOMKA ZUBA POSLE OCTE/OCTI INSTRUMENTA, PAL. ZABL.)
CALL OP01 PAA=05 PS=PS 
GOTO NTB3

NPW6 (IZNOS ZUBA POSLE OCTS/OCTE)
CALL OP01 PAA=06 PS=PS
GOTO NTB1

NPW7 (PREVISHEN DOPUSK OPTIKI OCTS, INSTRUMENT ZABLOKIROVAN)
CALL OP01 PAA=07 PS=PS 
GOTO NTB1

NPW8 (V PROGRAMME NE VERNO UKAZAN SPOSOB IZMERENIJA INSTRUMENTA, PAL. ZABL.)
CALL OP01 PAA=08 PS=PS 
GOTO NTB3

NPW9 (POLOMKA ZUBA POSLE OCTS)
CALL OP01 PAA=09 PS=PS
GOTO NTB1

NPMA (ALARM PRI MEASURE BLUM)
CALL OP01 PS=PS PAA=98
IF [PS EQ 0] GOTO NTB1 (ESLI OCTS,TOOL BLOCK)
GOTO NTB3 (ESLI OCTE/OCTI TOOL&PALLET BLOCK)

NTB1 (TOOL BLOCK)
IF[VC100 EQ 0] NTB111
VTWOH[VTLCN]=VC971
VIU1[VTLCN]=VC975
VIU3[VTLCN]=VC979

NTB111
VTLD3[VTLCN]=72
VTLD4[VTLCN]=128
GOTO NEND

NTB2 (PALET BLOCK)
VOKF=1
GOTO NEND

NTB3 (TOOL&PALET BLOCK)
IF[VC100 EQ 0] NTB311
VTWOH[VTLCN]=VC971
VIU1[VTLCN]=VC975
VIU3[VTLCN]=VC979
NTB311

VTLD3[VTLCN]=72
VTLD4[VTLCN]=128
VOKF=1
GOTO NEND

NEND
IF [PS NE 1] GOTO NEXT6
IF [PUQR EQ 0] GOTO NEXT6
IF [VIRD[01138] NE 1] GOTO NEXT7
PDU5=VTWOH[VTLCN]
GOTO NEXT8

NEXT7 PDU5=VTWOD[VTLCN]

NEXT8
CALL OP01 PAA=97 PDU5=PDU5 (ZAPIS NOVOGO IZNOSA)
VC298=0 (STIRANIE POSLEDNEGO ZAMERENNOGO INSTRUMENTA)

NEXT6
VC281=VC281+1
IF [PS EQ 0] GOTO NPS01
CALL OUAX
GOTO NPS02

NPS01
CALL OUAX PPP=1

NPS02
PSD6=30

N251
VSTOD[PSD6]=0
PSD6=PSD6+1
IF [PSD6 EQ 50]N351
GOTO N251

N351
VSTOH[40]=0
RTS


N10007 
OVC
(OBNULENIE GLOBALNIH PEREMENNIH)
(ne obnuljat !!!)
(VC260-VC280 - Marker nulevoi tochki aktiviruetsja iz upravl. programmi NX)
(VC283 - PEREKLUCHENIE REGIMA - VIVOD OSHIBKI NA FASTEMS - OSTANOVKA STANKA - NALIPANIE STRUGKI)
(VC288 - zapominanie visoti vidvigenija kubika)
(VC289 - posledovatelnii nomer perehoda iz upravl. programmi NX)
(VC291 - data poslednei kalibrovki stanka iz OSKS)
(VC292 - nomer palleti iz OAPH)
(VC293 - pologenie ustanovki prisposoblenija na pallete 999-sbros, 0, 90, 180, 270, 360-centr, 777-fiksir  iz   OAPH)
(VC949,951,953,955,957,959 - BACKLASH dlja D'Andrea SOOTV VTLCN+800.)
(VC950,952,954,956,958,960 - VELICHINA AVTOKOREKCII POSLE ... RENISHAW DLINNA)
(VC901)
(VC902 WEAR OR CORRECTION FROM OPHWR)
(VC900 ZNACHENIE GROUP+SERIAL TEKUSHEGO INSTRUMENTA PROG: CALL OPTF)
(VC903 NOMER ZAPISANOI JACHIEKI INSTRUMENTA CALL OPPOT)

(obnuljaetsja v OVC)
VC284=0 (MARKER POVTORA IZMERENIJA - VIVOD OSHIBKI NA FASTEMS - OSTANOVKA STANKA - NALIPANIE STRUGKI)
VC285=0 (zapominanie sposoba izmerenija v avto-korrekcii OCRS dlja otcheta)
VC286=0 (zapominanie poslednego znachenija iznosa dlinni iz tablici pered zamerom instrumenta dlja otcheta)
VC287=0 (zapominanie poslednego znachenija iznosa diametra iz tablici pered zamerom instrumenta dlja otcheta)
VC290=0 (propusk lishnei produvki sharika  OUAX-obnuljaet   OPRW-zapisivaet)
VC294=0 (sohranenie faktich iznosa po diametru Dandrea v OCTI posle tehnologicheskoi protochki dlja otcheta)
VC295=0 (sohranenie faktich iznosa po diametru Dandrea iz tablici v ORW kotorii bil zameren v OCTS pered tehnologich prohodom)
VC296=0 (fakt vremja raboti instrumenta v poslednem perehode)
VC297=0 (zapominanie ostatochnogo resursa instrumenta v OCTS)
VC298=0 (poslednii zamerennii nomer instrumenta v OCTE dlja propuska OCTS)
VC299=0 (ugol megdu regushimi kromkami)
VC300=0 (obshii ugol povorota pervogo zuba iz tablici stanka + iz NX)
VC900=0 (ZNACHENIE GROUP+SERIAL TEKUSHEGO INSTRUMENTA PROG: CALL OPTF)
VC903=0 (NOMER ZAPISANOI JACHIEKI INSTRUMENTA CALL OPPOT)

(DRUGIE PEREMENNIE V MACROSE)
(VC1,VC2,VC3,VC4,VC5,VC11,VC12,VC13,VC14,VC212-VC229,VC963, VC970-VC981)
(VSZOX[50],VSZOY[50],VSZOZ[50],VSZOZ[49],VSZOX[45])
(VSTOD[31]-VSTOD[50])
(VIU1[]-VIU6[])
RTS
 

N10008
OUAX
(HP U-AXIS FOR TOOL-CHANGER tochka smeni)
M5
M9
IF [VTLCN EQ 0] GOTO NSMP
IF [VTLGN[VTLCN] NE 999] GOTO NMP1

NSMP
PSP1=100
GOTO NMP2

NMP1
PSP1=VSCOD

NMP2
IF [VORD[0000B] EQ 1] GOTO NEND
IF [VRSTT EQ 128] GOTO NEND
IF [VTLCN EQ 0] GOTO NXT51
IF [PPP GE 1] GOTO NXT51
VC290=0 (DLJA OTKLUCHENIJA PROPUSKA OPRW-PRODUVKA SHARIKA)
CALL OPTF PTOL=0 (ZAPIS VC900 NOMER ACT TOOL)
IF [VTLGN[VTLCN] EQ 999] GOTO NXT51
IF [VTLGN[VTLCN] EQ 998] GOTO NXT51
IF [VTLGN[VTLCN] EQ 997] GOTO NXT51
IF [VTLGN[VTLCN] EQ 996] GOTO NXT51
IF [VTLGN[VTLCN] EQ 995] GOTO NXT51
IF [VC900 EQ VC298] GOTO NXT97    (poslednii zamerennii nomer instrumenta v OCTE)
GOTO NDF
IF [VC900 EQ 9990001] GOTO NXT51 (RENISHAW)
IF [VC900 EQ 9950001] GOTO NXT51 (ETALON BLUM)
IF [VC900 EQ 9980001] GOTO NXT51 (ETALON MC)
IF [VC900 EQ 9970001] GOTO NXT51 (PRODUVKA) 
IF [VC900 EQ 9960001] GOTO NXT51  (PROMIVKA)

NDF
GOTO NXT96

NXT97
IF [VTLD8[VTLCN] LT VC297] GOTO NXT96
GOTO NXT51

NXT96
S100 M3
M8
G04 F1
M9
M5
M12
G04 F1
S100 M3
G04 F1

NXT51
M318 (PRODUVKA SOEDINENIJA U-AXIS)
G04 F0.5
IF [VTLCN EQ 0] GOTO NEND
M12
G04 F0.5
IF [VTLGN[VTLCN] EQ 999] GOTO NEND (RENISHAW)
M59
G04 F0.5
IF [VIRD[01138] NE 1] GOTO NEND
G0 U1.2
G0 U1

NEND
M5
IF [PSP1 GE 50] GOTO NPSP3
PSP1=100

NPSP3
M5
VC963=PSP1
S=PSP1 
M9
M317
RTS


N10009
OBACK (BACKLACH COMPENSATION U-AXIS LUFT)
(BACKLASH DATA FOR D'ANDREA)
IF [VIRD[01138] NE 1] GOTO NEND  (1-UAXIS 0-STND TOOL)
IF [VORD[0000B] EQ 1] GOTO NEND (BLOKIROVKA PRIVODOV)
CALL OUAX PPP=1
IF [VOKF EQ 1] GOTO NEND (BLOCK/ERROR PALLETA)

VBLCU=VC[800+VTLCN]  (VC949...VC959)

(ADD+ OLD CODE)
IF [VORD[0000B] EQ 1] GOTO NEND
IF [VOKF EQ 1] GOTO NEND
PTUQ=0.15 (DOPUSK NA KOMPENSACIU LUFTA V PEREMENNIX VC949-VC959)

IF [ABS[VBLCU] GE PTUQ] GOTO NUB1
IF [VBLCU EQ 0] GOTO NUB2
IF [VBLCU LT 0.03] GOTO NUB2
IF [VBLCU GT 0.11] GOTO NUB2
GOTO NUB3

NUB2
VC[800+VTLCN]=0.055
GOTO NUB3

NUB1 (SLISHKOM BOLSHAJA KOMPENSACIJA LUFTA V KORRECTORE VC949-959 NA DANDREA, INSTR. ZABL.)
CALL OPRIN PA=57 PAA=7 PTUQ=PTUQ
VTLD3[VTLCN]=72
VTLD4[VTLCN]=128
GOTO NEND

NUB3
VBLCU=VC[800+VTLCN]
NEND
RTS


N10010
OPHWD (OCRS, MACRO FOR PH)
IF [PH EQ 10001] GOTO NA001
GOTO NA002

NA001
VTWOD[PCT]=VTWOD[PCT]+PDW
GOTO NEND

NA002
IF [PH EQ 10002] GOTO NA022
GOTO NA003

NA022
VIU2[PCT]=VIU2[PCT]+PDW
GOTO NEND

NA003
IF [PH EQ 10003] GOTO NA033

NA033
VIU4[PCT]=VIU4[PCT]+PDW
NEND
RTS


N10011
ORB 
(VIRAVNIVANIE OSI B)
(CALL ORB PX1=-70 PX2=70 PY=0 PZ=71 PR=30 PP=1)
IF [VORD[0000B] EQ 1] GOTO NEND
IF [VRSTT EQ 128] GOTO NEND
IF [VACOD GT 1] GOTO NMCS1
CALL OUAX PPP=1
IF [VOKF EQ 1] GOTO NEND
G94 G90
G30 P1
G0 M403 B0
TG=997 M6
TG=999
G0 X=PX1 Y=PY
M12
M59
G56 HA
G0 Z=PZ+PR
S333 M3
G04 F3
IF [PR GE 30] GOTO NX6
G0 Z=PZ+30
G04 F3
G0 Z=PZ+PR

NX6
G0 X=PX2 Y=PY
G04 F3
IF [PR GE 30] GOTO NST4
G0 Z=PZ+30
G04 F3
G0 Z=PZ+PR

NST4
M5
M9
G30 P1
M6
CALL OPRW PAA=0
G56 HA
CALL OO18

NST1
G0 X=PX1 Y=PY
G0 Z=PZ+PR
CALL OO10 PMOD=3 PEI=PZ PUDT=PR POVT=10
PZ1=VS27
G0 Z=PZ+PR 
G0 X=PX2
CALL OO10 PMOD=3 PEI=PZ PUDT=PR POVT=10
PZ2=VS27
PZZ=ABS[PZ1-PZ2]
PXX=PX2-PX1
PB=ATAN[PZZ/PXX] 
IF [PZ1 LE PZ2] GOTO N200
VZOFB[VACOD]=VZOFB[VACOD]+PB
M130
IF [PX1 LT PX2] GOTO N1
G1 B0 M16 F100
GOTO N2

N1 G1 B0 M15 F100

N2 M131
GOTO N300

N200
VZOFB[VACOD]=VZOFB[VACOD]-PB
M130
IF [PX1 LT PX2] GOTO N3
G1 B0 M15 F100
GOTO N4

N3 G1 B0 M16 F100
N4 M131

N300
IF [ABS[PB] LE 0.0007] GOTO NFIN
PDIF=ABS[PZ1-PZ2]
IF [PDIF LE 0.005] GOTO NFIN
GOTO NST1

NFIN
CALL OO19
CALL OPRW PAA=0
VC290=1 (DLJA PROPUSKA OPRW)
G30 P1
GOTO NEND

NMCS1 (POPITKA REALIZOVAT AVTOPRIVJAZKU NE IZ TOCHKI No.1 , PAL. ZABL.)
CALL OPRIN PA=61 PAA=9 PP=PP
VOKF=1
NEND
RTS


N10012
ORPA 
(PRIVJAZKA K DETALI PRI POMOSHI RENISHAW)
(CALL ORPA PXOZ= PYOZ= PZOZ=  PXOY= PYOX= PA= PR= PDI= PX= PY= PZ= PP= PLY= PLX= PX1= PY1=)
IF [VORD[0000B] EQ 1] GOTO NENDX
IF [VRSTT EQ 128] GOTO NENDX
IF [VOKF EQ 1] GOTO NENDX
CALL OUAX PPP=1
G30 P1

CALL OPPOT PTG=997 PTS=1
IF [VTLCN EQ VC903] GOTO NT999L
TG=997 M6

NT999L
TG=999 (RENI PRESET)

G94 G90
G0 M403 B0
PZOZ=ABS[PZOZ]
IF [PA EQ 1]  GOTO NTP1    (PO LEV NIGNEMU UGLU)
IF [PA EQ 2]  GOTO NTP2    (PO LEV VERHNEMU UGLU)
IF [PA EQ 3]  GOTO NTP3    (PO PRAV VERHNEMU UGLU)
IF [PA EQ 4]  GOTO NTP4    (PO PRAV NIGNEMU UGLU)
IF [PA EQ 5]  GOTO NTP5    (PO CENTRU OTVERSTIJA)
IF [PA EQ 6]  GOTO NTP6    (PO CENTRU BOBISHKI)
IF [PA EQ 7]  GOTO NTP7    (PO CENTRU PAZA ILI VISTUPA VDOL OSI X)
IF [PA EQ 8]  GOTO NTP8    (PO CENTRU PAZA ILI VISTUPA VDOL OSI Y)
IF [PA EQ 9]  GOTO NTP9    (PO STENKE VDOL OSI X)
IF [PA EQ 10] GOTO NTP10   (PO STENKE VDOL OSI Y)
IF [PA EQ 11] GOTO NTP11   (PO PLOSKOSTI VDOL OSI Z)

NTP1 (PRODUVKA PO LEV NIGNEMU UGLU)
PZPZ=-1*PZOZ
PXPZ=ABS[PXOZ]
PYPZ=ABS[PYOZ]
PYPX=ABS[PYOX]
PXPY=ABS[PXOY]
PPDX=-1*ABS[PR]
PPDY=-1*ABS[PR]
GOTO NST6

NTP2 (PRODUVKA PO LEV VERHNEMU UGLU)
PZPZ=-1*PZOZ
PXPZ=ABS[PXOZ]
PYPZ=-1*ABS[PYOZ]
PYPX=-1*ABS[PYOX]
PXPY=ABS[PXOY]
PPDX=-1*ABS[PR]
PPDY=ABS[PR]
GOTO NST6

NTP3 (PRODUVKA PO PRAV VERHNEMU UGLU)
PZPZ=-1*ABS[PZOZ]
PXPZ=-1*ABS[PXOZ]
PYPZ=-1*ABS[PYOZ]
PYPX=-1*ABS[PYOX]
PXPY=-1*ABS[PXOY]
PPDX=ABS[PR]
PPDY=ABS[PR]
GOTO NST6

NTP4 (PRODUVKA PO PRAV NIGNEMU UGLU)
PZPZ=-1*ABS[PZOZ]
PXPZ=-1*ABS[PXOZ]
PYPZ=ABS[PYOZ]
PYPX=ABS[PYOX]
PXPY=-1*ABS[PXOY]
PPDX=ABS[PR]
PPDY=-1*ABS[PR]
GOTO NST6

NST6
S333 M3
M12
M59
G0 X=PXPZ Y=PYPZ 
G56 HA
G0 Z=ABS[PR]
G04 F3
G0 Y=PYPX X=PPDX
G0 Z=PZPZ
G04 F3
G0 Z=ABS[PR]
G0 Y=PPDY  X=PXPY
G0 Z=PZPZ
G04 F3
G0 Z=ABS[PR]
GOTO NST5

NTP5 (PRODUVKA PO CENTRU OTVERSTIJA)
PZPZ=-1*PZOZ
G0 X=PX Y=PY
S333 M3
M12
M59
G56 HA
G0 Z=PZPZ+PZ
G04 F3
GOTO NST5

NTP6 (PRODUVKA PO CENTRU BOBISHKI)
PDIR=ABS[PDI/2]+ABS[PR]
PLX1=PX-PDIR
PLX2=PX+PDIR
PLY1=PY-PDIR
PLY2=PY+PDIR
PLZ1=ABS[PR]+PZ
PLZ2=PLZ1-ABS[PR+PZOZ]
G0 X=PX Y=PY
S333 M3
M12
M59
G56 HA
G0 Z=PLZ1
G04 F0.5
G0 X=PLX1
G0 Z=PLZ2
G04 F2
G0 Z=PLZ1
G0 X=PLX2
G0 Z=PLZ2
G04 F2
G0 Z=PLZ1
G0 X=PX Y=PY
G0 X=PLY2
G0 Z=PLZ2
G04 F2
G0 Z=PLZ1
G0 X=PLY1
G0 Z=PLZ2
G04 F2
G0 Z=PLZ1
G0 X=PX Y=PY
G04 F0.5
GOTO NST5

NTP7 (PRODUVKA PO CENTRU PAZA ILI VISTUPA VDOL OSI X)
G0 X0 Y=PLY
S333 M3
M12
M59
G56 HA
G0 Z=ABS[PR]+PZ
IF [PR LT 0] GOTO NTP77

(PRODUVKA PO CENTRU VISTUPA VDOL OSI X)
PLX1=PLX/2
PLX2=PLX1+ABS[PR]
PLZ1=ABS[PR]+PZOZ
PLZ2=-1*PLZ1
G0 X=-1*PLX2
G0 G91 Z=PLZ2
G04 F3
G0 G90 Z=ABS[PR]+PZ
G0 X=PLX2
G0 G91 Z=PLZ2
G04 F3
G0 G90 Z=ABS[PR]+PZ
GOTO NST5

NTP77 (PRODUVKA PO CENTRU PAZA VDOL OSI X)
G0 Z=-1*PZOZ+PZ
G04 F3
GOTO NST5

NTP8 (PRODUVKA PO CENTRU PAZA ILI VISTUPA VDOL OSI Y)
G0 X=PLX Y=0
S333 M3
M12
M59
G56 HA
G0 Z=ABS[PR]+PZ
IF [PR LT 0] GOTO NTP88

(PRODUVKA PO CENTRU VISTUPA VDOL OSI Y)
PLY1=PLY/2
PLY2=PLY1+ABS[PR]
PLZ1=ABS[PR]+PZOZ
PLZ2=-1*PLZ1
G0 Y=-1*PLY2
G0 G91 Z=PLZ2
G04 F3
G0 G90 Z=ABS[PR]+PZ
G0 Y=PLY2
G0 G91 Z=PLZ2
G04 F3
G0 G90 Z=ABS[PR]+PZ
GOTO NST5

NTP88 (PRODUVKA PO CENTRU PAZA VDOL OSI Y)
G0 Z=-1*PZOZ+PZ
G04 F3
GOTO NST5

NTP9 (PRODUVKA PO STENKE VDOL OSI X)
G0 Y=PY X=PX+PR
S333 M3
M12
M59
G56 HA
G0 Z=PZ
G04 F3
GOTO NST5

NTP10 (PRODUVKA PO STENKE VDOL OSI Y)
G0 Y=PY+PR  X=PX
S333 M3
M12
M59
G56 HA
G0 Z=PZ
G04 F3
GOTO NST5

NTP11 (PRODUVKA PO PLOSKOSTI VDOL OSI Z)
G0 X=PX Y=PY
S333 M3
M12
M59
G56 HA
G0 Z=PZ+ABS[PR]
G04 F3
IF [ABS[PR] GE 30] GOTO NST5
G0 Z=PZ+30
G04 F3
GOTO NST5

NST5
M5
M9
G30 P1
M6
IF [VC290 EQ 1] GOTO NXT98
CALL OPRW PAA=0

NXT98
G94 G90
G56 HA
G0 M403 B0
PZOZ=ABS[PZOZ]
CALL OO18
IF [PA EQ 1] GOTO NP1   (PO LEV NIGNEMU UGLU)
IF [PA EQ 2] GOTO NP2   (PO LEV VERHNEMU UGLU)
IF [PA EQ 3] GOTO NP3   (PO PRAV VERHNEMU UGLU)
IF [PA EQ 4] GOTO NP4   (PO PRAV NIGNEMU UGLU)
IF [PA EQ 5] GOTO NP5   (PO CENTRU OTVERSTIJA)
IF [PA EQ 6] GOTO NP6   (PO CENTRU BOBISHKI)
IF [PA EQ 7] GOTO NP7   (PO CENTRU PAZA ILI VISTUPA VDOL OSI X)
IF [PA EQ 8] GOTO NP8   (PO CENTRU PAZA ILI VISTUPA VDOL OSI Y)
IF [PA EQ 9] GOTO NP9   (PO STENKE VDOL OSI X)
IF [PA EQ 10] GOTO NP10 (PO STENKE VDOL OSI Y)
IF [PA EQ 11] GOTO NP11 (PO PLOSKOSTI VDOL OSI Z)
GOTO NEND

NP1 (PO LEV NIGNEMU UGLU)
PZOZ=-1*PZOZ
PXOZ=ABS[PXOZ]
PYOZ=ABS[PYOZ]
PYOX=ABS[PYOX]
PXOY=ABS[PXOY]
PUDX=-1*ABS[PR]
PUDY=-1*ABS[PR]
GOTO NP100

NP2 (PO LEV VERHNEMU UGLU)
PZOZ=-1*PZOZ
PXOZ=ABS[PXOZ]
PYOZ=-1*ABS[PYOZ]
PUDX=-1*ABS[PR]
PYOX=-1*ABS[PYOX]
PXOY=ABS[PXOY]
PUDY=ABS[PR]
GOTO NP100

NP3 (PO PRAV VERHNEMU UGLU)
PZOZ=-1*ABS[PZOZ]
PXOZ=-1*ABS[PXOZ]
PYOZ=-1*ABS[PYOZ]
PYOX=-1*ABS[PYOX]
PXOY=-1*ABS[PXOY]
PUDX=ABS[PR]
PUDY=ABS[PR]
GOTO NP100

NP4 (PO PRAV NIGNEMU UGLU)
PZOZ=-1*ABS[PZOZ]
PXOZ=-1*ABS[PXOZ]
PYOZ=ABS[PYOZ]
PYOX=ABS[PYOX]
PXOY=-1*ABS[PXOY]
PUDX=ABS[PR]
PUDY=-1*ABS[PR]
GOTO NP100

NP5 (PO CENTRU OTVERSTIJA)
PZOZ=-1*PZOZ
G0 X=PX Y=PY
G0 Z=PZOZ+PZ
CALL OO10 PMOD=7 PDI=PDI 
CALL OO20 PHN=PP PX=PX1 PY=PY1
GOTO NEND

NP6 (PO CENTRU BOBISHKI)
G0 X=PX Y=PY
G0 Z=ABS[PR]+PZ
CALL OO10 PMOD=6 PDI=PDI PZIN=PR+PZOZ PUDT=PR 
CALL OO20 PHN=PP PX=PX1 PY=PY1
GOTO NEND

NP7 (PO CENTRU PAZA ILI VISTUPA VDOL OSI X)
G0 X0 Y=PLY
G0 Z=ABS[PR]+PZ
IF [PR LT 0] GOTO NXD
(PO CENTRU VISTUPA VDOL OSI X)
CALL OO10 PMOD=11 PELI=PLX PIN=ABS[PR]+PZOZ PUDT=PR POVT=10 
GOTO NFIN

NXD (PO CENTRU PAZA VDOL OSI X)
G0 Z=-1*PZOZ+PZ
CALL OO10 PMOD=11 PELI=PLX POVT=10
NFIN
CALL OO20 PHN=PP PX=0
GOTO NEND

NP8 (PO CENTRU PAZA ILI VISTUPA VDOL OSI Y)
G0 X=PLX Y0
G0 Z=ABS[PR]+PZ
IF [PR LT 0] GOTO NYD
(PO CENTRU VISTUPA VDOL OSI Y)
CALL OO10 PMOD=12 PELI=PLY PIN=ABS[PR]+PZOZ PUDT=PR POVT=10 
GOTO NFIN1

NYD (PO CENTRU PAZA VDOL OSI Y)
G0 Z=-1*PZOZ+PZ
CALL OO10 PMOD=12 PELI=PLY POVT=10

NFIN1
CALL OO20 PHN=PP PY=0
GOTO NEND

NP9 (PO STENKE VDOL OSI X)
G0 Y=PY X=PX+PR
G0 Z=PZ
CALL OO10 PMOD=1 PEI=PX PUDT=ABS[PR] POVT=10 
CALL OO20 PHN=PP PX=PD
GOTO NEND

NP10 (PO STENKE VDOL OSI Y)
G0 Y=PY+PR  X=PX
G0 Z=PZ
CALL OO10 PMOD=2 PEI=PY PUDT=ABS[PR] POVT=10 
CALL OO20 PHN=PP PY=PD
GOTO NEND

NP11 (PO PLOSKOSTI VDOL OSI Z)
G0 X=PX Y=PY
G0 Z=PZ+ABS[PR]
CALL OO10 PMOD=3 PEI=PZ PUDT=ABS[PR] POVT=10 
CALL OO20 PHN=PP PZ=PD
GOTO NEND

NP100 
G0 X=PXOZ Y=PYOZ 
G56 HA
G0 Z=ABS[PR]
CALL OO10 PMOD=3 PEI=0 PUDT=PR POVT=10 
CALL OO20 PHN=PP PZ=0
G0 Z=ABS[PR]
G0 Y=PYOX X=PUDX
G0 Z=PZOZ
CALL OO10 PMOD=1 PEI=0 PUDT=PR POVT=10 
G0 Z=ABS[PR]
G0 Y=PUDY  X=PXOY
G0 Z=PZOZ
CALL OO10 PMOD=2 PEI=0 PUDT=PR POVT=10 
CALL OO20 PHN=PP PX=0 PY=0

NEND
CALL OO19
VZOFB[PP]=VZOFB[VACOD]
CALL OPRW PAA=0
VC290=1 (DLJA PROPUSKA OPRW V NACHALE)
G30 P1
NENDX
RTS


N10013
OFFS
(TEORETICHESKOE POLOGENIE NULEVOI TOCHKI)
(CALL OFFS PX= PY= PZ= PB= PP=)
IF [VRSTT EQ 128] GOTO NEND
IF [VORD[0000B] EQ 1] GOTO NEND
IF [VOKF EQ 1] GOTO NEND
IF [PP GT 1] GOTO NPW6
N1 VZOFX[VACOD]=PX
N2 VZOFY[VACOD]=PY
N3 VZOFZ[VACOD]=PZ
GOTO NEND

NPW6 (POPITKA PEREZAPISAT TEORETICHESKOE POLOGENIE NULEVOI TOCHKI NE V TOCHKU No.1, PALLETA ZABLOKIROVANA)
CALL OPRIN PA=39 PAA=5 PP=PP
VOKF=1
NEND
RTS


N10014
OMCS
(KINEMATICHESKAJA TRANSFORMACIJA AVTOPRIVJAZKA)
(CALL OMCS PX=0 PY=0 PZ=0 PB=90 PP=1)
IF [VOKF EQ 1] GOTO NEND
VZOFX[100]=VZOFX[VACOD]
VZOFY[100]=VZOFY[VACOD]
VZOFZ[100]=VZOFZ[VACOD]
VZOFB[100]=VZOFB[VACOD]
PMCS=VACOD
IF [PMCS NE 1] GOTO NMCS1
PCSN=PMCS
CALL OO88 PX=PX PY=PY PZ=PZ PB=PB PH=[100] PP=PP
VZOFB[VACOD]=VZOFB[VACOD]+PB
GOTO NEND

NMCS1 (POPITKA REALIZOVAT AVTOPRIVJAZKU NE IZ TOCHKI No.1 , PAL. ZABL.)
CALL OPRIN PA=58 PAA=8 PP=PP PMCS=PMCS
VOKF=1
NEND
RTS


N10015
OBSEL 
(VIBOR OBOROTOV)
CALL OBACK
VSTOD[49]=1 (OBOROTI VKL)
IF [VIRD[01138] NE 0] GOTO NST1 
(STANDART TOOL)
S=VSZOX[10]
GOTO NM3

(U-axis TOOL)
NST1
IF[ABS[VSTOD[48]] EQ 1] NMU1
IF[ABS[VSTOD[48]] EQ 12.5] NMU2
IF[VSTOD[48] EQ 25] NMU3
IF[VSTOD[48] EQ -25] NMU4
IF[VSTOD[48] EQ 37.5] NMU5
IF[VSTOD[48] EQ -37.5] NMU6
VOKF=1
GOTO NEND

NMU1
PSHU=0
VSTOD[47]=0
GOTO NMUD

NMU2
PSHU=VSTOD[48]*-2
VSTOD[47]=VSTOD[48]*-1
GOTO NMUD

NMU3
PSHU=-45 
VSTOD[47]=-22.5
GOTO NMUD

NMU4
PSHU=45 
VSTOD[47]=22.5
GOTO NMUD

NMU5
PSHU=-45
VSTOD[47]=-22.5
GOTO NMUD

NMU6
PSHU=45 
VSTOD[47]=22.5

NMUD
G0 U=PSHU+0.2
G0 U=PSHU
S1000
IF [ABS[VSTOD[48]] EQ 37.5] GOTO NS2
IF [VSTOD[48] EQ -25] GOTO NS2
GOTO NM3 (VKL OBOROTOV)

NS2
S700

NM3
M3
NEND
RTS


N10016
OPRS
(ORIENTACIJA SHPINDELJA)
IF [VC299 LT 0] GOTO N2
IF [VC299 GE 360] GOTO N1
GOTO NEND

N1
VC299=VC299-360
GOTO NEND

N2
VC299=VC299+360

NEND
G04 F0.1
M19 RS=VC299
G04 F0.1
RTS


N10017
OPRW
(PRODUVKA SHARIKA RENISHAW PRI POMOSHI BLUM)
PSHN=VACOD
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT59
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT59
VTLD8[VTLCN]=1

NXT59
M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ 999] GOTO NXT7
TG=999 M6

NXT7
IF [PSTG EQ 999] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
IF [VSZOY[2] GE [VC288+0.5]] GOTO NXT15
IF [VSZOY[2] LE [VC288-0.5]] GOTO NXT15
GOTO NXT16

NXT15
VC288=VSZOY[2]

NXT16
VZOFX[200]=VSZOX[2]
VZOFY[200]=VC288
VZOFZ[200]=VSZOZ[2]
VZOFB[200]=0
VZOFU[200]=0
G15 H200

NXT3
M12
S100 M3
M155
G04 F1
M144
G0 X-5 Y0
G56 HA
Z5
G04 F0.5
Z-3
G04 F0.5
Z5
G04 F0.5
G0 G16 Z600 H0
M154
G04 F0.5
M145
IF [PSTG EQ 999] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PSHN EQ 200] GOTO NXT5
G15 H=PSHN

NXT5
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0

NX2
M9
RTS


N10018 
OPRMV
(UNIVERSALNAJA PROMIVKA PALLETi S ZAGATOI DETALU)

/GOTO NXT3 (PROPUSTIT PROMIVKU)
CALL OPRIN PA=312 PAA=PAA
GOTO NXT8

NXT3
PPOT=VTLCN (SAVE ACTIVE TOOL POT)
PSHN=VACOD
CALL OPTF PTOL=0 (SAVE TOOL TF)
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT64
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[PPOT]
IF [PSTT GT 1] GOTO NXT64
VTLD8[PPOT]=1

NXT64
M5
M9
G0 G16 Z600 H0
M12
M154
M145
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX
IF [PSTG EQ 996] GOTO NXT7
TG=996 M6

NXT7
IF [PSTG EQ 996] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
VZOFX[199]=0
VZOFY[199]=0
VZOFZ[199]=0
VZOFB[199]=0
VZOFU[199]=0
G15 H199
M279
G94
G0 G16 Z600 H0
G0 X350
G0 Y951
G0 M403 B333
CALL OPRM Q5
M9
M279
M12
G0 G16 Z600 H0
G0 X350
G0 Y951
G0 B45
G04 F2
M278
M59
G04 F2
M9
M12
G04 F10
CALL OUAX PPP=1
IF [PSTG EQ 996] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PSHN EQ 199] GOTO NXT5
G15 H=PSHN

NXT5
CALL OPRIN PA=313 PAA=PAA

NXT8
RTS


N10019 
OPRM
(TRAEKTORIJA PROMIVKI PALLET)
G94
S100 M3
M51
M8
G0 G91 B72
G0 G90 X-351
G56 HA
G0 Z180
G0 X-150 Y600
F10000
G1 X150
G1 Y500
G1 X-150
G1 Y400
G1 X150
G1 Y300
G1 X-150
G1 Y200
G1 X150
G1 Y100
G1 X-150
G1 Y50
G1 X300 
M155
G04 F2
M154
G0 Y951
G0 Z-50 
G04 F2
G0 G16 Z600 H0
M144
M155
G04 F10
M154
M145
RTS


N10020 
OSKS
(PROCEDURA KALIBROVKI STANKA PROVERKA NA KAGDIE SUTKI)
IF [PP4 EQ 1] GOTO NEXT2 (BEZ PROVERKI NA KAGDIE SUTKI)

PTMO=VC291
VC1=0
S100

NBK2
VC1=VC1+1
CALL OPRIN PA=0 PAA=PAA
G04 F1
PTMN=VTIME[3]
G04 F1
IF [PTMN NE 0] GOTO NEXT1
IF [VC1 GE 3] GOTO NEXT1
GOTO NBK2

NEXT1
IF[PTMO EQ 0] GOTO NEXT2
IF[PTMO EQ PTMN] GOTO NENDY

NEXT2
CALL OUAX
TG=995 M6

(PROMIVKA i PRODUVKA ETALONA DLINNI INSTRUMENTA PRI POMOSHI BLUMA T998)
CALL OPKLS PAA=PAA PETN=1

(PROMIVKA i PRODUVKA ETALONA DLINNI INSTRUMENTA PRI POMOSHI BLUMA T998)
CALL OPKLS PAA=PAA PETN=2

(PRODUVKA BLUMA PRI POMOSHI PRODUVOCHNOGO INSTRUMENTA T996)
CALL OPKW PAA=PAA

(PROVERKA BIENIJA SHPINDELJA PRI POMOSHI ETALONA DLINI INSTRUMENTA I BLUMA T998)
CALL OEBS PAA=PAA

(PROV NA POVTOR IZM INSTR PO DIAM PRI POMOSHI ETALONA DLINI INSTR I BLUMA SPOSOB - PERE-OTKR KRICHKI T998)
CALL OTSTB PAA=PAA

(KALIBROVKA BLUMA po Z i po Y s ZANESENIEM REZULTATOV KALIBROVKI PRI POMOSHI ETALONA DLINNI INSTRUMENTA T998)
CALL OKK PAA=PAA

(PROVERKA KALIBROVKI BLUMA NA PRAVILNOST POKAZANII po Z i po Y pri POMOSHI ETALONA DLINI INSTRUMENTA T998)
CALL OKKP PAA=PAA

TG=999 M6

(PROMIVKA i PRODUVKA RENISHAW PO VSEI DLINNE PRI POMOSHI BLUMA T999)
CALL OPRWB PAA=PAA

(PRODUVKA BLUMA PRI POMOSHI PRODUVOCHNOGO INSTRUMENTA T996)
CALL OPKW PAA=PAA

(ZAFIKSIROVAT ZAPOMNIT VISOTU VIDVIGENIJA BLUMA PRI POMOSHI RENISHAW T999)
CALL OKFR PAA=PAA

(PROVERIT VISOTU VIDVIGENIJA BLUMA PRI POMOSHI RENISHAW T999)
CALL OKPR PAA=PAA

(PROVERKA BIENIJA RENISHAW V SHPINDELE PRI POMOSHI BLUMA T999)
CALL OPRQ PAA=PAA

VC291=VTIME[3]
CALL OPRIN PA=315 PAA=PAA
NENDY
RTS


N10021
OHHE
(OBNULIT NULEVIE TOCHKI S No.1 po No.20)
VC260=0
VC261=0
VC262=0
VC263=0
VC264=0
VC265=0
VC266=0
VC267=0
VC268=0
VC269=0
VC270=0
VC271=0
VC272=0
VC273=0
VC274=0
VC275=0
VC276=0
VC277=0
VC278=0
VC279=0
VC280=0
VC1=1

NBK
VZOFX[VC1]=0
VZOFY[VC1]=0
VZOFZ[VC1]=0
VZOFB[VC1]=0
VZOFU[VC1]=0
VC1=VC1+1
IF [VC1 EQ 21] GOTO NEND
GOTO NBK

NEND
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0

NX2
CALL OPRIN PA=316 PAA=PAA
RTS


N10022
OAPH
(AVTO-PRIVJAZKA, POLOGENIE PRISPOSOBLENIJA NA STOLE, NOMER PALLETI)
(999-SBROS, 0, 90, 180, 270, 360-CENTR, 777-FIKSIR XYZB)
(CALL OAPH PAA=PAA PPB=? PNPP=? PX=? PY=? PZ=? PB=?)
IF [PNPP EQ 0] GOTO NENDY
IF [PNPP GT 16] GOTO NENDY
IF [PPB EQ 999] GOTO NENDZ
IF [VC292 NE PNPP] GOTO NXT74
IF [VC293 EQ 999] GOTO NXT74
IF [VC293 EQ PPB] GOTO NXT82
GOTO NXT74

NXT82
POT=1
GOTO NXT75

NXT74
CALL OHHE PAA=PAA
VC292=PNPP

NXT75
IF [PPB EQ 0] GOTO NXT76
IF [PPB EQ 90] GOTO NXT76
IF [PPB EQ 180] GOTO NXT78
IF [PPB EQ 270] GOTO NXT78
IF [PPB EQ 360] GOTO NXT80
IF [PPB EQ 777] GOTO NXT81
GOTO NENDX

NXT76
VZOFB[1]=PPB+180
GOTO NXT83

NXT78
VZOFB[1]=PPB-180
GOTO NXT83

NXT80
VZOFX[1]=0
VZOFY[1]=0
VZOFZ[1]=-249.99
VZOFB[1]=180
GOTO NXT83

NXT81
VZOFX[1]=PX
VZOFY[1]=PY
VZOFZ[1]=PZ
VZOFB[1]=PB
GOTO NXT83

NENDZ (CHEREZ PODPROGRAMMU AVTO-PRIVJAZKI ZAPRESHENO SBRASIVAT POLOGENIE NA STOLE)
CALL OPRIN PA=322 PAA=PAA PPB=PPB PNPP=PNPP PX=PX PY=PY PZ=PZ PB=PB
VOKF=1
GOTO NXT83

NENDY (NE VERNO UKAZAN NOMER PALLETI)
CALL OPRIN PA=323 PAA=PAA PPB=PPB PNPP=PNPP PX=PX PY=PY PZ=PZ PB=PB
VOKF=1
GOTO NEND

NENDX (NE VERNO UKAZANO POLOGENIE NA STOLE)
CALL OPRIN PA=324 PAA=PAA PPB=PPB PNPP=PNPP PX=PX PY=PY PZ=PZ PB=PB
VOKF=1
GOTO NEND

NXT83
IF [POT EQ 1] GOTO NXT84
VC293=PPB
CALL OPRIN PA=325 PAA=PAA PPB=PPB PNPP=PNPP PX=PX PY=PY PZ=PZ PB=PB

NXT84
G0 G16 Z600 H0
NEND
RTS


N10023
OCHP
(PROCEDURA SMENI PALLET)
M145
CALL OUAX PPP=1
TG=996 M6

(PROMIVKA PALLETi)
CALL OPRMV PAA=PAA

(OBNULENIE NULEVIH TOCHEK)
CALL OHHE PAA=PAA

(KALIBROVKA STANKA PROV NA SUTKI)
CALL OSKS PAA=PAA PP4=0

G30 P1
CALL OUAX PPP=1
CALL OPTF PTOL=0
IF[VTLGN[VTLCN] EQ 996] GOTO NEND
TG=996 M6

NEND
CALL OPRIN PA=200 PAA=PAA
VC293=999
VC289=0
VC292=0
CALL OVC PAA=PAA
M145
G04 F1
G30 P4
M60
G04 F2
RTS


N10024
OCRR
(CALIBROVKA RENISHAW PO KOLCU D50 TOLKO NA KOLLONNE)
G15 H1
CALL OPPOT PTG=999 PTS=1
VSTOH[5]=VTOFH[VC903]
VTOFH[VC903]=VSTOH[5]
CALL OFFS PX=0 PY=580 PZ=0-250 PB=0 PP=1
CALL ORB PX1=-65 PX2=65 PY=-10 PZ=75 PR=30 PP=1
VZOFB[2]=VZOFB[1]
VZOFX[1]=VZOFX[2]
VZOFY[1]=VZOFY[2]
VZOFZ[1]=VZOFZ[2]
CALL ORPA PA=5 PDI=PDI PX=0 PY=0 PZ=30 PZOZ=15 PR=10 PX1=0 PY1=0 PP=1
CALL OMCS PX=0 PY=0 PZ=0 PB=0 PP=2
G15 H2
G0 M403 B0
G0 X0 Y0
G56 HA
G0 Z20
VZOFX[53]=0
VZOFY[53]=0
VZOFZ[53]=0
VZOFB[53]=0
VZOFU[53]=0
G53
G15 H53
PLI=VTOFH[VC903] (RS LENGTH)
VZOFZ[53]=VZOFZ[53]+VZOFZ[2] (ZERO FLAT RING Z)
CALL OO18 (RS ON)
VSAPX=0 VSAPY=0 (OBNULENIE PEREMENNIH)
ALM1=#00010000H
VZOFX[53]=VRCOX-VMOFX VZOFY[53]=VRCOY-VMOFY VZOFZ[53]=VRCOZ-VMOFZ
G15 H53

NCAL
M118 RS=0
VNCOM[1]=8
M130
X=[PDI/2]+3 G31 F1000
G91 X-3
X6 F4*25.4 G31
G90
IF[VSAPX EQ 0]NALM
HTPX=VSAPX-VMOFX-VZOFX[53]
X0 F1000
VSAPX=0
M118 RS=180
X=-[PDI/2]-3 G31 F1000
G91 X3
X-6 F4*25.4 G31
G90
IF[VSAPX EQ 0]NALM
HTNX=VSAPX-VMOFX-VZOFX[53]
X=[[HTPX+HTNX]/2]F1000
M19 RS=270
Y=[PDI/2]+3 G31 F1000
G91 Y-3
Y6 F4*25.4 G31
G90
IF[VSAPY EQ 0]NALM
HTPY=VSAPY-VMOFY-VZOFY[53]
Y0 F1000
VSAPY=0
M118 RS=90
Y=-[PDI/2]-3 G31 F1000
G91 Y3
Y-6 F4*25.4 G31
G90
IF[VSAPY EQ 0]NALM
HTNY=VSAPY-VMOFY-VZOFY[53]
Y=[[HTPY+HTNY]/2]F1000
M118 RS=0
DIFX=[[HTPX+HTNX]/2]
DIFY=[[HTPY+HTNY]/2]
VZOFX[53]=VZOFX[53]+DIFX
VZOFY[53]=VZOFY[53]+DIFY
VZOFX[53]=VRCOX-VMOFX VZOFY[53]=VRCOY-VMOFY VZOFZ[53]=VRCOZ-VMOFZ
IF[ABS[DIFX] GT .003]NCAL  (X - KONTROLLE 1/2 VON .003)
IF[ABS[DIFY] GT .003]NCAL  (Y - KONTROLLE 1/2 VON .003)
CALL OO10 PMOD=7 PDI=PDI
PD1=VS30
PCX1=VS29
PCY1=VS28
VC11=PCX1
VC12=PCY1
VC15=PD1
G0 X0 Y0
CALL OO21 (RING POSITION SPEICHERN)
VSTOD[1]=0
VSTOD[2]=0
VSTOD[3]=0
VSTOD[4]=0
CALL OO10 PMOD=9 PDI=PDI
G15 H2
G56 HA
G0 Z20
G15 H53
G0 X0 Y0
CALL OO10 PMOD=7 PDI=PDI
PD2=VS30
PCX2=VS29
PCY2=VS28
VC13=PCX2
VC14=PCY2
VC16=PD2
CALL OO19
G15 H1
CALL OFFS PX=0 PY=580 PZ=0-250 PB=0 PP=1
CALL OMCS PX=0 PY=0 PZ=0 PB=90 PP=1
CALL ORPA PA=9 PX=-75 PY=-10 PZ=62 PR=-30 PD=0 PP=1
CALL OMCS PX=0 PY=0 PZ=0 PB=-90 PP=1
G15 H1
G0 M403 B0
G0 X65 Y-10
G56 HA
G90
CALL OPPOT PTG=999 PTS=1
PLI=VTOFH[VC903] (RS LENGTH)
G0 Z30
CALL OO18 (RS ON)
CALL OO10 PMOD=8 PEI=0 PLI=PLI
VTOFH[VC903]=VSTOH[5]
GOTO NFIN

NALM 
VNCOM[1]=ALM1

NFIN
CALL OO19 (RS OFF)
G30 P1
CALL OPRIN PA=326 PAA=PAA PDI=PDI
RTS


N10025
OFOS
M145
(VIVOD OSHIBKI NA FASTEMS-OSTANOVKA STANKA DLJA SNJATIJA STRUGKI S INSTRUMENTA)
CALL OPTF PTOL=0
PSTN=VC900
PSTG=VTLGN[VTLCN]
NQ1
IF [VC283 EQ 0] GOTO NQ2 (AVTOMATICHESKII REGIM - DNEM BESPOKOIT - NOCHU NE BESPOKOIT)
IF [VC283 EQ 1] GOTO NQ3 (DNEM I NOCHU NE BESPOKOIT)
IF [VC283 EQ 2] GOTO NQ4 (DNEM I NOCHU - OSTANOVKA STANKA - VIVOD OSHIBKI NA FASTEMS)
VC283=0
GOTO NQ1

NQ2
IF [VTIME[4] LT 20] GOTO NQ5
GOTO NQ3

NQ5
IF [VTIME[4] GE 7] GOTO NQ4
GOTO NQ3

NQ4
G0 G16 Z900 H0
G0 G16 Y400 H0
G0 G16 X-350 H0
IF [VC100 NE 0] NAL1
VUACM[1]='NALIPLA STRUGKA'
GOTO NAL2

NAL1
VUACM[1]='OSHIBKA BLUM'

NAL2
VDOUT[991]=VTLCN
CALL OPRIN PA=327 PAA=PAA PLQF=PLQF PSTN=PSTN PSTG=PSTG PLQS=PLQS
MSG (#PROVER' INSTRUMENT#UBERI STRUGKU #NAGMI NC-START #DOGDISb OKONCH PROGR #NAGMI RESET NA STANKE #ZBROSb OSHIB NA FASTEMS #VKL AUTO NA FASTEMS)
G4F2
VC557=VC557+1
M00
NMSG
VDOUT[998]=1

(VERNUT IZNOSI)
IF [VIRD[01138] EQ 1] GOTO NDA1
(STANDART TOOL DATA INPUT)
VTWOH[VTLCN]=VC971             (HA_W)
VTWOD[VTLCN]=VC973             (DA_W)
VIU1[VTLCN]=VC975              (HB_w)
VIU2[VTLCN]=VC977              (DB_W)

NDA1
VTWOH[VTLCN]=VC971               (D_W)
VTWOD[VTLCN]=0                   (=0)
VIU1[VTLCN]=VC975                (HB_W)
VIU2[VTLCN]=0                    (=0)
VIU3[VTLCN]=VC979                (HC_W)
(\VERNUT IZNOSI/)

NQ3
VC284=VC284+1
G30P1
CALL OBSEL
RTS


N10026
OFOU
(VIVOD OSHIBKI NA FASTEMS-OSTANOVKA STANKA DLJA PRODUVKI STRUGKI IZ OTV V ORW+DANDREA+RENISHAW)
CALL OPTF PTOL=0
PSTN=VC900
PSTG=VTLGN[VTLCN]
M145

NQ1
IF [VC283 EQ 0] GOTO NQ2 (AVTOMATICHESKII REGIM - DNEM BESPOKOIT - NOCHU NE BESPOKOIT)
IF [VC283 EQ 1] GOTO NQ3 (DNEM I NOCHU NE BESPOKOIT)
IF [VC283 EQ 2] GOTO NQ4 (DNEM I NOCHU - OSTANOVKA STANKA - VIVOD OSHIBKI NA FASTEMS)

VC283=0
GOTO NQ1

NQ2
IF [VTIME[4] LT 20] GOTO NQ5
GOTO NQ3

NQ5
IF [VTIME[4] GE 7] GOTO NQ4
GOTO NQ3

NQ4
G0 G16 Z600 H0
G0 G16 X350 Y950 H0
G0 G16 Z0 H0
G0 G91 B60
VUACM[1]='ZASTRALA STRUGKA'
VDOUT[991]=VTLCN
CALL OPRIN PA=327 PAA=PAA PSTN=PSTN PSTG=PSTG

MSG (#UBERI STRUGKU #NAGMI NC-START #DOGDISb OKONCH PROGR #NAGMI RESET NA STANKE #ZBROSb OSHIB NA FASTEMS #VKL AUTO NA FASTEMS)
M00
NMSG
G0 G91 B-60
G90
G0 G16 Z600 H0
VDOUT[998]=1

NQ3
VC284=1
RTS


N10027 
OPKLS (PROMIVKA i PRODUVKA ETALONA DLINNI INSTRUMENTA T998 PRI POMOSHI BLUM)
(CALL OPKLS PETN=1 OR 2)
(PETN-PARAMETR ETALON TOOL NUMBER; 1-ETALON TOOL FOR BLUM; 2-ETALON TOOL FOR MC2)
PSHN=VACOD
PETN=PETN
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT54
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT54
VTLD8[VTLCN]=1

NXT54
M5
M9
G0 G16 Z600 H0
M12
M154
M145
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PETN EQ 1] GOTO NPET1
IF [PETN EQ 2] GOTO NPET2
GOTO NWRNG

NPET1
IF [PSTG EQ 995] GOTO NXT7
TG=995 M6
GOTO NXT7

NPET2
IF [PSTG EQ 998] GOTO NXT7
TG=998 M6

NXT7
IF [PSTG EQ 995] GOTO NXT2
IF [PSTG EQ 998] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
IF [VSZOY[2] GE [VC288+0.5]] GOTO NXT15
IF [VSZOY[2] LE [VC288-0.5]] GOTO NXT15
GOTO NXT16

NXT15
VC288=VSZOY[2]

NXT16
VZOFX[200]=VSZOX[2]
VZOFY[200]=VC288
VZOFZ[200]=VSZOZ[2]
VZOFB[200]=0
VZOFU[200]=0
G15 H200

S100 M3
M144
M155
IF [PETN EQ 2] GOTO NMK2
G0 X0 Y0
M8
G56 HA
G0 Z0
G04 F2
M9
G04 F20
M12
S100 M3
M318
G04 F3
M317
G04 F7
M155
G04 F0.5
M144
G0 X0
G56 HA
Z20
G04 F0.5
Y5 
G04 F0.5
M9
G1 G94 Z0 F1000
G1 Z20 F1500
G0 Y0
G0 G16 Z600 H0
M145
G04 F0.5
GOTO NM154

NMK2
G0 X0 Y0
M8
G56 HA
G0 Z-100
G04 F2
M9
G04 F20
M12
S100 M3
M318
G04 F3
M317
G04 F7
M155
G04 F0.5
M144
G0 X0
G56 HA
Z20
G04 F0.5
Y5
G04 F0.5
M9
G1 G94 Z-100 F1000
G1 Z20 F1500
G0 Y0
G0 G16 Z600 H0
M145
G04 F0.5

NM154
M154
CALL OUAX PPP=1
IF [PSTG EQ 995] GOTO NXT4
IF [PSTG EQ 998] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PSHN EQ 200] GOTO NXT5
G15 H=PSHN

NXT5
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0

NX2
CALL OPRIN PA=303 PAA=PAA PETN=PETN
GOTO NFIN

NWRNG (WRONG INPUT DATA)
CALL OPRIN PA=503 PAA=PAA PETN=PETN
VOKF=1
NFIN
RTS


N10028
OPKW (PRODUVKA BLUMA PRI POMOSHI PRODUVOCHNOGO INSTRUMENTA T996)
PSHN=VACOD
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT57
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT57
VTLD8[VTLCN]=1

NXT57
M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ 996] GOTO NXT7
TG=996 M6

NXT7
IF [PSTG EQ 996] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
IF [VSZOY[2] GE [VC288+0.5]] GOTO NXT15
IF [VSZOY[2] LE [VC288-0.5]] GOTO NXT15
GOTO NXT16

NXT15
VC288=VSZOY[2]

NXT16
VZOFX[200]=VSZOX[2]
VZOFY[200]=VC288
VZOFZ[200]=VSZOZ[2]
VZOFB[200]=0
VZOFU[200]=0
G15 H200

NXT3
M155
G04 F1
M144
G0 X0 Y0
M12
M59
G56 HA
Z35
X-144.5
G04 F2
X-179.5
Y18
G04 F2
X0
G0 G16 Z600 H0
M145
M154
CALL OUAX PPP=1
IF [PSTG EQ 996] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PSHN EQ 200] GOTO NXT5
G15 H=PSHN

NXT5
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0

NX2
CALL OPRIN PA=305 PAA=PAA
RTS


N10029
OEBS (PROVERKA BIENIYA SPINDLE PRI POMOSCHI DLINI INSTRYMENTA I BLUMA)

(VC2=199.953 DLINA MASTER OPRAVKI stanok mc1)
(49.999 Dia MASTER OPRAVKI stanok mc1)
(VC2=199.947 DLINA MASTER OPRAVKI stanok mc2)
(24.998*2 Dia MASTER OPRAVKI stanok mc2)

VOK1=0
PKBQ=0.01
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT61
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT61
VTLD8[VTLCN]=1

NXT61
M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ 998] GOTO NXT7
TG=998 M6

NXT7
IF [PSTG EQ 998] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
VTOFH[VTLCN]=0
VTOFD[VTLCN]=0
VTWOH[VTLCN]=0
VTWOD[VTLCN]=0

VIU3[VTLCN]=0
VIU4[VTLCN]=0
PLT=VTOH3[VTLCN]
PDT=VTOD3[VTLCN]
PD1=PDT (maximalnii radius)
PD2=PDT (poslednii zamerennii zub)
VTOFH[VTLCN]=PLT (DLINA MASTER OPRAVKI)
VTOFD[VTLCN]=PDT (RAD MASTER OPRAVKI)
M12
M155
G04 F1
M144

(ZAMER BIENIJA No: 1 )
M19 RS=0
VSTOH[41]=0
NESH1
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK1
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV1
CALL OPRIN PA=309 PAA=PAA
NBLK1
M63
G04 F1
M6
G04 F1
NPROV1
IF[VSTOH[41] EQ 3] NVFK1
IF [VC100 NE 0] GOTO NESH1
GOTO ND421

NVFK1
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=309 PAA=PAA
M63
G04 F1
M6
G04 F1

ND421
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PD3=PD2 (nachalnii minimalnii radius)
PBK1=PD2
IF [PD2 LE PD1] GOTO NXB1
PD1=PD2 (maximalnii radius)
NXB1
IF [PD2 GE PD3] GOTO NXB2
PD3=PD2 (minimalnii radius)
NXB2

(ZAMER BIENIJA No: 2 )
M19 RS=45
VSTOH[41]=0
NESH2
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK2
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV2
CALL OPRIN PA=309 PAA=PAA
NBLK2
M63
G04 F1
M6
G04 F1
NPROV2
IF [VSTOH[41] EQ 3] NVFK2
IF [VC100 NE 0] GOTO NESH2
GOTO ND422

NVFK2
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=309 PAA=PAA
M63
G04 F1
M6
G04 F1

ND422
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK2=PD2
IF [PD2 LE PD1] GOTO NXB5
PD1=PD2 (maximalnii radius)
NXB5
IF [PD2 GE PD3] GOTO NXB6
PD3=PD2 (minimalnii radius)
NXB6

(ZAMER BIENIJA No: 3 )
M19 RS=90
VSTOH[41]=0
NESH3
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK3
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV3
CALL OPRIN PA=309 PAA=PAA
NBLK3
M63
G04 F1
M6
G04 F1
NPROV3
IF[VSTOH[41] EQ 3] NVFK3
IF [VC100 NE 0] GOTO NESH3
GOTO ND423

NVFK3
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=309 PAA=PAA
M63
G04 F1
M6
G04 F1

ND423
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK3=PD2
IF [PD2 LE PD1] GOTO NXB7
PD1=PD2 (maximalnii radius)
NXB7
IF [PD2 GE PD3] GOTO NXB8
PD3=PD2 (minimalnii radius)
NXB8

(ZAMER BIENIJA No: 4 )
M19 RS=135
VSTOH[41]=0
NESH4
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK4
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV4
CALL OPRIN PA=309 PAA=PAA
NBLK4
M63
G04 F1
M6
G04 F1
NPROV4
IF[VSTOH[41] EQ 3] NVFK4
IF [VC100 NE 0] GOTO NESH4
GOTO ND424

NVFK4
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=309 PAA=PAA
M63
G04 F1
M6
G04 F1

ND424
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK4=PD2
IF [PD2 LE PD1] GOTO NXB9
PD1=PD2 (maximalnii radius)
NXB9
IF [PD2 GE PD3] GOTO NXB10
PD3=PD2 (minimalnii radius)
NXB10

(ZAMER BIENIJA No: 5 )
M19 RS=180
VSTOH[41]=0
NESH5
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK5
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV5
CALL OPRIN PA=309 PAA=PAA
NBLK5
M63
G04 F1
M6
G04 F1
NPROV5
IF[VSTOH[41] EQ 3] NVFK5
IF [VC100 NE 0] GOTO NESH5
GOTO ND425

NVFK5
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=309 PAA=PAA
M63
G04 F1
M6
G04 F1

ND425
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK5=PD2
IF [PD2 LE PD1] GOTO NXB11
PD1=PD2 (maximalnii radius)
NXB11
IF [PD2 GE PD3] GOTO NXB12
PD3=PD2 (minimalnii radius)
NXB12

(ZAMER BIENIJA No: 6 )
M19 RS=225
VSTOH[41]=0
NESH6
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK6
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV6
CALL OPRIN PA=309 PAA=PAA
NBLK6
M63
G04 F1
M6
G04 F1
NPROV6
IF[VSTOH[41] EQ 3] NVFK6
IF [VC100 NE 0] GOTO NESH6
GOTO ND426

NVFK6
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=309 PAA=PAA
M63
G04 F1
M6
G04 F1

ND426
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK6=PD2
IF [PD2 LE PD1] GOTO NXB13
PD1=PD2 (maximalnii radius)
NXB13
IF [PD2 GE PD3] GOTO NXB14
PD3=PD2 (minimalnii radius)
NXB14

(ZAMER BIENIJA No: 7 )
M19 RS=270
VSTOH[41]=0
NESH7
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK7
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV7
CALL OPRIN PA=309 PAA=PAA
NBLK7
M63
G04 F1
M6
G04 F1
NPROV7
IF[VSTOH[41] EQ 3] NVFK7
IF [VC100 NE 0] GOTO NESH7
GOTO ND427

NVFK7
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=309 PAA=PAA
M63
G04 F1
M6
G04 F1

ND427
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK7=PD2
IF [PD2 LE PD1] GOTO NXB15
PD1=PD2 (maximalnii radius)
NXB15
IF [PD2 GE PD3] GOTO NXB16
PD3=PD2 (minimalnii radius)
NXB16

(ZAMER BIENIJA No: 8 )
M19 RS=315
VSTOH[41]=0
NESH8
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK8
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV8
CALL OPRIN PA=309 PAA=PAA
NBLK8
M63
G04 F1
M6
G04 F1
NPROV8
IF[VSTOH[41] EQ 3] NVFK8
IF [VC100 NE 0] GOTO NESH8
GOTO ND428

NVFK8
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=309 PAA=PAA
M63
G04 F1
M6
G04 F1

ND428
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK8=PD2
IF [PD2 LE PD1] GOTO NXB17
PD1=PD2 (maximalnii radius)
NXB17
IF [PD2 GE PD3] GOTO NXB18
PD3=PD2 (minimalnii radius)

NXB18
M145
G04 F0.5
M154
PBD1=PBK5-PBK1 (180-0 Y)
PBD2=PBK6-PBK2 (225-45)
PBD3=PBK3-PBK7 (90-270 X)
PBD4=PBK4-PBK8 (135-315)
VC11=PBD1
VC12=PBD2
VC13=PBD3
VC14=PBD4
IF [PBD1 GE PKBQ] GOTO NXT3
IF [PBD2 GE PKBQ] GOTO NXT3
IF [PBD3 GE PKBQ] GOTO NXT3
IF [PBD4 GE PKBQ] GOTO NXT3
GOTO NXT8

NXT3
VOK1=1

NXT8
CALL OUAX PPP=1
IF [PSTG EQ 998] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0
NX2
CALL OPRIN PA=309 PAA=PAA PBK1=PBK1 PBK2=PBK2 PBK3=PBK3 PBK4=PBK4 PBK5=PBK5 PBK6=PBK6 PBK7=PBK7 PBK8=PBK8 PD1=PD1 PD3=PD3 PKBQ=PKBQ
RTS


N10030
OTSTB
(PROVERKA NA POVTORJAEMOST IZM INSTR PO DIAM PRI POMOSHI ETALONA DLINI INSTRUMENTA I BLUMA)
(SPOSOB - MEDLENNAYA PODACHA)

(VC2=199.953 DLINA MASTER OPRAVKI stanok mc1)
(49.999 Dia MASTER OPRAVKI stanok mc1)
(VC2=199.947 DLINA MASTER OPRAVKI stanok mc2)
(24.998*2 Dia MASTER OPRAVKI stanok mc2)

VOK1=0
PKBQ=0.01
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT68
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT68
VTLD8[VTLCN]=1

NXT68
M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ 998] GOTO NXT7
TG=998 M6

NXT7
IF [PSTG EQ 998] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
VTOFH[VTLCN]=0
VTOFD[VTLCN]=0
VTWOH[VTLCN]=0
VTWOD[VTLCN]=0

VIU3[VTLCN]=0
VIU4[VTLCN]=0
PLT=VTOH3[VTLCN]
PDT=VTOD3[VTLCN]
PD1=PDT (maximalnii radius)
PD2=PDT (poslednii zamerennii zub)
VTOFH[VTLCN]=PLT (DLINA MASTER OPRAVKI)
VTOFD[VTLCN]=PDT (RAD MASTER OPRAVKI)
M12
M155
G04 F1
M144

(ZAMER BIENIJA No: 1 )
S3750 M3
VSTOH[41]=0
NESH1
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK1
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV1
CALL OPRIN PA=318 PAA=PAA
NBLK1
M63
G04 F1
M6
G04 F1
NPROV1
IF[VSTOH[41] EQ 3] NVFK1
IF [VC100 NE 0] GOTO NESH1
GOTO ND431

NVFK1
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=318 PAA=PAA
M63
G04 F1
M6
G04 F1

ND431
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PD3=PD2 (nachalnii minimalnii radius)
PBK1=PD2
(IF [PD2 LE PD1] GOTO NXB1)
PD1=PD2 (maximalnii radius)
NXB1
(IF [PD2 GE PD3] GOTO NXB2)
PD3=PD2 (minimalnii radius)
NXB2
M145

(ZAMER BIENIJA No: 2 )
M144
S3750 M3
VSTOH[41]=0
NESH2
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK2
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV2
CALL OPRIN PA=318 PAA=PAA
NBLK2
M63
G04 F1
M6
G04 F1
NPROV2
IF[VSTOH[41] EQ 3] NVFK2
IF [VC100 NE 0] GOTO NESH2
GOTO ND432

NVFK2
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=318 PAA=PAA
M63
G04 F1
M6
G04 F1

ND432
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK2=PD2
IF [PD2 LE PD1] GOTO NXB5
PD1=PD2 (maximalnii radius)
NXB5
IF [PD2 GE PD3] GOTO NXB6
PD3=PD2 (minimalnii radius)
NXB6
M145

(ZAMER BIENIJA No: 3 )
M144
S3750 M3
VSTOH[41]=0
NESH3
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK3
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV3
CALL OPRIN PA=318 PAA=PAA
NBLK3
M63
G04 F1
M6
G04 F1
NPROV3
IF[VSTOH[41] EQ 3] NVFK3
IF [VC100 NE 0] GOTO NESH3
GOTO ND433

NVFK3
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=318 PAA=PAA
M63
G04 F1
M6
G04 F1

ND433
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK3=PD2
IF [PD2 LE PD1] GOTO NXB7
PD1=PD2 (maximalnii radius)
NXB7
IF [PD2 GE PD3] GOTO NXB8
PD3=PD2 (minimalnii radius)
NXB8
M145

(ZAMER BIENIJA No: 4 )
M144
S3750 M3
VSTOH[41]=0
NESH4
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK4
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV4
CALL OPRIN PA=318 PAA=PAA
NBLK4
M63
G04 F1
M6
G04 F1
NPROV4
IF[VSTOH[41] EQ 3] NVFK4
IF [VC100 NE 0] GOTO NESH4
GOTO ND434

NVFK4
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=318 PAA=PAA
M63
G04 F1
M6
G04 F1

ND434
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK4=PD2
IF [PD2 LE PD1] GOTO NXB9
PD1=PD2 (maximalnii radius)
NXB9
IF [PD2 GE PD3] GOTO NXB10
PD3=PD2 (minimalnii radius)
NXB10
M145

(ZAMER BIENIJA No: 5 )
M144
S3750 M3
VSTOH[41]=0
NESH5
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK5
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV5
CALL OPRIN PA=318 PAA=PAA
NBLK5
M63
G04 F1
M6
G04 F1
NPROV5
IF[VSTOH[41] EQ 3] NVFK5
IF [VC100 NE 0] GOTO NESH5
GOTO ND435

NVFK5
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=318 PAA=PAA
M63
G04 F1
M6
G04 F1

ND435
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK5=PD2
IF [PD2 LE PD1] GOTO NXB11
PD1=PD2 (maximalnii radius)
NXB11
IF [PD2 GE PD3] GOTO NXB12
PD3=PD2 (minimalnii radius)
NXB12
M145

(ZAMER BIENIJA No: 6 )
M144
S3750 M3
VSTOH[41]=0
NESH6
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK6
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV6
CALL OPRIN PA=318 PAA=PAA
NBLK6
M63
G04 F1
M6
G04 F1
NPROV6
IF[VSTOH[41] EQ 3] NVFK6
IF [VC100 NE 0] GOTO NESH6
GOTO ND436

NVFK6
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=318 PAA=PAA
M63
G04 F1
M6
G04 F1

ND436
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK6=PD2
IF [PD2 LE PD1] GOTO NXB13
PD1=PD2 (maximalnii radius)
NXB13
IF [PD2 GE PD3] GOTO NXB14
PD3=PD2 (minimalnii radius)
NXB14
M145


(ZAMER BIENIJA No: 7 )
M144
S3750 M3
VSTOH[41]=0
NESH7
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK7
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV7
CALL OPRIN PA=318 PAA=PAA
NBLK7
M63
G04 F1
M6
G04 F1
NPROV7
IF[VSTOH[41] EQ 3] NVFK7
IF [VC100 NE 0] GOTO NESH7
GOTO ND437

NVFK7
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=318 PAA=PAA
M63
G04 F1
M6
G04 F1

ND437
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK7=PD2
IF [PD2 LE PD1] GOTO NXB15
PD1=PD2 (maximalnii radius)
NXB15
IF [PD2 GE PD3] GOTO NXB16
PD3=PD2 (minimalnii radius)
NXB16
M145

(ZAMER BIENIJA No: 8 )
M144
S3750 M3
VSTOH[41]=0
NESH8
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK8
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV8
CALL OPRIN PA=318 PAA=PAA
NBLK8
M63
G04 F1
M6
G04 F1
NPROV8
IF[VSTOH[41] EQ 3] NVFK8
IF [VC100 NE 0] GOTO NESH8
GOTO ND438

NVFK8
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=318 PAA=PAA
M63
G04 F1
M6
G04 F1

ND438
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK8=PD2
IF [PD2 LE PD1] GOTO NXB17
PD1=PD2 (maximalnii radius)
NXB17
IF [PD2 GE PD3] GOTO NXB18
PD3=PD2 (minimalnii radius)
NXB18
M145
G04 F0.5
M154
PBD1=PD1-PD3
IF [PBD1 GE PKBQ] GOTO NXT3
GOTO NXT8

NXT3
VOK1=1

NXT8
CALL OUAX PPP=1
IF [PSTG EQ 998] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0
NX2
CALL OPRIN PA=318 PAA=PAA PBK1=PBK1 PBK2=PBK2 PBK3=PBK3 PBK4=PBK4 PBK5=PBK5 PBK6=PBK6 PBK7=PBK7 PBK8=PBK8 PBD1=PBD1 PD1=PD1 PD3=PD3 PDT=PDT PKBQ=PKBQ
RTS


N10031
OKK
(KALIBROVKA BLUM po Z i po Y S ZANESENIEM REZULTATOV KALIBROVKI PRI POMOSHI ETALONA DLINNI INSTRUMENTA)

(VC2=199.953 DLINA MASTER OPRAVKI stanok mc1)
(49.999 Dia MASTER OPRAVKI stanok mc1)
(VC2=104.897 DLINA MASTER OPRAVKI stanok mc2)
(    6.000   Dia MASTER OPRAVKI stanok mc2)

CALL OPTF PTOL=0 (SAVE TOOL TF)
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT63
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT63
VTLD8[VTLCN]=1

NXT63
M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ 995] GOTO NXT7
TG=995 M6

NXT7
IF [PSTG EQ 995] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
VTOFH[VTLCN]=0
VTOFD[VTLCN]=0
VTWOH[VTLCN]=0
VTWOD[VTLCN]=0
VIU1[VTLCN]=0
VIU2[VTLCN]=0
VIU3[VTLCN]=0
VIU4[VTLCN]=0
PLT=VTOH3[VTLCN] (DLINA MASTER OPRAVKI 3 KORRECTOR)
PDT=VTOD3[VTLCN] (RAD MASTER OPRAVKI 3 KORRECTOR)
VTOFH[VTLCN]=PLT
VTOFD[VTLCN]=PDT

(KALIBROVKA BLUM)
(PH=1 TOOL LENGTH MEMORY OFFSET)
(PA=3 NUMBER OF MEASUREMENTS)
(PR=0.01 MAX. VARIATION OF MEAS. RESULTS)
(PZ=0 LENGTH OFFSET FOR RADIUS MEASUREMENT)
(PX=0 RADIUS OFFSET FOR LENGTH MEASUREMENT)
S3750 M3
CALL O9601 PH=VTLCN PD=VTLCN PA=1. PR=0.01 PZ=2 PX=1

CALL OUAX PPP=1
IF [PSTG EQ 995] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0

NX2
CALL OPRIN PA=311 PAA=PAA
RTS


N10032
OKKP (PROVERKA KALIBROVKI BLUMA NA PRAVIL'NOST' POKAZANII PO Z & PO Y)

(VC2=199.953 DLINA MASTER OPRAVKI stanok mc1)
(49.999 Dia MASTER OPRAVKI stanok mc1)
(VC2=199.947 DLINA MASTER OPRAVKI stanok mc2)
(24.998*2 Dia MASTER OPRAVKI stanok mc2)

VOK1=0
PKKQ=0.01
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT62
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT62
VTLD8[VTLCN]=1

NXT62
M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ 998] GOTO NXT7
TG=998 M6

NXT7
IF [PSTG EQ 998] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
VTOFH[VTLCN]=0
VTOFD[VTLCN]=0
VTWOH[VTLCN]=0
VTWOD[VTLCN]=0

VIU3[VTLCN]=0
VIU4[VTLCN]=0
PLT=VTOH3[VTLCN] (DLINA MASTER OPRAVKI)
PDT=VTOD3[VTLCN] (RAD MASTER OPRAVKI)
VTOFH[VTLCN]=VTOH3[VTLCN]
VTOFD[VTLCN]=VTOD3[VTLCN]
M12
M155
G04 F1
M144
(KONTROLNII ZAMER DLINI KALIBRA)
S3750 M3
VSTOH[41]=0

NESH
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=0 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NXBLK
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV
CALL OPRIN PA=310 PAA=PAA

NXBLK
M63
G04 F1
M6
G04 F1

NPROV
IF[VSTOH[41] EQ 3] NVFK
IF [VC100 NE 0] GOTO NESH
GOTO NDAL44

NVFK
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=310 PAA=PAA
M63
G04 F1
M6
G04 F1

NDAL44
VTLD3[VTLCN]=0
VTLD4[VTLCN]=0
M5
PKLK=ABS[VTOH3[VTLCN]-VTOFH[VTLCN]]
PKDK=ABS[VTOD3[VTLCN]-VTOFD[VTLCN]]
M145
G04 F0.5
M154
IF [PKLK GE PKKQ] GOTO NXT3
IF [PKDK GE PKKQ] GOTO NXT3
GOTO NXT5

NXT3
VOK1=1

NXT5
CALL OUAX PPP=1
IF [PSTG EQ 998] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0
NX2
CALL OPRIN PA=310 PAA=PAA PKDK=PKDK PKLK=PKLK PKKQ=PKKQ
RTS


N10033
OPRWB (PROMIVKA i PRODUVKA RENISHAW T999 PO VSEI DLINNE PRI POMOSHI BLUMA)
M145
PSHN=VACOD
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT71
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT71
VTLD8[VTLCN]=1

NXT71
M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ 999] GOTO NXT7
TG=999 M6

NXT7
IF [PSTG EQ 999] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
IF [VSZOY[2] GE [VC288+0.5]] GOTO NXT15
IF [VSZOY[2] LE [VC288-0.5]] GOTO NXT15
GOTO NXT16

NXT15
VC288=VSZOY[2]

NXT16
VZOFX[200]=VSZOX[2]
VZOFY[200]=VC288
VZOFZ[200]=VSZOZ[2]
VZOFB[200]=0
VZOFU[200]=0
G15 H200
G0 X0 Y0
S100 M3
M155
M8
G04 F2
M9
G04 F2
M12
G04 F2
M144
G56 HA
G0 Z-5
G1 Z-195 F1000
G1 Y18
G1 Z-5
G0 Z35
G0 Y0
G0 G16 Z600 H0
M145
G04 F1
M154
CALL OUAX PPP=1
IF [PSTG EQ 999] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PSHN EQ 200] GOTO NXT5
G15 H=PSHN

NXT5
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0
NX2
CALL OPRIN PA=321 PAA=PAA
RTS


N10034
OKFR (ZAFIKSIROVAT, ZAPOMNIT VISOTU VIDVIGENIJA BLUMA PRI POMOSHI RENISHAW T999)
PSHN=VACOD
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT50
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT50
VTLD8[VTLCN]=1

NXT50
CALL OPRW

M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ 999] GOTO NXT7
TG=999 M6

NXT7
IF [PSTG EQ 999] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
IF [VSZOY[4] GE [VC288+0.5]] GOTO NXT15
IF [VSZOY[4] LE [VC288-0.5]] GOTO NXT15
GOTO NXT16

NXT15
VC288=VSZOY[4]

NXT16
VZOFX[200]=VSZOX[2]
VZOFY[200]=VC288
VZOFZ[200]=VSZOZ[2]
VZOFB[200]=0
VZOFU[200]=0
G15 H200

NXT3
M12
M155
G04 F1
M144
G0 X-179.5 Y15.5
G56 HA
G0 Z25
G04 F1
G0 Z5 Y10.5
M9
M154
CALL OO18
CALL OO10 PMOD=2 PEI=2 PUDT=15 POVT=2.5
CALL OO20 PHN=200 PY=0
CALL OO19
G0 G16 Z600 H0
VC288=VZOFY[200]
VSZOY[4]=VC288
M145
CALL OUAX PPP=1
IF [PSTG EQ 999] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PSHN EQ 200] GOTO NXT5
G15 H=PSHN

NXT5
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0

NX2
CALL OPRIN PA=301 PAA=PAA
RTS


N10035
OKPR (PROVERIT VISOTU VIDVIGENIJA BLUMA PRI POMOSHI RENISHAW T999)
VOK1=0
PRQK=0.01
PSHN=VACOD
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT53
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT53
VTLD8[VTLCN]=1

NXT53
CALL OPRW
M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ 999] GOTO NXT7
TG=999 M6

NXT7
IF [PSTG EQ 999] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
IF [VSZOY[4] GE [VC288+0.5]] GOTO NXT15
IF [VSZOY[4] LE [VC288-0.5]] GOTO NXT15
GOTO NXT16

NXT15
VC288=VSZOY[4]

NXT16
VZOFX[200]=VSZOX[2]
VZOFY[200]=VC288
VZOFZ[200]=VSZOZ[2]
VZOFB[200]=0
VZOFU[200]=0
G15 H200

NXT3
M12
M155
G04 F1
M144
G0 X-179.5 Y15 
G56 HA
G0 Z25
G04 F1
Z5 Y10.5
M9
M154
CALL OO18
CALL OO10 PMOD=2 PEI=2 PUDT=20 POVT=2.5
PVKP=VS28
CALL OO20 PHN=200 PY=0
VC288=VZOFY[200]
CALL OO19
G0 G16 Z600 H0
M145
IF [ABS[PVKP] GE PRQK] GOTO NXT5
GOTO NXT9

NXT5
VOK1=1

NXT9
CALL OUAX PPP=1
IF [PSTG EQ 999] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PSHN EQ 200] GOTO NXT8
G15 H=PSHN

NXT8
IF [PAA EQ 11] GOTO NX3
IF [PAA EQ 12] GOTO NX3
GOTO NX4

NX3
PAA=0

NX4
CALL OPRIN PA=302 PAA=PAA PVKP=PVKP PRQK=PRQK
RTS


N10036
OPRQ (PROVERKA BIENIJA RENISHAW T999 V SHPINDELE PRI POMOSHI BLUMA)
VOK1=0
PRRQ=0.01
PSHN=VACOD
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT58
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT58
VTLD8[VTLCN]=1

NXT58
CALL OPRW
M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ 999] GOTO NXT7
TG=999 M6

NXT7
M12
IF [PSTG EQ 999] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
IF [VSZOY[2] GE [VC288+0.5]] GOTO NXT15
IF [VSZOY[2] LE [VC288-0.5]] GOTO NXT15
GOTO NXT16

NXT15
VC288=VSZOY[2]

NXT16
VZOFX[200]=VSZOX[2]
VZOFY[200]=VC288
VZOFZ[200]=VSZOZ[2]
VZOFB[200]=0
VZOFU[200]=0
G15 H200

NXT3
S100 M3
M12
M155
G04 F1
M144
G0 X-179.5 Y33.5 
G56 HA
Z25 
G04 F1
M5
M154
M9
Z5
CALL OO18
VSAPY=0
M19 RS=0
VNCOM[1]=8
M130
Y25 F500
Y20 F4*25.4 G31
PRF1=VSAPY-VMOFY-VZOFY[200]
VSAPY=0
Y25 F500
M19 RS=90
Y20 F4*25.4 G31
PRF2=VSAPY-VMOFY-VZOFY[200]
VSAPY=0
Y25 F500
M19 RS=180
Y20 F4*25.4 G31
PRF3=VSAPY-VMOFY-VZOFY[200]
VSAPY=0
Y25 F500
M19 RS=270
Y20 F4*25.4 G31
PRF4=VSAPY-VMOFY-VZOFY[200]
VSAPY=0
Y25 F500
CALL OO19
G0 G16 Z600 H0
PRT1=VSTOD[4]       (-Y   0-GRAD)
PRT2=ABS[VSTOD[1]]  (+X  90-GRAD IZN OTR ZN)
PRT3=ABS[VSTOD[3]]  (+Y 180-GRAD IZN OTR ZN)
PRT4=VSTOD[2]       (-X 270-GRAD)
PRQ1=PRT1-PRF1      (-Y)
PRQ2=PRT2-PRF2      (+X)
PRQ3=PRT3-PRF3      (+Y)
PRQ4=PRT4-PRF4      (-X)
PRCY=[[PRQ3+1]-[PRQ1+1]]
PRCX=[[PRQ2+1]-[PRQ4+1]]
M145
IF [ABS[PRCY] GE PRRQ] GOTO NXT8
IF [ABS[PRCX] GE PRRQ] GOTO NXT8
GOTO NXT9

NXT8
VOK1=1

NXT9
CALL OUAX PPP=1
IF [PSTG EQ 999] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PSHN EQ 200] GOTO NXT5
G15 H=PSHN

NXT5
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0
NX2
CALL OPRIN PA=306 PAA=PAA PRF1=PRF1 PRF2=PRF2 PRF3=PRF3 PRF4=PRF4 PRQ1=PRQ1 PRQ2=PRQ2 PRQ3=PRQ3 PRQ4=PRQ4 PRCX=PRCX PRCY=PRCY PRRQ=PRRQ
RTS


N10037
OTTT 
(PERE-VIZOV INSTRUMENTA DLJA POPITKI PRODUVKI KONUSA INSTRUMENTA)
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT65
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT65
VTLD8[VTLCN]=1

NXT65
IF [PSTN EQ 0] GOTO NXT10
IF [PSTG EQ 996] GOTO NXT11
PTT1=PSTG
PTT2=996
GOTO NXT3

NXT10
PTT1=997
PTT2=996
GOTO NXT3

NXT11
PTT1=PSTG
PTT2=997
GOTO NXT3

NXT3
M5
M9
G0 G16 Z600 H0
M12
S100 M3
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
TG=PTT2 M6
M12
S100 M3
TG=PTT1
G04 F3
CALL OUAX PPP=1
M6
S100 M3
M12
G04 F1
CALL OUAX PPP=1
IF [PSTN EQ 0] GOTO NXT6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0

NX2
CALL OPRIN PA=314 PAA=PAA
RTS (PROVERIT)


N10038
OPWW
(PRODUVKA KRISHKI BLUMA PRI POMOSHI PRODUVOCHNOGO INSTRUMENTA T996)
(PERE-OTKRITIE KRISHKI BLUMA)
PSHN=VACOD
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT60
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT60
VTLD8[VTLCN]=1

NXT60
M5
M9
G0 G16 Z600 H0
M12
M155
M145
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ 996] GOTO NXT7
TG=996 M6

NXT7
IF [PSTG EQ 996] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
IF [VSZOY[2] GE [VC288+0.5]] GOTO NXT15
IF [VSZOY[2] LE [VC288-0.5]] GOTO NXT15
GOTO NXT16

NXT15
VC288=VSZOY[2]

NXT16
VZOFX[200]=VSZOX[2]
VZOFY[200]=VC288
VZOFZ[200]=VSZOZ[2]
VZOFB[200]=0
VZOFU[200]=0
G15 H200

NXT3
S100 M3
M12
M59
M155
G0 X0 Y0
G56 HA
Z35
M144
G0 X25.5
M144
G0 X-149.5
M144
G0 X0
M144
G0 Z70
G0 Y5
G04 F1
G0 G16 Z600 H0
M145
G04 F1
M154
CALL OUAX PPP=1
IF [PSTG EQ 996] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PSHN EQ 200] GOTO NXT5
G15 H=PSHN

NXT5
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0

NX2
CALL OPRIN PA=308 PAA=PAA
RTS


N10039
OTSTA 
(PROVERKA NA POVTORJAEMOST IZM INSTR PO DIAM PRI POMOSHI ETALONA DLINI INSTRUMENTA I BLUMA)
(SPOSOB - BISTRAYA PODACHA)

(VC2=199.953 DLINA MASTER OPRAVKI stanok mc1)
(49.999 Dia MASTER OPRAVKI stanok mc1)
(VC2=199.947 DLINA MASTER OPRAVKI stanok mc2)
(24.998*2 Dia MASTER OPRAVKI stanok mc2)

VOK1=0
PKBQ=0.01
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT67
PSTG=VTLGN[VTLCN] (SAVE TOOL GROUP)
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT67
VTLD8[VTLCN]=1

NXT67
M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ 998] GOTO NXT7
TG=998 M6

NXT7
IF [PSTG EQ 998] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
VTOFH[VTLCN]=0
VTOFD[VTLCN]=0
VTWOH[VTLCN]=0
VTWOD[VTLCN]=0

VIU3[VTLCN]=0
VIU4[VTLCN]=0
PLT=VTOH3[VTLCN]
PDT=VTOD3[VTLCN]
PD1=PDT (maximalnii radius)
PD2=PDT (poslednii zamerennii zub)
VTOFH[VTLCN]=PLT (DLINA MASTER OPRAVKI)
VTOFD[VTLCN]=PDT (RAD MASTER OPRAVKI)
M12
M155
G04 F1
M144

(ZAMER BIENIJA No: 1 )
S3750 M3
VSTOH[41]=0
NESH1
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK1
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV1
CALL OPRIN PA=317 PAA=PAA

NBLK1
M63
G04 F1
M6
G04 F1

NPROV1
IF[VSTOH[41] EQ 3] NVFK1
IF [VC100 NE 0] GOTO NESH1
GOTO ND511

NVFK1
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=317 PAA=PAA
M63
G04 F1
M6
G04 F1

ND511
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PD3=PD2 (nachalnii minimalnii radius)
PBK1=PD2
IF [PD2 LE PD1] GOTO NXB1
PD1=PD2 (maximalnii radius)

NXB1
IF [PD2 GE PD3] GOTO NXB2
PD3=PD2 (minimalnii radius)

NXB2
(ZAMER BIENIJA No: 2 )
S3750 M3
VSTOH[41]=0
NESH2
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK2
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV2
CALL OPRIN PA=317 PAA=PAA
NBLK2
M63
G04 F1
M6
G04 F1
NPROV2
IF[VSTOH[41] EQ 3] NVFK2
IF [VC100 NE 0] GOTO NESH2
GOTO ND512

NVFK2
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=317 PAA=PAA
M63
G04 F1
M6
G04 F1

ND512
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK2=PD2
IF [PD2 LE PD1] GOTO NXB5
PD1=PD2 (maximalnii radius)
NXB5
IF [PD2 GE PD3] GOTO NXB6
PD3=PD2 (minimalnii radius)
NXB6

(ZAMER BIENIJA No: 3 )
S3750 M3
VSTOH[41]=0
NESH3
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK3
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV3
CALL OPRIN PA=317 PAA=PAA
NBLK3
M63
G04 F1
M6
G04 F1
NPROV3
IF[VSTOH[41] EQ 3] NVFK3
IF [VC100 NE 0] GOTO NESH3
GOTO ND513

NVFK3
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=317 PAA=PAA
M63
G04 F1
M6
G04 F1

ND513
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK3=PD2
IF [PD2 LE PD1] GOTO NXB7
PD1=PD2 (maximalnii radius)
NXB7
IF [PD2 GE PD3] GOTO NXB8
PD3=PD2 (minimalnii radius)
NXB8

(ZAMER BIENIJA No: 4 )
S3750 M3
VSTOH[41]=0
NESH4
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK4
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV4
CALL OPRIN PA=317 PAA=PAA
NBLK4
M63
G04 F1
M6
G04 F1
NPROV4
IF[VSTOH[41] EQ 3] NVFK4
IF [VC100 NE 0] GOTO NESH4
GOTO ND514

NVFK4
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=317 PAA=PAA
M63
G04 F1
M6
G04 F1

ND514
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK4=PD2
IF [PD2 LE PD1] GOTO NXB9
PD1=PD2 (maximalnii radius)
NXB9
IF [PD2 GE PD3] GOTO NXB10
PD3=PD2 (minimalnii radius)
NXB10

(ZAMER BIENIJA No: 5 )
S3750 M3
VSTOH[41]=0
NESH5
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK5
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV5
CALL OPRIN PA=317 PAA=PAA
NBLK5
M63
G04 F1
M6
G04 F1
NPROV5
IF[VSTOH[41] EQ 3] NVFK5
IF [VC100 NE 0] GOTO NESH5
GOTO ND515

NVFK5
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=317 PAA=PAA
M63
G04 F1
M6
G04 F1

ND515
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK5=PD2
IF [PD2 LE PD1] GOTO NXB11
PD1=PD2 (maximalnii radius)
NXB11
IF [PD2 GE PD3] GOTO NXB12
PD3=PD2 (minimalnii radius)
NXB12

(ZAMER BIENIJA No: 6 )
S3750 M3
VSTOH[41]=0
NESH6
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK6
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV6
CALL OPRIN PA=317 PAA=PAA
NBLK6
M63
G04 F1
M6
G04 F1
NPROV6
IF[VSTOH[41] EQ 3] NVFK6
IF [VC100 NE 0] GOTO NESH6
GOTO ND516

NVFK6
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=317 PAA=PAA
M63
G04 F1
M6
G04 F1

ND516
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK6=PD2
IF [PD2 LE PD1] GOTO NXB13
PD1=PD2 (maximalnii radius)
NXB13
IF [PD2 GE PD3] GOTO NXB14
PD3=PD2 (minimalnii radius)
NXB14

(ZAMER BIENIJA No: 7 )
S3750 M3
VSTOH[41]=0
NESH7
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK7
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV7
CALL OPRIN PA=317 PAA=PAA
NBLK7
M63
G04 F1
M6
G04 F1
NPROV7
IF[VSTOH[41] EQ 3] NVFK7
IF [VC100 NE 0] GOTO NESH7
GOTO ND517

NVFK7
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=317 PAA=PAA
M63
G04 F1
M6
G04 F1

ND517
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK7=PD2
IF [PD2 LE PD1] GOTO NXB15
PD1=PD2 (maximalnii radius)
NXB15
IF [PD2 GE PD3] GOTO NXB16
PD3=PD2 (minimalnii radius)
NXB16

(ZAMER BIENIJA No: 8 )
S3750 M3
VSTOH[41]=0
NESH8
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK8
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV8
CALL OPRIN PA=317 PAA=PAA
NBLK8
M63
G04 F1
M6
G04 F1
NPROV8
IF[VSTOH[41] EQ 3] NVFK8
IF [VC100 NE 0] GOTO NESH8
GOTO ND518

NVFK8
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=317 PAA=PAA
M63
G04 F1
M6
G04 F1

ND518
M5
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK8=PD2
IF [PD2 LE PD1] GOTO NXB17
PD1=PD2 (maximalnii radius)
NXB17
IF [PD2 GE PD3] GOTO NXB18
PD3=PD2 (minimalnii radius)
NXB18
M145
G04 F0.5
M154
PBD1=PD1-PD3
IF [PBD1 GE PKBQ] GOTO NXT3
GOTO NXT8

NXT3
VOK1=1

NXT8
CALL OUAX PPP=1
IF [PSTG EQ 998] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0

NX2
CALL OPRIN PA=317 PAA=PAA PBK1=PBK1 PBK2=PBK2 PBK3=PBK3 PBK4=PBK4 PBK5=PBK5 PBK6=PBK6 PBK7=PBK7 PBK8=PBK8 PBD1=PBD1 PD1=PD1 PD3=PD3 PDT=PDT PKBQ=PKBQ
RTS


N10040
OTSTC 
(PROVERKA NA POVTORJAEMOST IZM INSTR PO DIAM PRI POMOSHI ETALONA DLINI INSTRUMENTA I BLUMA)
(SPOSOB - PERE-VIZOV INSTRUMENTA)

(VC2=199.953 DLINA MASTER OPRAVKI stanok mc1)
(49.999 Dia MASTER OPRAVKI stanok mc1)
(VC2=199.947 DLINA MASTER OPRAVKI stanok mc2)
(24.998*2 Dia MASTER OPRAVKI stanok mc2)

VOK1=0
PKBQ=0.01
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT69
PSTG=VTLGN[VTLCN]
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT69
VTLD8[VTLCN]=1

NXT69
PST1=998
PST2=996
M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ PST1] GOTO NXT7
IF [PSTN EQ 0] GOTO NXTP8
M63
G04 F2
M6
G04 F2

NXTP8
TG=PST1 M6

NXT7
VTOFH[VTLCN]=0
VTOFD[VTLCN]=0
VTWOH[VTLCN]=0
VTWOD[VTLCN]=0

VIU3[VTLCN]=0
VIU4[VTLCN]=0
PLT=VTOH3[VTLCN]
PDT=VTOD3[VTLCN]
PD1=PDT (maximalnii radius)
PD2=PDT (poslednii zamerennii zub)
VTOFH[VTLCN]=PLT (DLINA MASTER OPRAVKI)
VTOFD[VTLCN]=PDT (RAD MASTER OPRAVKI)
M12
M155
G04 F1
M144

(ZAMER BIENIJA No: 1 PST1)
TG=PST2
S3750 M3
VSTOH[41]=0
NESH1
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK1
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV1
CALL OPRIN PA=319 PAA=PAA
NBLK1
M63
G04 F1
M6
G04 F1
NPROV1
IF[VSTOH[41] EQ 3] NVFK1
IF [VC100 NE 0] GOTO NESH1
GOTO ND521

NVFK1
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=319 PAA=PAA
M63
G04 F1
M6
G04 F1

ND521
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PD3=PD2 (nachalnii minimalnii radius)
PBK1=PD2
(IF [PD2 LE PD1] GOTO NXB1)
PD1=PD2 (maximalnii radius)
NXB1
(IF [PD2 GE PD3] GOTO NXB2)
PD3=PD2 (minimalnii radius)
NXB2
M6

(ZAMER BIENIJA No: 2 PST1)
TG=PST1 M6
TG=PST2
S3750 M3
VSTOH[41]=0
NESH2
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK2
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV2
CALL OPRIN PA=319 PAA=PAA
NBLK2
M63
G04 F1
M6
G04 F1
NPROV2
IF[VSTOH[41] EQ 3] NVFK2
IF [VC100 NE 0] GOTO NESH2
GOTO ND522

NVFK2
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=319 PAA=PAA
M63
G04 F1
M6
G04 F1

ND522
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK2=PD2
IF [PD2 LE PD1] GOTO NXB5
PD1=PD2 (maximalnii radius)
NXB5
IF [PD2 GE PD3] GOTO NXB6
PD3=PD2 (minimalnii radius)
NXB6
M6

(ZAMER BIENIJA No: 3 PST1)
TG=PST1 M6
TG=PST2
S3750 M3
VSTOH[41]=0
NESH3
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK3
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV3
CALL OPRIN PA=319 PAA=PAA
NBLK3
M63
G04 F1
M6
G04 F1
NPROV3
IF[VSTOH[41] EQ 3] NVFK3
IF [VC100 NE 0] GOTO NESH3
GOTO ND523

NVFK3
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=319 PAA=PAA
M63
G04 F1
M6
G04 F1

ND523
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK3=PD2
IF [PD2 LE PD1] GOTO NXB7
PD1=PD2 (maximalnii radius)
NXB7
IF [PD2 GE PD3] GOTO NXB8
PD3=PD2 (minimalnii radius)
NXB8
M6

(ZAMER BIENIJA No: 4 PST1)
TG=PST1 M6
TG=PST2
S3750 M3
VSTOH[41]=0
NESH4
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK4
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV4
CALL OPRIN PA=319 PAA=PAA
NBLK4
M63
G04 F1
M6
G04 F1
NPROV4
IF[VSTOH[41] EQ 3] NVFK4
IF [VC100 NE 0] GOTO NESH4
GOTO ND524

NVFK4
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=319 PAA=PAA
M63
G04 F1
M6
G04 F1

ND524
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK4=PD2
IF [PD2 LE PD1] GOTO NXB9
PD1=PD2 (maximalnii radius)
NXB9
IF [PD2 GE PD3] GOTO NXB10
PD3=PD2 (minimalnii radius)
NXB10
M6

(ZAMER BIENIJA No: 5 PST1)
TG=PST1 M6
TG=PST2
S3750 M3
VSTOH[41]=0
NESH5
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK5
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV5
CALL OPRIN PA=319 PAA=PAA
NBLK5
M63
G04 F1
M6
G04 F1
NPROV5
IF[VSTOH[41] EQ 3] NVFK5
IF [VC100 NE 0] GOTO NESH5
GOTO ND525

NVFK5
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=319 PAA=PAA
M63
G04 F1
M6
G04 F1

ND525
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK5=PD2
IF [PD2 LE PD1] GOTO NXB11
PD1=PD2 (maximalnii radius)
NXB11
IF [PD2 GE PD3] GOTO NXB12
PD3=PD2 (minimalnii radius)
NXB12
M6

(ZAMER BIENIJA No: 6 PST1)
TG=PST1 M6
TG=PST2
S3750 M3
VSTOH[41]=0
NESH6
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK6
IF [ABS[VTWOD[VTLCN]]LE 0.5] NPROV6
CALL OPRIN PA=319 PAA=PAA
NBLK6
M63
G04 F1
M6
G04 F1
NPROV6
IF[VSTOH[41] EQ 3] NVFK6
IF [VC100 NE 0] GOTO NESH6
GOTO ND526

NVFK6
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=319 PAA=PAA
M63
G04 F1
M6
G04 F1

ND526
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK6=PD2
IF [PD2 LE PD1] GOTO NXB13
PD1=PD2 (maximalnii radius)
NXB13
IF [PD2 GE PD3] GOTO NXB14
PD3=PD2 (minimalnii radius)
NXB14
M6

(ZAMER BIENIJA No: 7 PST1)
TG=PST1 M6
TG=PST2
S3750 M3
VSTOH[41]=0
NESH7
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK7
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV7
CALL OPRIN PA=319 PAA=PAA
NBLK7
M63
G04 F1
M6
G04 F1
NPROV7
IF[VSTOH[41] EQ 3] NVFK7
IF [VC100 NE 0] GOTO NESH7
GOTO ND527

NVFK7
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=319 PAA=PAA
M63
G04 F1
M6
G04 F1

ND527
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK7=PD2
IF [PD2 LE PD1] GOTO NXB15
PD1=PD2 (maximalnii radius)
NXB15
IF [PD2 GE PD3] GOTO NXB16
PD3=PD2 (minimalnii radius)
NXB16
M6

(ZAMER BIENIJA No: 8 PST1)
TG=PST1 M6
S3750 M3
VSTOH[41]=0
NESH8
VSTOH[41]=VSTOH[41]+1
CALL O9603 PE=2 PM=-2 PQ=0.1 PB=-1 PH=VTLCN PD=VTLCN PA=1. PR=0.05 PS=1 PT=1 PX=VTOD3[VTLCN]-3 PZ=3 PA=2
IF [ABS[VTWOH[VTLCN]] GE 0.5] NBLK8
IF [ABS[VTWOD[VTLCN]] LE 0.5] NPROV8
CALL OPRIN PA=319 PAA=PAA
NBLK8
M63
G04 F1
M6
G04 F1
NPROV8
IF[VSTOH[41] EQ 3] NVFK8
IF [VC100 NE 0] GOTO NESH8
GOTO ND528

NVFK8
(ZAMER NE PROIZVEDEN)
CALL OPRIN PA=319 PAA=PAA
M63
G04 F1
M6
G04 F1

ND528
PD2=VTOFD[VTLCN] (poslednii zamerennii zub)
PBK8=PD2
IF [PD2 LE PD1] GOTO NXB17
PD1=PD2 (maximalnii radius)
NXB17
IF [PD2 GE PD3] GOTO NXB18
PD3=PD2 (minimalnii radius)
NXB18
M145
G04 F0.5
M154
IF [PSTG EQ PST1] GOTO NXT49
IF [PSTN EQ 0] GOTO NXT48
TF=PSTN M6
GOTO NXT49

NXT48
M63
G04 F2
M6
G04 F2

NXT49
PBD1=PD1-PD3
IF [PBD1 GE PKBQ] GOTO NXT3
GOTO NXT4

NXT3
VOK1=1

NXT4
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0

NX2
CALL OPRIN PA=319 PAA=PAA PBK1=PBK1 PBK2=PBK2 PBK3=PBK3 PBK4=PBK4 PBK5=PBK5 PBK6=PBK6 PBK7=PBK7 PBK8=PBK8 PBD1=PBD1 PD1=PD1 PD3=PD3 PDT=PDT PKBQ=PKBQ
RTS


N10041
OPRWA 
(PRODUVKA RENISHAW PO VSEI DLINNE PRI POMOSHI BLUMA)

PSHN=VACOD
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT70
PSTG=VTLGN[VTLCN]
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT70
VTLD8[VTLCN]=1

NXT70
M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PSTG EQ 999] GOTO NXT7
TG=999 M6

NXT7
IF [PSTG EQ 999] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
IF [VSZOY[2] GE [VC288+0.5]] GOTO NXT15
IF [VSZOY[2] LE [VC288-0.5]] GOTO NXT15
GOTO NXT16

NXT15
VC288=VSZOY[2]

NXT16
VZOFX[200]=VSZOX[2]
VZOFY[200]=VC288
VZOFZ[200]=VSZOZ[2]
VZOFB[200]=0
VZOFU[200]=0
G15 H200
M12
S100 M3
M155
G04 F1
M144
G0 X0 Y0
G56 HA
G0 Z-5
G1 Z-195 F1000
G1 Z-5
G0 Z35
G0 Y28
G0 G16 Z600 H0
M145
G04 F1
M154
CALL OUAX PPP=1
IF [PSTG EQ 999] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PSHN EQ 200] GOTO NXT5
G15 H=PSHN

NXT5
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0

NX2
CALL OPRIN PA=320 PAA=PAA
RTS


N10042
OPKLW
(PRODUVKA ETALONA DLINNI INSTRUMENTA PRI POMOSHI BLUMA)
(CALL OPKLW PETN=1 OR 2)
(PETN-PARAMETR ETALON TOOL NUMBER; 1-ETALON TOOL FOR BLUM; 2-ETALON TOOL FOR MC2)
PSHN=VACOD
PETN=PETN
CALL OPTF PTOL=0
PSTN=VC900 
PSTG=0
IF [PSTN EQ 0] GOTO NXT56
PSTG=VTLGN[VTLCN]
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT56
VTLD8[VTLCN]=1

NXT56
M5
M9
G0 G16 Z600 H0
M12
IF [PSTG NE 999] GOTO NXT1
CALL OO19

NXT1
CALL OUAX PPP=1
IF [PETN EQ 1] GOTO NPET1
IF [PETN EQ 2] GOTO NPET2
GOTO NWRNG

NPET1
IF [PSTG EQ 995] GOTO NXT7
TG=995 M6
GOTO NXT7
NPET2
IF [PSTG EQ 998] GOTO NXT7
TG=998 M6

NXT7
IF [PSTG EQ 995] GOTO NXT2
IF [PSTG EQ 998] GOTO NXT2
IF [PSTN EQ 0] GOTO NXT2
TF=PSTN

NXT2
IF [VSZOY[2] GE [VC288+0.5]] GOTO NXT15
IF [VSZOY[2] LE [VC288-0.5]] GOTO NXT15
GOTO NXT16

NXT15
VC288=VSZOY[2]

NXT16
VZOFX[200]=VSZOX[2]
VZOFY[200]=VC288
VZOFZ[200]=VSZOZ[2]
VZOFB[200]=0
VZOFU[200]=0
G15 H200

NXT3
S100 M3
M12
IF [PETN EQ 2] GOTO NMK2
G0 X0 Y28.5
M155
G04 F1
M144
G56 HA
Z35
G04 F0.5
Y0
G04 F0.5
G1 G94 Z0 F1000
G1 Z35 F1500
G04 F0.5
G0 Y28.5
G04 F0.5
G0 G16 Z600 H0
M145
G04 F0.5
GOTO NM154

NMK2
G0 X0 Y28.5
M155
G04 F1
M144
G56 HA
Z10
G04 F0.5
Y0
G04 F0.5
G1 G94 Z-100 F1000
G1 Z10 F1500
G04 F0.5
G0 Y28.5
G04 F0.5
G0 G16 Z600 H0
M145

NM154
M154
CALL OUAX PPP=1
IF [PSTG EQ 995] GOTO NXT4
IF [PSTG EQ 998] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
M6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F2

NXT4
IF [PSHN EQ 200] GOTO NXT5
G15 H=PSHN

NXT5
IF [PAA EQ 11] GOTO NX1
IF [PAA EQ 12] GOTO NX1
GOTO NX2

NX1
PAA=0

NX2
CALL OPRIN PA=304 PAA=PAA PETN=PETN
GOTO NFIN

NWRNG (WRONG INPUT DATA)
CALL OPRIN PA=504 PAA=PAA PETN=PETN
VOKF=1

NFIN
RTS


N10043
OPRTT
(PRODUVKA INSTRUMENTA PRI POMOSHI BLUMA)
IF [VTOFH[VTLCN] NE 0] GOTO NSLE1
GOTO NXT5

NSLE1
G30 P1
PSHN=VACOD
CALL OPTF PTOL=0
PSTN=VC900
PSTG=0
IF [PSTN EQ 0] GOTO NXT70
PSTG=VTLGN[VTLCN]
PSTT=VTLD8[VTLCN]
IF [PSTT GT 1] GOTO NXT70
VTLD8[VTLCN]=1

NXT70
M9
G0 G16 Z600 H0

VZOFX[200]=VSZOX[2]
VZOFY[200]=VSZOY[2]
VZOFZ[200]=VSZOZ[2]
VZOFB[200]=0
VZOFU[200]=0
G15 H200

IF [VIRD[01138] EQ 1] GOTO NUK1
(KORREKCIYA STANDART TOOL'S)
IF [VTOFH[VTLCN] LT 100] GOTO NWRNG  (Lmin)
IF [VTOFH[VTLCN] GE 400] GOTO NWRNG  (Lmax)

G56 HA
G41 DA
GOTO NSTD
NUK1 (KORREKCIYA U-AXIS)
(****NET PROGI****)

NSTD
M3
M155
G04 F1
M144
G1 X=0 (VTOFD[VTLCN]) F30000
G1 Y=[1+VTOFD[VTLCN]] F30000

G0 Z25
G1 Z0 F1000
G04 F1
G0 Z25
M154

IF [PSTG EQ 999] GOTO NXT4
IF [PSTN EQ 0] GOTO NXT6
GOTO NXT4

NXT6
M63
G04 F1
M6
G04 F1

NXT4
IF [PSHN EQ 200] GOTO NXT5
G40
G15 H=PSHN
GOTO NXT5

NWRNG (WRONG INPUT DATA)
CALL OPRIN PA=504 PAA=PAA PETN=PETN
VOKF=1

NXT5
G40
RTS


N10044
OPTF 
(VIVOD V VC900 GROUP + SERIAL  TOOL, PTOL=0 ACT_TOOL)
(OPTF PTOL=PTOL - 0=VTLCN)
(PTOL- NOMER GNEZDA)
IF [PTOL NE 0] GOTO N101
PTOL=VTLCN

(ZAPISIVAET V VC900 ZNACHENIE GROUP+SERIAL)
N101
IF [VTLCN EQ 0] GOTO NENO
IF [1 GE VTLGN[PTOL] LE 9] GOTO N1
IF [10 GE VTLGN[PTOL] LE 99 ] GOTO N2
IF [100 GE VTLGN[PTOL] LE 999 ] GOTO N3
IF [1000 GE VTLGN[PTOL] LE 9999 ] GOTO N4
N1 PTCN=VTLGN[PTOL]*10000
GOTO N5
N2 PTCN=VTLGN[PTOL]*100000
GOTO N5
N3 PTCN=VTLGN[PTOL]*1000000
GOTO N5
N4 PTCN=VTLGN[PTOL]*10000000
N5
VC899=VTLGN[PTOL]
VC900=PTCN+VTLSN[PTOL]
GOTO NEND

NENO
VC899=0
VC900=0
NEND
RTS


N10045
OPPOT
(OPPOT - POISK GNEZDA PO TOOL GROUP, ZAPIS V VC903)
(CALL OPPOT PTG= PTS=)
PPOT=0

NPOT
PPOT=PPOT+1
PVPT=VPTNO[PPOT]
PVTG=VTLGN[PPOT]
IF [PVTG EQ PTG] GOTO NPFT
IF [PPOT EQ 171] GOTO NPOK
GOTO NPOT

NPOK (INSTRUMENT NE ZAREGESTRIROVAN V MAGAZINE, PALLETA ZABLOKIROVANA)
CALL OPRIN PA=1 PS=0 PAA=1 PTIM=PTIM PMIN=PMIN PH=PH PTN=PTN PTG=PTG PLE1=PLE1 PLE2=PLE2 PLE3=PLE3
VOKF=1
M63
G04 F1
M6
G04 F2
GOTO NEND

NPFT
IF [PTS NE 0] GOTO NPFTS

NPFT2 (VC903-ZAPISAN)
VC903=PPOT
GOTO NEND

NPFTS
IF [PTS EQ VTLSN[PPOT]] GOTO NPFT2
GOTO NPOT
NEND
RTS


N10046
OPHWW
(WRITE WEAR CORECTOR)
(CALL OPHWW PH=PH PDH=1,2 PVAL=0.001 PCT=)
(PDH - 1-LENGHT 2-DIAM/RAD)
(PCT -PCT=0 CURRENT TOOL, NUMBER OF POT)
IF[PCT NE 0] GOTO NVP1
PCT=VTLCN

NVP1 IF [PCT GT 0] GOTO NEX1
PVA=1
IF [VTLCN EQ 0] GOTO NALARM

NEX1
PVA=2
IF [PH LE 10000] GOTO NALARM
IF [PH EQ 10001] GOTO N1
IF [PH EQ 10002] GOTO N4
IF [PH EQ 10003] GOTO N7
GOTO NALARM

N1 
PVA=3
IF [PDH EQ 1] GOTO N2
IF [PDH EQ 2] GOTO N3
GOTO NALARM
N2 VTWOH[PCT]=PVAL
GOTO NEND
N3 VTWOD[PCT]=PVAL
GOTO NEND

N4
PVA=3
IF [PDH EQ 1] GOTO N5
IF [PDH EQ 2] GOTO N6
GOTO NALARM
N5 VIU1[PCT]=PVAL
GOTO NEND
N6 VIU2[PCT]=PVAL
GOTO NEND

N7
PVA=3
IF [PDH EQ 1] GOTO N8
IF [PDH EQ 2] GOTO N9
GOTO NALARM
N8 VIU3[PCT]=PVAL
GOTO NEND
N9 VIU4[PCT]=PVAL
GOTO NEND

NALARM (WRONG DATA INPUT)
CALL OP01 PAA=11 PVA=PVA
NEND 
RTS


N10047
OPHWR
(READ VALLUE OF WEAR CORECTOR IN VC902)
(CALL OPHWR PH=PH PDH=1,2 PCW=1,2,3 PCT=)
(PH- 10001=HA 10002=HB 10003=HC)
(PDH - 1-LENGHT 2-DIAM/RAD)
(PCW - 1- CORRECTION 2-WEAR 3-WEAR+COR)
(PCT -PCT=0 CURRENT TOOL, NUMBER OF POT)
IF [PCT GE 1] GOTO NEX1
PVA=1
IF [VTLCN EQ 0] GOTO NALARM
PCT=VTLCN

NEX1
PVA=4
IF [PCW LE 0] GOTO NALARM
IF [PCW EQ 1] N100
IF [PCW EQ 2] N100
IF [PCW EQ 3] N100
GOTO NALARM

N100
PVA=2
IF [PH LE 10000] GOTO NALARM
IF [PH EQ 10001] GOTO N1
IF [PH EQ 10002] GOTO N4
IF [PH EQ 10003] GOTO N7
GOTO NALARM

N1
PVA=3
IF [PDH EQ 1] GOTO N2
IF [PDH EQ 2] GOTO N3
GOTO NALARM
N2 IF [PCW EQ 1] N101
IF [PCW EQ 2] N102
VC902=VTOFH[PCT]
    GOTO NEND
N102 VC902=VTWOH[PCT]
GOTO NEND
N101 
VC902=VTOFH[PCT]-VTWOH[PCT]
GOTO NEND
N3 IF [PCW EQ 1] N103
IF [PCW EQ 2] N104
VC902=VTOFD[PCT]
    GOTO NEND
N104 VC902=VTWOD[PCT]
    GOTO NEND
N103 VC902=VTOFD[PCT]-VTWOD[PCT]
    GOTO NEND

N4
PVA=3
IF [PDH EQ 1] GOTO N5
IF [PDH EQ 2] GOTO N6
    GOTO NALARM
N5  IF [PCW EQ 1] N105
IF [PCW EQ 2] N106
VC902=VTOH2[PCT]+VIU1[PCT]
    GOTO NEND
N106 VC902=VIU1[PCT]
GOTO NEND
N105 VC902=VTOH2[PCT]
    GOTO NEND
N6 IF [PCW EQ 1] N107
IF [PCW EQ 2] N108
VC902=VTOD2[PCT]+VIU2[PCT]
    GOTO NEND
N108 VC902=VIU2[PCT]
    GOTO NEND
N107 VC902=VTOD2[PCT]
    GOTO NEND

N7
PVA=3
IF [PDH EQ 1] GOTO N8
IF [PDH EQ 2] GOTO N9
GOTO NALARM
N8 IF [PCW EQ 1] N109
IF [PCW EQ 2] N110
VC902=VTOH3[PCT]+VIU3[PCT]
GOTO NEND
N110 VC902=VIU3[PCT]
GOTO NEND
N109 VC902=VTOH3[PCT]
    GOTO NEND
N9 IF [PCW EQ 1] N111
IF [PCW EQ 2] N112
VC902=VTOD3[PCT]+VIU4[PCT]
GOTO NEND
N112 VC902=VIU4[PCT]
    GOTO NEND
N111 VC902=VTOD3[PCT]
    GOTO NEND
	
NALARM (WRONG DATA INPUT)
CALL OP01 PAA=12 PVA=PVA
NEND 
RTS


N10048
OBIP (MAX WEAR TO VC980)
IF [VIRD[01138] EQ 0] GOTO NOPRI1
(SAVE WEAR U-AXIS)
VC986=VIU1[VTLCN]   (HB)
VC987=VIU3[VTLCN]   (HC)
VC988=VTWOH[VTLCN]  (DW)
IF[ ABS[VC986] GE ABS[VC987]] GOTO NU01
IF[ABS[VC987] GE ABS[VC988]] GOTO NU02
VC980=VC988
NU01 IF[ABS[VC986] GE ABS[VC988]] GOTO NU03
VC980=VC988
GOTO NSO6
NU02 VC980=VC987
GOTO NSO6
NU03 VC980=VC986
GOTO NSO6

NOPRI1 (SAVE WEAR Std Tool)
VC985=VTWOH[VTLCN] (HA)
VC986=VIU1[VTLCN]  (HB)
VC988=VTWOD[VTLCN] (DA)
VC989=VIU2[VTLCN]  (DB)
IF[ABS[VC985] GE ABS[VC986]] GOTO NSO1
PWT1=VC986
GOTO NSO3
NSO1 PWT1=VC985

NSO3 IF[ABS[VC988] GE ABS[VC989]] GOTO NSO2
PWT2=VC989
GOTO NSO4
NSO2 PWT2=VC988
NSO4 IF[ABS[PWT1] GE ABS[PWT2]] GOTO NSO5
VC980=PWT2
GOTO NSO6
NSO5 VC980=PWT1
NSO6
RTS


N10049
OMIU (MAX RAZNICA OF WEARS TO VSTOD[39] DLYA OFOS)
IF [VC219 GE 1] GOTO NU05
IF [VIRD[01138] EQ 0] GOTO NFRZ1
(SAVE WEAR U-AXIS)
VC986=VIU1[VTLCN]   (HB) 
VC987=VIU3[VTLCN]   (HC) 
VC988=VTWOH[VTLCN]/-2  (DWr)
PSP6=VC971/-2
PSP7=VC987-VC979   (RAZNICA HC)
PSP7=PSP7*-1
PSP8=VC986-VC975   (RAZNICA HB)
PSP9=VC988-PSP6    (RAZNICA DWr)
VC967=PSP7 (ZAPOMINANIE DLYA OTCHETA)
VC968=PSP8 (ZAPOMINANIE DLYA OTCHETA)
VC969=PSP9 (ZAPOMINANIE DLYA OTCHETA)
IF[PSP7 LE 0] GOTO NU01 
IF[PSP8 GE PSP7] GOTO NU01  
IF[PSP7 GE PSP9] GOTO NU02
GOTO NU04

NU01 IF[PSP8 GE PSP9] GOTO NU03
NU04 VSTOD[39]=PSP9
GOTO NU11

NU02 VSTOD[39]=PSP7
GOTO NU11

NU03 VSTOD[39]=PSP8
GOTO NU11

NFRZ1 (SAVE WEAR Std Tool)
VC985=VTWOH[VTLCN] (HA)
VC986=VIU1[VTLCN]  (HB)
VC988=VTWOD[VTLCN] (DA)
PSP7=VC986-VC975   (RAZNICA HB)
PSP7=PSP7*-1
PSP8=VC985-VC971   (RAZNICA HA)
PSP9=VC988-VC973   (RAZNICA DA)
VC967=PSP7 (ZAPOMINANIE DLYA OTCHETA)
VC968=PSP8 (ZAPOMINANIE DLYA OTCHETA)
VC969=PSP9 (ZAPOMINANIE DLYA OTCHETA)
IF[PSP7 LE 0] GOTO NF01
IF[PSP8 GE PSP7] GOTO NF01
IF[PSP7 GE PSP9] GOTO NF02
GOTO NF04

NF01 IF[PSP8 GE PSP9] GOTO NF03
NF04 VSTOD[39]=PSP9
GOTO NU11

NF02 VSTOD[39]=PSP7
GOTO NU11

NF03 VSTOD[39]=PSP8
GOTO NU11

NU05
VSTOD[39]=0

NU11
RTS


N10050
OBMF (IZMERENIE FREZ)
PSH=0
VC282=VC282+1
IF [VSCOD NE 0] GOTO NSS1
S1000

NSS1
VC100=0
IF [VC215 EQ EMPTY] GOTO NVSZ3
PX=VC215
GOTO NVSZ4
NVSZ3
PX=0
VC215=0
NVSZ4

IF [PX LT 0] GOTO N45
VC967=0
VC968=0
VC969=0
VC984=0
VC985=0
VC986=0
VC987=0
VC988=0
VC989=0
VC991=PTYP
VC993=0
VC994=0
VC998=0
(******)
PWD1=VTWOD[VTLCN]
PFD1=VTOFD[VTLCN]
IF [VIRD[01138] NE 1] GOTO NVC28
VC286=VIU1[VTLCN]
VC287=VTWOH[VTLCN]
GOTO NX01
NVC28
VC286=VTWOH[VTLCN]
VC287=VTWOD[VTLCN]
(******)
PW=0
NX01
IF [VOKF EQ 1] GOTO NEND
IF [PSK EQ 1] GOTO NIF8 (ESLI OCTE, TO ZAMERIT')
IF [VTLD4[VTLCN] NE 0] GOTO NEND
NIF8
VOK1=0
IF [PTYP EQ 0] GOTO NTD00 (LENGHT)
IF [PTYP EQ 1] GOTO NTD01 (LENGTH+RADIUS)
IF [PTYP EQ 2] GOTO NTD02 (THREADMILL)
IF [PTYP EQ 3] GOTO NTD03 (GRIBOK)

VC100=4
GOTO NEND

(PH=1 TOOL LENGTH MEMORY OFFSET)
(PD=1 TOOL RADIUS MEMORY OFFSET)
(PB=0 -3=MEASURE NT,-2=CONTROL NT,-1=CHECK NT,0=MEASURE,1=CHECK,2=CONTROL,3=MEASURE NT)
(PE=0 TYPE  0=LENGTH+RADUIS,1=LENGTH,2=RADIUS)
(PM=-1 SPECIAL FUNCTION -2,-1,1,2)
(PZ=5 LENGTH OFFSET FOR RADIUS MEASUREMENT)
(PX=4.5 RADIUS OFFSET FOR LENGTH MEASUREMENT)
(PS=0.05 MAXIMUM WEAR TOOL LENGTH)
(PT=0.05 MAXIMUM WEAR TOOL RADIUS)
(PC=3 NUMBER OF CUTTING EDGES)
(PQ=0.1 ALLOWED RUNOUT TOLERANCE)
(PW=0 ADDITIONAL LENGTH CORRECTION)
(PU=0 ADDITIONAL RADIUS CORRECTION)
(PA=3 NUMBER OF MEASUREMENTS)
(PR=0.01 MAX. VARIATION OF MEAS. RESULTS)
(PV=1.5 THREAD PITH) 
(PA=8 NUMBER OF CHECK POSITION)

NTD00 (LENGHT)
VC992=ABS[VC971]
VC214=0
IF [VC215 EQ 0] GOTO NVSZ1
PX=VC972-VC215
NVSZ1
PE=1
PM=-1
IF[VTLGN[VTLCN] NE 997] NMO1
M5
S3750
GOTO NMO2
NMO1
M3 (ROTATE SPINDLE)
NMO2
VTOFH[VTLCN]=VC970-VTOH3[VTLCN](DLINA -VIRT PERESHET H)
VTWOH[VTLCN]=0
VTOFD[VTLCN]=VC972
VTWOD[VTLCN]=0
GOTO N9603

NTD01 (LENGTH+RADIUS)
IF [VC215 EQ 0] GOTO NVSZ2
IF [VC214 NE 0] GOTO NTD2
PX=VC972-VC215
GOTO NVSY2 
NTD2
PX=VC972-VC215-VC214
GOTO NVSY2
NVSZ2
IF [VC214 EQ 0] GOTO NVSY2
PX=VC972-VC214
NVSY2
VC992=ABS[VC971]+ABS[VC973]
M3
PE=0
PM=-1
VTOFH[VTLCN]=VC970
VTWOH[VTLCN]=0
VTOFD[VTLCN]=VC972
VTWOD[VTLCN]=0
GOTO N9603

NTD02 (THREADMILL)
VC992=ABS[VC971]+ABS[VC973]
VC214=0 (PTR)
PX=0	(VC972-VC215)
M3
PE=0
PM=-1
VTOFH[VTLCN]=VC970
VTWOH[VTLCN]=0
VTOFD[VTLCN]=VC972
VTWOD[VTLCN]=0
GOTO N9603

NTD03 (GRIBOK)
IF [VC215 EQ 0] GOTO NVSZ3
PX=VC972-VC215-VC214
NVSZ3
IF[VSTOD[50] NE 0] GOTO NTM01
VIU5[VTLCN]=VTOH2[VTLCN] (SAVE BASE LENGHT2)
NTM01
IF [VIU5[VTLCN] LT 92] GOTO N45
VC992=ABS[VC971]+ABS[VC973]+ABS[VC975]
M3
PE=0
PM=-1
VTOFH[VTLCN]=VC970
VTWOH[VTLCN]=0
VTOFD[VTLCN]=VC972
VTWOD[VTLCN]=0
GOTO N9603

NTD06 (ZAMER DLINI V OCTI)
VC992=ABS[VC971]+ABS[VC973]
IF [VC214 GE 0.3] GOTO NUAN3
VC214=0.5
NUAN3
M3
PE=1
PM=-1
PX=VC972-VC215-VC214
VTOFH[VTLCN]=VC970
VTWOH[VTLCN]=0
VTOFD[VTLCN]=VC972
VTWOD[VTLCN]=0
GOTO N9603

N9603
CALL O9603 PH=VTLCN PD=VTLCN PB=-1 PE=PE PM=PM PZ=VC214+PZ PX=PX PS=PLE2+3 PT=PLE2+3 PC=PTZ PQ=PQ PW=PW PU=0. PA=2 PR=0.015 

VC555=VTOFD[VTLCN]
IF [PTYP EQ 13] GOTO NVCN 
IF [VSTOD[50] NE 0] NL031
IF [ABS[VTWOH[VTLCN]] GT PLE3] GOTO NI998
IF [ABS[VTWOD[VTLCN]] GT PLE3] GOTO NI998
GOTO NI888
NI998 VC985=VTWOH[VTLCN] 
      VC993=VTWOH[VTLCN] (NEW WEAR HA FOR OP01)
      VC994=VTWOD[VTLCN] (NEW WEAR DA FOR OP01)
GOTO NE999
NI888 VTOFH[VTLCN]=VTOFH[VTLCN]
VTWOH[VTLCN]=0.001
VTOFD[VTLCN]=VTOFD[VTLCN]
VTWOD[VTLCN]=0.001
NL031
VC985=VTWOH[VTLCN] 
VC993=VTWOH[VTLCN] (NEW WEAR HA FOR OP01)
VC994=VTWOD[VTLCN] (NEW WEAR DA FOR OP01)
GOTO NEPYT
NVCN
IF [VSTOD[50] NE 0] NL041
IF [ABS[VTWOH[VTLCN]] GT PLE3] GOTO NI999
IF [ABS[VTWOD[VTLCN]] GT PLE3] GOTO NI999
GOTO NI889
NI999 VC998=VTWOH[VTLCN] (NEW WEAR HA FOR OP01)
      VC999=VTWOD[VTLCN] (NEW WEAR DA FOR OP01)
	  PWW=1
GOTO NGRB2
NI889 VTOFH[VTLCN]=VTOFH[VTLCN]
VTWOH[VTLCN]=0.001
VTOFD[VTLCN]=VTOFD[VTLCN]
VTWOD[VTLCN]=0.001
NL041
VC998=VTWOH[VTLCN] (NEW WEAR HB FOR OP01)
VC999=VTWOD[VTLCN] (NEW WEAR DB FOR OP01)

NEPYT
IF [PTYP EQ 0] GOTO NSTD1 (STD+VIRT-COR)
IF [PTYP EQ 1] GOTO NSTD1 (LENGTH+RADIUS)
IF [PTYP EQ 2] GOTO NEND (THREADMILL)
IF [PTYP EQ 3] GOTO NEND (GRIBOK)
IF [PTYP EQ 13] GOTO NGRB2 (GRIBOK 2-AYA STORONA)
GOTO NEND

NSTD1
(VOZVRAT DLINI)
PWH1=VTWOH[VTLCN]
VTOFH[VTLCN]=VTOFH[VTLCN]+VTOH3[VTLCN]-PWH1
IF [VSTOD[50] NE 0] NL011
VTOFH[VTLCN]=VTOFH[VTLCN]
VTWOH[VTLCN]=0.001
NL011
VTWOH[VTLCN]=PWH1

(VOZVRAT RAD)
IF [VTWOD[VTLCN] NE 0] GOTO NL021
VTWOD[VTLCN]=0.001
NL021 VC983=VTWOD[VTLCN] (NEW WEAR)
IF [VSTOD[50] EQ 0] NL012
VTOFD[VTLCN]=VC972
(*****)
NL012
IF [PTYP EQ 1] GOTO NSTP1
VTWOD[VTLCN]=VC973 
GOTO NEND

NSTP1
IF [VC100 EQ 0] GOTO NSTP2
VTWOD[VTLCN]=VC973
GOTO NEND

NSTP2
VTWOD[VTLCN]=VC983 
GOTO NEND

NTAP
PTYP=12
S3750 M3
IF [PA GT 1] GOTO N9605
PV=0
N9605
PX=0
CALL O9605 PH=VTLCN PD=VTLCN PC=PTZ PQ=0.08 PZ=PZ PV=PV PA=PA PF=100.
M5 (SPINDEL STOP)
GOTO NEND

NGRB1 (GRIBOK PERED ZAMEROM 2-OY STORONI)
IF [VSTOD[50] NE 0] NL051
VTOFH[VTLCN]=VTOFH[VTLCN]
VTWOH[VTLCN]=0.001
VTOFD[VTLCN]=VTOFD[VTLCN]
VTWOD[VTLCN]=0.001
VC603=VTWOH[VTLCN] (WHA-NEW)
VC604=VTWOD[VTLCN] (WDA-NEW)
VC601=VTOFH[VTLCN] (HA-NEW)
VC602=VTOFD[VTLCN] (DA-NEW)
GOTO NL061         

NL051 VC603=VTOFH[VTLCN]-VC970 (WHA-NEW)
      VC604=VTOFD[VTLCN]-VC972 (WDA-NEW)
      VC601=VC970 (HA-OLD)
      VC602=VC972 (DA-OLD)

(GRIBOK 2-AYA STORONA)
NL061 PTYP=13
VTOFH[VTLCN]=VTOH2[VTLCN]
M3
PE=1
PM=2
PQ=PQ
VC214=ABS[VC214]*-1 (PTR)
PZ=ABS[PZ]*-1
PX=VC972-VC215+VC214
GOTO N9603

NGRB2 (GRIBOK POSLE ZAMERA 2-OY STORONI)
VC611=VTOFH[VTLCN]
VC613=VTWOH[VTLCN]
VTOFH[VTLCN]=VC601
VTOFD[VTLCN]=VC602
VTWOH[VTLCN]=VC603
VTWOD[VTLCN]=VC604
VTOH2[VTLCN]=VC611
IF [VSTOD[50] NE 0] GOTO NVI1
IF [ABS[VC613] GT PLE3] GOTO NI997
GOTO NI887
NI997 VIU5[VTLCN]=VTOH2[VTLCN]
      VIU1[VTLCN]=VC613
	  PWW=1
GOTO NVI2
NI887 VIU5[VTLCN]=VTOH2[VTLCN]
      VIU1[VTLCN]=0.001
GOTO NVI2
NVI1 VIU1[VTLCN]=VC611-VC974
NVI2 VC993=VTWOH[VTLCN] (NEW WEAR HA FOR OP01)
VC994=VTWOD[VTLCN] (NEW WEAR DA FOR OP01)
VC998=VIU1[VTLCN]  (NEW WEAR HB FOR OP01)
M5 (SPINDEL STOP)

IF [PWW NE 1] GOTO NEND
GOTO NE999

NEND
IF[VC100 EQ 1]GOTO N15
IF[VC100 EQ 2]GOTO N25
IF[VC100 EQ 3]GOTO N35
IF[VC100 EQ 4]GOTO N45
IF[VC100 EQ 5]GOTO N55
IF[VC100 EQ 6]GOTO N65
IF[VC100 EQ 7]GOTO N75
IF[VC100 EQ 8]GOTO N85
IF[VC100 EQ 9]GOTO N95
IF[VC100 EQ 10]GOTO N105
IF[VC100 EQ 11]GOTO N115
IF[VC100 EQ 12]GOTO N125
IF[VC100 EQ 13]GOTO N135
IF[VC100 EQ 14]GOTO N145
IF[VC100 EQ 15]GOTO N155
IF[VC100 EQ 16]GOTO N165
IF[VC100 EQ 17]GOTO N175
IF[VC100 EQ 18]GOTO N185
IF[VC100 EQ 19]GOTO N195
IF[VC100 EQ 20]GOTO N205
IF[VC100 EQ 21]GOTO N215
IF[VC100 EQ 22]GOTO N225
IF[VC100 EQ 23]GOTO N235
IF[VC100 GE 24]GOTO N245
IF[VC100 LT 0]GOTO N245

IF [PSK NE 0] GOTO NIP3 
(PROVERKA OCTS NA OPTIKY)
IF [ABS[VC993] GT PLE3] GOTO NE999
IF [ABS[VC994] GT PLE3] GOTO NE999
IF [ABS[VC998] GT PLE3] GOTO NE999 
GOTO NIP4

NIP3
(PROVERKA DOPUSKA)
IF [ABS[VC993] GT PLE2] GOTO NE999
IF [ABS[VC994] GT PLE2] GOTO NE999
IF [ABS[VC998] GT PLE2] GOTO NE999
IF [ABS[VC993] GT PLE1] GOTO NE999
IF [ABS[VC994] GT PLE1] GOTO NE999
IF [ABS[VC998] GT PLE1] GOTO NE999

(***********BACK CONTROL TEATH***************)
(*****VOZVRAT K CIKLY NA VTOROY ZAMER********)
NIP4
IF [PTYP EQ 2] GOTO NTAP (THREADMILL)
IF [PTYP EQ 3] GOTO NGRB1 (GRIBOK)
GOTO NOPRI1

N15  MSG(Laser not ready)
GOTO NE999
N25  MSG(No tool offset T0/D0)
GOTO NE999
N35  MSG(Incorrect table parameter)
GOTO NE999

N45  MSG(Incorrect call parameter)
VC555=VTOFD[VTLCN]
VTOFD[VTLCN]=VC972
VTWOD[VTLCN]=VC973
VC100=4
CALL OPRIN PA=64 PAA=202 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PD1=PD1 PD2=PD2 PD3=PD3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NE999

N55  MSG(Incorrect tool parameter)
GOTO NE999
N65  MSG(Collision risk with Laser)
GOTO NE999
N75  MSG(Tool data out of limit)
GOTO NE999
N85  MSG(Error at start measuring block)
GOTO NE999
N95  MSG(Measurement without trigger signal)
GOTO NE999
N105 MSG(Deviation of meas. values > limit)
GOTO NE999
N115 MSG(Thermal drift > limit)
GOTO NE999
N125 MSG(Error during evaluation)
GOTO NE999
N135 MSG(Incorrect spindle RPM)
GOTO NE999
N145 MSG(Incorrect calibration-/TC-parameter)
GOTO NE999
N155 MSG(Cutting edge broken)
GOTO NE999
N165 MSG(Out of tolerance)
GOTO NE999
N175 MSG(VC129 invalid)
GOTO NE999
N185 MSG(Incorrect scale unit G20/G21)
GOTO NE999
N195 MSG(Tool broken)
GOTO NE999
N205 MSG(Function not possible)
GOTO NE999
N215 MSG(Unexpected trigger signal)
GOTO NE999
N225 MSG(Reserved)
GOTO NE999
N235 MSG(Reserved)
GOTO NE999
N245 MSG(Incorrect error number)

NE999 
(TOOL BREAKED)
IF [PTYP EQ 3] GOTO NGRAL
GOTO NOPRI1

NGRAL
(VOZVRAT RAD)
VC983=VTWOD[VTLCN] (NEW WEAR)
VTOFD[VTLCN]=VC972
VTWOD[VTLCN]=VC983 

NOPRI1 
(WEAR 0.001 ESLI 0)
IF[VTWOH[VTLCN] NE 0] GOTO NOF01
VTWOH[VTLCN]=0.001

NOF01 IF[VTWOD[VTLCN] NE 0] GOTO NOF02
VTWOD[VTLCN]=0.001

NOF02 IF [VC991 NE 3] GOTO NOF03
IF[VIU1[VTLCN] NE 0] GOTO NOF03
VIU1[VTLCN]=0.001
(\WEAR 0.001 ESLI 0/)

NOF03
CALL OBIP 
IF [ABS[VC980] GT PLE3] GOTO NWE5 (CHECK OPTIC)
GOTO NWE1

NWE5
VC990=1
GOTO NWE6

NWE1
VC990=0

NWE6
RTS


N10051
OBMU (IZMERENIE DANDREA)
(PRODUVKA U-AXIS)
G30P1
(CALL OBMU PH=PH PTYP=PTYP PRA=PRAL PZ=PZ PX=PX PLE1=PLE1 PLE2=PLE2 PLE3=PLE3 PTZ=PTZ PA=PA PV=PV PSK=PS )
PSH=0
VC282=VC282+1
VC100=0

PLQS=VC230
PX=VC215
VC984=0
VC985=0
VC986=0
VC987=0
VC988=0
VC989=0
VC991=PTYP
VC993=0
VC994=0
VC998=0
(******)
PWD1=VTWOD[VTLCN]
PFD1=VTOFD[VTLCN]
(******)
PW=0

IF [VOKF EQ 1] GOTO NEND
IF [PSK EQ 1] GOTO NIF8 (ESLI OCTE, TO ZAMERIT')
IF [VTLD4[VTLCN] NE 0] GOTO NEND
NIF8
VOKF=0
IF [PTYP EQ 4] GOTO NTD01 (Uax std)
IF [PTYP EQ 5] GOTO NTD01 (Uax KANAVKA)
VC100=4
GOTO NEND

(PH=1 TOOL LENGTH MEMORY OFFSET)
(PD=1 TOOL RADIUS MEMORY OFFSET)
(PB=0 -3=MEASURE NT,-2=CONTROL NT,-1=CHECK NT,0=MEASURE,1=CHECK,2=CONTROL,3=MEASURE NT)
(PE=0 TYPE  0=LENGTH+RADUIS,1=LENGTH,2=RADIUS)
(PM=-1 SPECIAL FUNCTION -2,-1,1,2)
(PZ=5 LENGTH OFFSET FOR RADIUS MEASUREMENT)
(PX=4.5 RADIUS OFFSET FOR LENGTH MEASUREMENT)
(PS=0.05 MAXIMUM WEAR TOOL LENGTH)
(PT=0.05 MAXIMUM WEAR TOOL RADIUS)
(PC=3 NUMBER OF CUTTING EDGES)
(PQ=0.1 ALLOWED RUNOUT TOLERANCE)
(PW=0 ADDITIONAL LENGTH CORRECTION)
(PU=0 ADDITIONAL RADIUS CORRECTION)
(PA=3 NUMBER OF MEASUREMENTS)
(PR=0.01 MAX. VARIATION OF MEAS. RESULTS)
(PV=1.5 THREAD PITH) 
(PA=8 NUMBER OF CHECK POSITION)


NTD01 (OMBU_Uax std_ID+KANAVA)
VSTOD[34]=PTYP
VTOFD[VTLCN]=VC970/-2+VSTOD[47]
VTOFH[VTLCN]=VC974
PQ=0.5
PTZ=0
PE=1
PM=-1

(PRODUVKA)
M144
M155
G53
G16 H0 G0 X304.957 Y=50+VTOFD[VTLCN]
G16 H0 G0 Z=VC90+2+VTOH2[VTLCN]
G4F3

(ZAMER L1)
VSTOD[33]=PE
CALL O9603 PH=VTLCN PD=VTLCN PB=-1 PE=PE PM=PM PZ=PZ PX=VTOFD[VTLCN]-VC215-3 PS=PLE2+5 PT=PLE2+5 PC=PTZ PQ=PQ PW=PW PU=0. PA=2 PR=0.015
IF[VC100 NE 0] GOTO NEND
PE=2
(SAVE L1 MEAS)
VTOH2[VTLCN]=VTOFH[VTLCN]
VIU1[VTLCN]=VTOH2[VTLCN]-VIU5[VTLCN]
IF [VSTOD[50] NE 0] NL011
VIU5[VTLCN]=VTOFH[VTLCN]
VIU1[VTLCN]=0.001
NL011
VSTOD[43]=VTOFH[VTLCN] (L1-MEAS)
VSTOD[42]=VIU1[VTLCN]  (L1w_MEAS)
(\ZAMER L1/)

(ZAMER D + L2-if need)
VTOFH[VTLCN]=VIU5[VTLCN] (ORIGINAL LENGHT)
M5 
S3750
M19 RS=180+VSTOH[1]
VSTOD[33]=PE
CALL O9603 PH=VTLCN PD=VTLCN PB=-1 PE=PE PM=PM PZ=PZ PX=VTOFD[VTLCN]-VC215 PS=PLE2+5 PT=PLE2+5 PC=PTZ PQ=PQ PW=PW PU=0. PA=2 PR=0.015 
IF[VC100 NE 0] GOTO NEND

IF [PTYP NE 5] NZ3

VTOFH[VTLCN]=VIU6[VTLCN] (VSTOD[45])
PE=1
PM=2
VC214=ABS[VC214]*-1
PZ=ABS[PZ]*-1
CALL O9603 PH=VTLCN PD=VTLCN PB=1 PE=PE PM=PM PZ=PZ PX=VTOFD[VTLCN]-VC215 PS=PLE2+5 PT=PLE2+5 PC=PTZ PQ=PQ PW=PW PU=0. PA=2 PR=0.015 
IF[VC100 NE 0] GOTO NEND
VTOH3[VTLCN]=VTOFH[VTLCN]
VIU3[VTLCN]=VTOH3[VTLCN]-VIU6[VTLCN]
IF [VSTOD[50] NE 0] NL031
VIU3[VTLCN]=0.001
VIU6[VTLCN]=VTOFH[VTLCN]
NL031
IF [VIU3[VTLCN] NE 0] GOTO NZ3
VIU3[VTLCN]=0.001

NZ3
(RASCHET DIA)
PWED=VTWOD[VTLCN]
IF [VSTOD[50] NE 0] NL021
VTOFD[VTLCN]=VTOFD[VTLCN]-VSTOD[47]
VTOFH[VTLCN]=VTOFD[VTLCN]*-2
VTWOH[VTLCN]=0.001
GOTO NL022
NL021
VTOFH[VTLCN]=VC970
VTWOH[VTLCN]=PWED*-2
NL022
VSTOD[41]=VTOFD[VTLCN]-VTWOH[VTLCN] (DMeas)
VSTOD[40]=VTWOH[VTLCN] (DMw)
VSTOD[37]=VTOH3[VTLCN] (L2Meas)
VSTOD[36]=VIU3[VTLCN] (L2Mw)

NZ2 (FINISH OF MEASURE)
VC555=VTOFD[VTLCN]
IF[VC100 NE 0] GOTO NEND

(DOLGNA BIT ZAPOLNENA TABLICA INSTRUMENTA DANDREA DA Dw L1 L1w L2 Lw)

(WEAR 0.001 ESLI 0)
IF[VTWOH[VTLCN] NE 0] NOF01
VTWOH[VTLCN]=0.001
NOF01
IF[VIU1[VTLCN] NE 0] NOF02
VIU1[VTLCN]=0.001
NOF02
IF[PTYP NE 5] NOF03
IF[VIU3[VTLCN] NE 0] NOF03
VIU3[VTLCN]=0.001
NOF03
(\WEAR 0.001 ESLI 0/)

VC993=VIU1[VTLCN] (NEW WEAR HB FOR OP01)
VC994=VTWOD[VTLCN] (NEW WEAR DA FOR OP01)
VC998=VIU3[VTLCN] (NEW WEAR HC FOR OP01)

NEND
IF[VC100 EQ 1]GOTO N15
IF[VC100 EQ 2]GOTO N25
IF[VC100 EQ 3]GOTO N35
IF[VC100 EQ 4]GOTO N45
IF[VC100 EQ 5]GOTO N55
IF[VC100 EQ 6]GOTO N65
IF[VC100 EQ 7]GOTO N75
IF[VC100 EQ 8]GOTO N85
IF[VC100 EQ 9]GOTO N95
IF[VC100 EQ 10]GOTO N105
IF[VC100 EQ 11]GOTO N115
IF[VC100 EQ 12]GOTO N125
IF[VC100 EQ 13]GOTO N135
IF[VC100 EQ 14]GOTO N145
IF[VC100 EQ 15]GOTO N155
IF[VC100 EQ 16]GOTO N165
IF[VC100 EQ 17]GOTO N175
IF[VC100 EQ 18]GOTO N185
IF[VC100 EQ 19]GOTO N195
IF[VC100 EQ 20]GOTO N205
IF[VC100 EQ 21]GOTO N215
IF[VC100 EQ 22]GOTO N225
IF[VC100 EQ 23]GOTO N235
IF[VC100 GE 24]GOTO N245
IF[VC100 LT 0]GOTO N245

IF [PSK NE 0] GOTO NIP3 
(PROVERKA OCTS NA OPTIKY)
IF [ABS[VC993] GT PLE3] GOTO NE999
IF [ABS[VC994] GT PLE3] GOTO NE999
IF [ABS[VC998] GT PLE3] GOTO NE999
GOTO NIP4

NIP3
(PROVERKA DOPUSKA)
IF [ABS[VC993] GT PLE2] GOTO NE999
IF [ABS[VC994] GT PLE2] GOTO NE999
IF [ABS[VC998] GT PLE2] GOTO NE999
IF [ABS[VC993] GT PLE1] GOTO NE999
IF [ABS[VC994] GT PLE1] GOTO NE999
IF [ABS[VC998] GT PLE1] GOTO NE999

NIP4
GOTO NE999
N15  MSG(Laser not ready)
GOTO NE999
N25  MSG(No tool offset T0/D0)
GOTO NE999
N35  MSG(Incorrect table parameter)
GOTO NE999

N45  MSG(Incorrect call parameter)
VC555=VTOFD[VTLCN]
VTOH2[VTLCN]=VTOFH[VTLCN] (HB+HBW)
VIU1[VTLCN]=VTOH2[VTLCN]-VIU5[VTLCN]
VC974=VTOH2[VTLCN]
VTOFH[VTLCN]=VC970
IF [PRU NE 1] GOTO NPUR0
VTWOH[VTLCN]=VC994*-2 (2)
GOTO NPUR1
NPUR0
VTWOH[VTLCN]=VC994*-2 
NPUR1
VIU2[VTLCN]=0
VTOFD[VTLCN]=0
CALL OPRIN PA=64 PAA=202 PH=PH PCT=PCT PCO1=PCO1 PCO2=PCO2 PM=PM PZ1=PZ1 PZ2=PZ2 PDW=PDW PD1=PD1 PD2=PD2 PD3=PD3 PWR1=PWR1 PSTN=PSTN PSTG=PSTG
GOTO NE999

N55  MSG(Incorrect tool parameter)
GOTO NE999
N65  MSG(Collision risk with Laser)
GOTO NE999
N75  MSG(Tool data out of limit)
GOTO NE999
N85  MSG(Error at start measuring block)
GOTO NE999
N95  MSG(Measurement without trigger signal)
GOTO NE999
N105 MSG(Deviation of meas. values > limit)
GOTO NE999
N115 MSG(Thermal drift > limit)
GOTO NE999
N125 MSG(Error during evaluation)
GOTO NE999
N135 MSG(Incorrect spindle RPM)
GOTO NE999
N145 MSG(Incorrect calibration-/TC-parameter)
GOTO NE999
N155 MSG(Cutting edge broken)
GOTO NE999
N165 MSG(Out of tolerance)
GOTO NE999
N175 MSG(VC129 invalid)
GOTO NE999
N185 MSG(Incorrect scale unit G20/G21)
GOTO NE999
N195 MSG(Tool broken)
GOTO NE999
N205 MSG(Function not possible)
GOTO NE999
N215 MSG(Unexpected trigger signal)
GOTO NE999
N225 MSG(Reserved)
GOTO NE999
N235 MSG(Reserved)
GOTO NE999
N245 MSG(Incorrect error number)
GOTO NE999
NE999 
(TOOL BREAKED)
VC[603]=VTWOH[VTLCN] 
VC[601]=VTOFH[VTLCN]

(PLE3)
IF[VSTOD[50] NE 0] NEFT
PD1=VC970-VTOFH[VTLCN]
PD2=VC974-VTOH2[VTLCN]
IF [ABS[PD1] GE ABS[PD2]] NPD1
VSTOD[38]=PD2
GOTO NPD2
NPD1
VSTOD[38]=PD1
NPD2
IF[PTYP NE 5] NEFT
PD1=VC978-VTOH3[VTLCN]
IF [ABS[PD1] LE ABS[VSTOD[38]]] NEFT
VSTOD[38]=PD1
(\PLE3/)

NEFT 
RTS


N10052
OPRIN
(VIVOD OTCHETA)
PTN=VC225
PTG=VC226
VPRT=12
MPR=1
PNPR=0 (NOMER PROGRAMMI)
CALL OPPOT PTG=998 PTS=1 (POISK V KAKOI JACHEIKE MAGAZINA INSTRYMENT, ZAPIS' V VC903)
IF [VTOH3[VC903] EQ 199.953] GOTO NMC1 (VIBOR FAILA ZAPISI V ZAVISIMOSTI OT DLINI MASTER-OPRAVKI V MC1)
IF [VTOH3[VC903] EQ 199.947] GOTO NMC2 (VIBOR FAILA ZAPISI V ZAVISIMOSTI OT DLINI MASTER-OPRAVKI V MC2)
GOTO NMC3
NMC1
FWRITC ALARM1.TXT;A
GOTO NEN2
NMC2
FWRITC ALARM2.TXT;A
GOTO NEN2
NMC3
FWRITC ALARM.TXT;A
NEN2
IF [PA EQ 203] GOTO NPA33
IF [PAA EQ 0] GOTO NXT41
PUT 'Dat:' PUT VTIME[3] PUT '.' PUT VTIME[2] PUT '.' PUT VTIME[1]
PUT ' Tim:' PUT VTIME[4] PUT ':' PUT VTIME[5] PUT ':' PUT VTIME[6]
WRITE C
IF [PA EQ 0] GOTO NPA33
IF [PA EQ 200] GOTO NXT41
IF [VC292 EQ 0] GOTO NEXT2
PUT '# ' PUT 'PALLETA ' PUT 'No. =' PUT VC292
WRITE C

NEXT2
IF [VC289 EQ 0] GOTO NXT41
PUT 'NOMER ' PUT 'PEREHODA ' PUT 'IZ ' PUT 'NX CAM=' PUT VC289
WRITE C

NXT41
IF [PA EQ 201] GOTO NPA33
IF [PA EQ 202] GOTO NPA33
IF [PAA EQ 0] GOTO NPA0 (PROPUSK)
IF [PAA EQ 1] GOTO NPA1 (OCTS)
IF [PAA EQ 2] GOTO NPA2 (OCTE)
IF [PAA EQ 3] GOTO NPA3 (OCTI)
IF [PAA EQ 4] GOTO NPA4 (OCRS)
IF [PAA EQ 5] GOTO NPA5 (OFFS)
IF [PAA EQ 6] GOTO NPA6 (ORW)
IF [PAA EQ 7] GOTO NPA7 (OBACK)
IF [PAA EQ 8] GOTO NPA8 (OMCS)
IF [PAA EQ 9] GOTO NPA9 (ORB)
IF [PAA EQ 10] GOTO NPA10 (ORPA)
IF [PAA EQ 11] GOTO NPA11 (PALLETCHG)
IF [PAA EQ 12] GOTO NPA12 (FASTEMS)
GOTO NPA33

NPA0
GOTO NPA33

NPA1
PUT 'DO ' PUT 'NACHALA ' PUT 'OBRABOTKI ' PUT 'V ' PUT 'CIKLE ' PUT '-> OCTS '
WRITE C
GOTO NPA33

NPA2
PUT 'POSLE ' PUT 'OBRABOTKI ' PUT 'V ' PUT 'CIKLE ' PUT '-> OCTE '
WRITE C
GOTO NPA33

NPA3
PUT '************** ' PUT '!!! OPASNO !!! ' PUT '************** '
WRITE C
PUT 'POSLE ' PUT 'OBRABOTKI ' PUT 'V ' PUT 'CIKLE ' PUT '-> OCTI '
WRITE C
IF [VIRD[01138] EQ 1] GOTO NXT30
IF [VIU4[VTLCN]EQ 0] GOTO NXT28
PUT 'FREZA ' PUT 'SLOMALAS ' PUT 'PRI ' PUT 'VIPOLNENII ' PUT 'CHISTOVOGO ' PUT 'RAZMERA '
WRITE C
GOTO NPA33

NXT28
PUT 'FREZA ' PUT 'SLOMALAS ' PUT 'PRI ' PUT 'VIPOLNENII ' PUT 'TEHNOLOGICHESK. ' PUT 'RAZMERA '
WRITE C
PUT 'DO ' PUT 'ZAMERA ' PUT 'RENISHAW '
WRITE C
GOTO NPA33

NXT30
IF [VIU4[VTLCN]EQ 0] GOTO NXT31
PUT 'POLOMKA ' PUT 'DANDREA ' PUT 'PRI ' PUT 'TOCHENII ' PUT 'CHISTOVOGO ' PUT 'DIAMETRA '
WRITE C
GOTO NPA33

NXT31
PUT 'POLOMKA ' PUT 'DANDREA ' PUT 'PRI ' PUT 'TOCHENII ' PUT 'TEHNOLOGICHESK. ' PUT 'DIAMETRA '
WRITE C
PUT 'DO ' PUT 'ZAMERA ' PUT 'RENISHAW '
WRITE C
GOTO NPA33

NPA4
PUT '************** ' PUT '!!! OPASNO !!! ' PUT '************** '
WRITE C
PUT 'POSLE ' PUT 'TEHNOLOGICHESK. ' PUT 'OBRABOTKI '
WRITE C
PUT 'V ' PUT 'CIKLE ' PUT 'AVTOKOREKCII ' PUT 'FREZ ' PUT 'INSTR ' PUT 'PO ' PUT 'IZM. ' PUT 'RENISHAW ' PUT '-> OCRS '
WRITE C
GOTO NPA33

NPA5
PUT 'DO ' PUT 'NACHALA ' PUT 'OBRABOTKI '
WRITE C
PUT 'CIKL ' PUT 'TEORETICHESKOGO ' PUT 'POLOGENIJA ' PUT 'NULEVOI ' PUT 'TOCHKI ' PUT '-> OFFS '
WRITE C
GOTO NPA33

NPA6
PUT '************** ' PUT '!!! OPASNO !!! ' PUT '************** '
WRITE C
PUT 'POSLE ' PUT 'TEHNOLOGICHESK. ' PUT 'OBRABOTKI ' PUT 'DIAMETRA '
WRITE C
PUT 'V ' PUT 'CIKLE ' PUT 'AVTOKOREKCII ' PUT 'DANDREA ' PUT 'PO ' PUT 'IZM. ' PUT 'RENISHAW ' PUT '-> ORW '
WRITE C
GOTO NPA33

NPA7
PUT 'DO ' PUT 'NACHALA ' PUT 'OBRABOTKI ' PUT 'V ' PUT 'CIKLE ' PUT '-> OBACK '
WRITE C
PUT 'CIKL ' PUT 'KOMPENSACII ' PUT 'LUFTA ' PUT 'DANDREA ' PUT 'IZ ' PUT 'KOR. ' PUT '*HC* ' PUT '-> OBACK '
WRITE C
GOTO NPA33

NPA8
PUT 'DO ' PUT 'NACHALA ' PUT 'OBRABOTKI ' PUT 'V ' PUT 'CIKLE ' PUT 'AVTOPRIVJAZKI ' PUT 'NUL. TOCHKI '
WRITE C
PUT 'CIKL ' PUT 'KINEMATICHESKOi ' PUT 'TRANSFORMACII ' PUT 'NULEVOI ' PUT 'TOCHKI ' PUT '-> OMCS '
WRITE C
GOTO NPA33

NPA9
PUT 'CIKL ' PUT 'VIRAVNIVANIJA ' PUT 'UGLA ' PUT 'STOLA ' PUT '-> ORB '
WRITE C
GOTO NPA33

NPA10
PUT 'PRIVJAZKA ' PUT 'K ' PUT 'DETALI ' PUT '-> ORPA '
WRITE C
GOTO NPA33

NPA11
PUT 'PROCEDURA ' PUT 'SMENI ' PUT 'PALLET ' PUT '-> PALLETCHG '
WRITE C
GOTO NPA33

NPA12
PUT 'ZAPUSK ' PUT 'CHEREZ ' PUT 'FASTEMS '
WRITE C
GOTO NPA33

NPA33
IF [PA EQ 0] GOTO NP0 (PALLETCHG, TIHIi REGIM, OBNOVLENIE VREMJA)
IF [PA EQ 200] GOTO NP200 (PALLETCHG, smena pallet)

IF [PA EQ 301] GOTO NP301 (OKFR, ZAFIKSIROVAT ZAPOMNIT VISOTU VIDVIGENIJA BLUMA PRI POMOSHI RENISHAW)
IF [PA EQ 302] GOTO NP302 (OKPR, PROVERIT VISOTU VIDVIGENIJA BLUMA PRI POMOSHI RENISHAW)
IF [PA EQ 303] GOTO NP303 (OPKLS, PROMIVKA i PRODUVKA ETALONA DLINNI INSTRUMENTA PRI POMOSHI BLUMA)
IF [PA EQ 304] GOTO NP304 (OPKLW, PRODUVKA ETALONA DLINNI INSTRUMENTA PRI POMOSHI BLUMA)
IF [PA EQ 503] GOTO NP503 (OPKLS, NEPRAVILNIE VHODNIE DANNIE -PETN)
IF [PA EQ 504] GOTO NP504 (OPKLW, NEPRAVILNIE VHODNIE DANNIE -PETN)
IF [PA EQ 305] GOTO NP305 (OPKW, PRODUVKA BLUMA PRI POMOSHI PRODUVOCHNOGO INSTRUMENTA T996)
IF [PA EQ 306] GOTO NP306 (OPRQ, PROVERKA BIENIJA RENISHAW V SHPINDELE PRI POMOSHI BLUMA)
IF [PA EQ 307] GOTO NP307 (OPRW, PRODUVKA SHARIKA RENISHAW PRI POMOSHI BLUMA)
IF [PA EQ 308] GOTO NP308 (OPWW, PRODUVKA KRISHKI BLUMA PRI POMOSHI PRODUVOCHNOGO INSTRUMENTA T996, PERE-OTKR KR BLUMA)
IF [PA EQ 309] GOTO NP309 (OEBS, PROVERKA BIENIJA SHPINDELJA PRI POMOSHI ETALONA DLINI INSTRUMENTA I BLUMA)
IF [PA EQ 310] GOTO NP310 (OKKP, PROVERKA KALIB BLUMA NA PRAVILNOST POKAZANII po Z i po Y pri POMOSHI ETAL DLINI INSTR)
IF [PA EQ 311] GOTO NP311 (OKK, KALIB BLUMA po Z i po Y s ZANESENIEM REZULTATOV KALIB PRI POMOSHI ETAL DLINNI INSTR)
IF [PA EQ 312] GOTO NP312 (OPRMV, UNIVERSALNAJA PROMIVKA PALLETi S ZAGATOI DETALU, PROPUSTIT PROMIVKU)
IF [PA EQ 313] GOTO NP313 (OPRMV, UNIVERSALNAJA PROMIVKA PALLETi S ZAGATOI DETALU, PROMIT)
IF [PA EQ 314] GOTO NP314 (OTTT, PERE-VIZOV INSTRUMENTA DLJA POPITKI PRODUVKI KONUSA INSTRUMENTA)
IF [PA EQ 315] GOTO NP315 (OSKS, PROCEDURA KALIBROVKI STANKA PROVERKA NA KAGDIE SUTKI)
IF [PA EQ 316] GOTO NP316 (OHHE, OBNULIT NULEVIE TOCHKI S No.1 po No.20)
IF [PA EQ 317] GOTO NP317 (OTSTA, PROV NA POVTOR IZM INSTR PO DIAM PRI POMOSHI ETAL DLINI INSTR I BLUMA)
IF [PA EQ 318] GOTO NP318 (OTSTB, PROV NA POVTOR IZM INSTR PO DIAM PRI POMOSHI ETAL DLINI INSTR I BLUMA,SPOSOB - PERE-OT KR)
IF [PA EQ 319] GOTO NP319 (OTSTC, PROV NA POVTOR IZM INSTR PO DIAM PRI POMOSHI ETAL DLINI INSTR I BLUMA,SPOSOB - PERE-VIZ INSTR)
IF [PA EQ 320] GOTO NP320 (OPRWA, PRODUVKA RENISHAW PO VSEI DLINNE PRI POMOSHI BLUMA)
IF [PA EQ 321] GOTO NP321 (OPRWB, PROMIVKA i PRODUVKA RENISHAW PO VSEI DLINNE PRI POMOSHI BLUMA)
IF [PA EQ 322] GOTO NP322 (OAPH, CHEREZ PODPROGRAMMU AVTO-PRIVJAZKI ZAPRESHENO SBRASIVAT POLOGENIE NA STOLE)
IF [PA EQ 323] GOTO NP323 (OAPH, NE VERNO UKAZAN NOMER PALLETI)
IF [PA EQ 324] GOTO NP324 (OAPH, NE VERNO UKAZANO POLOGENIE NA STOLE)
IF [PA EQ 325] GOTO NP325 (OAPH, SOOBSHENIE OB AVTO-PRIVJAZKE)
IF [PA EQ 326] GOTO NP326 (OCRR, CALIBROVKA RENISHAW PO KOLCU D50 NA KOLLONNE)
IF [PA EQ 327] GOTO NP327 (OFOS,OFOU, VIVOD OSHIBKI NA FASTEMS-OSTANOVKA STANKA DLJA SNJATIJA STRUGKI S INSTRUMENTA)

IF [PA EQ 61] GOTO NP61 (ORB, POPITKA REALIZOVAT AVTOPRIVJAZKU NE IZ TOCHKI No.1 , PAL. ZABL.)
IF [PA EQ 57] GOTO NP57 (OBACK, SLISHKOM BOLSHAJA KOMPENSACIJA LUFTA V KORRECTORE *HC* NA DANDREA, INSTR. ZABL.)
IF [PA EQ 201] GOTO NP201 (ORW, ISTORIJA AVTOKORECCII PRI IZMERENII OTVERSTIJA RENISHAW + DANDREA)
IF [PA EQ 204] GOTO NP204 (ORW, NE D'ANDREA IN SPINDLE)
IF [PA EQ 56] GOTO NP56 (ORW, SLISHKOM BOLSHAJA KORECCIJA PRI IZMERENII OTV RENISHAW + DANDREA, INSTR. ZABL., PALLETA ZABL.)
IF [PA EQ 39] GOTO NP39 (OFFS, POPITKA PEREZAPISAT TEORETICHESKOE POLOGENIE NULEVOI TOCHKI NE V TOCHKU No.1, PALLETA ZABL)
IF [PA EQ 58] GOTO NP58 (OMCS, POPITKA REALIZOVAT AVTOPRIVJAZKU NE IZ TOCHKI No.1 , PAL. ZABL.)

IF [PA EQ 1] GOTO NP1   (OCTS, NET PODHODJASHEGO INSTRUMENTA, PALLETA ZABLOKIROVANA)
IF [PA EQ 2] GOTO NP2   (OTOSD, NA INSTRUMENTE OBNARUGENO BIENIE PO DIAMETRU, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 3] GOTO NP3   (OTOSD, POLOMKA INSTRUMENTA PO DIAMETRU, INSTRUMENT ZABLOKIROVAN, PALLETA ZABLOKIROVANA)
IF [PA EQ 4] GOTO NP4   (OTOSD, POLOMKA INSTRUMENTA PO DIAMETRU, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 5] GOTO NP5   (OTOSD, IZNOS INSTRUMENTA PO DIAMETRU, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 6] GOTO NP6   (OTOSD, NA NOVOM INSTRUMENTE OBNARUGENO BIENIE PO DIAMETRU, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 7] GOTO NP7   (OTOSD, NA NOVOM INSTRUMENTE PREVISHEN DOPUSK OPTIKI PO DIAMETRU, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 8] GOTO NP8   (OTOSD, NA NOVOM INSTRUMENTE PREVISHEN DOPUSK OPTIKI PO DIAMETRU, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 9] GOTO NP9   (OTOSD, NA NOVOM INSTRUMENTE PREVISHEN DOPUSK OPTIKI PO DIAMETRU, INSTRUMENT ZABLOKIROVAN, PALLETA ZABL)
IF [PA EQ 10] GOTO NP10 (OTOSD, NA NOVOM INSTRUMENTE PREVISHEN DOPUSK OPTIKI PO DIAMETRU, INSTRUMENT ZABLOKIROVAN)

IF [PA EQ 60] GOTO NP60 (OTOSL, V PROGRAMME NE VERNO UKAZAN SPOSOB IZMERENIJA INSTRUMENTA, PAL. ZABL.)
IF [PA EQ 502] GOTO NP502 (OTOSL, UKAZAN NEPRAVILNI KORRECTOR PH, INSTRUMENT ZABLOKIROVAN)

IF [PA EQ 13] GOTO NP13 (OTOSL, NA INSTRUMENTE OBNARUGENO BIENIE PO DLINNE, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 14] GOTO NP14 (OTOSL, POLOMKA INSTRUMENTA PO DLINNE, INSTRUMENT ZABLOKIROVAN, PALLETA ZABLOKIROVANA)
IF [PA EQ 15] GOTO NP15 (OTOSL, POLOMKA INSTRUMENTA PO DLINNE, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 16] GOTO NP16 (OTOSL, IZNOS INSTRUMENTA PO DLINNE, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 17] GOTO NP17 (OTOSL, NA NOVOM INSTRUMENTE OBNARUGENO BIENIE PO DLINNE, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 18] GOTO NP18 (OTOSL, NA NOVOM INSTRUMENTE PREVISHEN DOPUSK OPTIKI PO DLINNE, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 19] GOTO NP19 (OTOSL, NA NOVOM INSTRUMENTE PREVISHEN DOPUSK OPTIKI PO DLINNE, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 20] GOTO NP20 (OTOSL, NA NOVOM INSTRUMENTE PREVISHEN DOPUSK OPTIKI PO DLINNE, INSTRUMENT ZABLOKIROVAN, PALLETA ZABL)
IF [PA EQ 21] GOTO NP21 (OTOSL, NA NOVOM INSTRUMENTE PREVISHEN DOPUSK OPTIKI PO DLINNE, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 62] GOTO NP62 (OTOSL, INSTRUMENT NE KOSNULSJA LUCHA BLUMA, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 63] GOTO NP63 (OTOSL, INSTRUMENT NE KOSNULSJA LUCH BLUMA, INSTRUMENT ZABLOKIROVAN, PALLETA ZABLOKIROVANA)

IF [PA EQ 22] GOTO NP22 (NU1,OTOSL, V TABLICE NE UKAZANA DLINA DANDREA, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 23] GOTO NP23 (NU1,OTOSL, V TABLICE NE UKAZAN DIAMETR DANDREA, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 38] GOTO NP38 (NU1,OTOSL, V TABLICE UKAZAN SLISHKOM BOLSHOI UGOL ORIENTACII PERVOGO ZUBA DLJA DANDREA, INSTRUMENT ZABL)
IF [PA EQ 59] GOTO NP59 (NU1,OTOSL, V PROGRAMME NE VERNO UKAZAN KORECTOR NA DLINNU INSTRUMENTA, PAL. ZABL.)

IF [PA EQ 24] GOTO NP24 (NU1,OTOSL, IZNOS DANDREA PO DLINNE, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 25] GOTO NP25 (NU1,OTOSL, POLOMKA DANDREA PO DLINNE, INSTRUMENT ZABLOKIROVAN, PALLETA ZABLOKIROVANA)
IF [PA EQ 26] GOTO NP26 (NU1,OTOSL, POLOMKA DANDREA PO DLINNE, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 27] GOTO NP27 (NU1,OTOSL, NA NOVOM DANDREA PREVISHEN DOPUSK OPTIKI PO DLINNE, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 28] GOTO NP28 (NU1,OTOSL, NA NOVOM DANDREA PREVISHEN DOPUSK OPTIKI PO DLINNE, INSTRUMENT ZABLOKIROVAN, PALLETA ZABLO)
IF [PA EQ 29] GOTO NP29 (NU1,OTOSL, NA NOVOM DANDREA PREVISHEN DOPUSK OPTIKI PO DLINNE, INSTRUMENT ZABLOKIROVAN)

IF [PA EQ 30] GOTO NP30 (NXT77,OTOSL, IZNOS DANDREA PO DIAMETRU, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 31] GOTO NP31 (NXT77,OTOSL, POLOMKA DANDREA PO DIAMETRU, INSTRUMENT ZABLOKIROVAN, PALLETA ZABLOKIROVANA)
IF [PA EQ 32] GOTO NP32 (NXT77,OTOSL, POLOMKA DANDREA PO DIAMETRU, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 33] GOTO NP33 (NXT77,OTOSL, NA NOVOM DANDREA PREVISHEN DOPUSK OPTIKI PO DIAMETRU, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 34] GOTO NP34 (NXT77,OTOSL, NA NOVOM DANDREA PREVISHEN DOPUSK OPTIKI PO DIAMETRU, INSTRUMENT ZABLOKIROVAN, PALLETA ZABL)
IF [PA EQ 35] GOTO NP35 (NXT77,OTOSL, NA NOVOM DANDREA PREVISHEN DOPUSK OPTIKI PO DIAMETRU, INSTRUMENT ZABLOKIROVAN)
IF [PA EQ 203] GOTO NP203 (NXT77,OTOSL, FAKT IZNOS POSLE CHIST TOCHENIJA) 

IF [PA EQ 36] GOTO NP36 (OCRS, PREVISHENA KONUSNOST OTVERSTIJA PRI IZMERENII RENISHAW, INSTRUMENT ZABLOKIROVAN, PALLETA ZABLOKIROVANA)
IF [PA EQ 47] GOTO NP47 (OCRS, BOLSHAJA KORECCIJA PRI IZMERENII OTVERSTIJA RENISHAW, INSTR. ZABL., PALLETA ZABL.)

IF [PA EQ 40] GOTO NP40 (OCRS, PREVISHENA KONUSNOST BOBISHKI PRI IZMERENII RENISHAW, INSTRUMENT ZABLOKIROVAN, PALLETA ZABLOKIROVANA)
IF [PA EQ 48] GOTO NP48 (OCRS, BOLSHAJA KORECCIJA PRI IZMERENII BOBISHKI RENISHAW, INSTR. ZABL., PALLETA ZABL.)

IF [PA EQ 41] GOTO NP41 (OCRS, PREVISHENA KONUSNOST PAZA PRI IZMERENII RENISHAW VDOL OSI X, INSTRUMENT ZABLOKIROVAN, PALLETA ZABL)
IF [PA EQ 49] GOTO NP49 (OCRS, BOLSHAJA KORECCIJA PRI IZMERENII PAZA PO X RENISHAW, INSTR. ZABL., PALLETA ZABL.)

IF [PA EQ 42] GOTO NP42 (OCRS, PREVISHENA KONUSNOST VISTUPA PRI IZMERENII RENISHAW VDOL OSI X, INSTRUMENT ZABLOKIROVAN, PALLETA ZABL)
IF [PA EQ 50] GOTO NP50 (OCRS, BOLSHAJA KORECCIJA PRI IZMERENII VISTUPA PO X RENISHAW, INSTR. ZABL., PALLETA ZABL.)

IF [PA EQ 43] GOTO NP43 (OCRS, PREVISHENA KONUSNOST PAZA PRI IZMERENII RENISHAW VDOL OSI Y, INSTRUMENT ZABLOKIROVAN, PALLETA ZABL)
IF [PA EQ 51] GOTO NP51 (OCRS, BOLSHAJA KORECCIJA PRI IZMERENII PAZA PO Y RENISHAW, INSTR. ZABL., PALLETA ZABL.)

IF [PA EQ 44] GOTO NP44 (OCRS, PREVISHENA KONUSNOST VISTUPA PRI IZMERENII RENISHAW VDOL OSI Y, INSTRUMENT ZABLOKIROVAN, PALLETA ZABL)
IF [PA EQ 52] GOTO NP52 (OCRS, BOLSHAJA KORECCIJA PRI IZMERENII VISTUPA PO Y RENISHAW, INSTR. ZABL., PALLETA ZABL.)

IF [PA EQ 45] GOTO NP45 (OCRS, PREVISHENA KONUSNOST STENKI PRI IZMERENII RENISHAW VDOL OSI X, INSTRUMENT ZABLOKIROVAN, PALLETA ZABL)
IF [PA EQ 53] GOTO NP53 (OCRS, BOLSHAJA KORECCIJA PRI IZMERENII RENISHAW STENKI PO X, INSTR. ZABL., PALLETA ZABL.)

IF [PA EQ 46] GOTO NP46 (OCRS, PREVISHENA KONUSNOST STENKI PRI IZMERENII RENISHAW VDOL OSI Y, INSTRUMENT ZABLOKIROVAN, PALLETA ZABL)
IF [PA EQ 54] GOTO NP54 (OCRS, BOLSHAJA KORECCIJA PRI IZMERENII RENISHAW STENKI PO Y, INSTR. ZABL., PALLETA ZABL.)

IF [PA EQ 55] GOTO NP55 (OCRS, BOLSHAJA KORECCIJA PRI IZMERENII RENISHAW PLOSKOSTI PO Z, INSTR. ZABL., PALLETA ZABL.)

IF [PA EQ 64] GOTO NP64 (OMEAS, PRI IZMERENII OTRICATEL'NII DIAMETR, INSTR. ZABL., PALLETA ZABL.)
IF [PA EQ 37] GOTO NP37 (OCRS, NE VOZMOGNO ISPOLSOVAT ETOT VID IZMERENIJA RENISHAW V PARE S DANDREA, PALLETA ZABLOKIROVANA)
IF [PA EQ 202] GOTO NP202 (OCRS, VELICHINA AVTOKOREKCII FREZI PRI IZMERENII RENISHAW)
IF [PA EQ 501] GOTO NP501 (-OCRS-, NEPRAVILNIE VHODNIE DANNIE PH)
GOTO NEND

NP0
GOTO NEND

NP200
IF [VC292 GT 0] GOTO NXT47
PUT 'SMENA ' PUT 'NEIZVESTNOi ' PUT 'PALLETI ' PUT 'CHEREZ ' PUT 'FASTEMS '
WRITE C
GOTO NEND
NXT47
PUT '# ' PUT 'PALLETA ' PUT 'No. =' PUT VC292 PUT '  UEHALA ' PUT 'V ' PUT 'SKLAD '
WRITE C
GOTO NEND

NP301
PUT '# ' PUT 'ZAPOMINANIE ' PUT 'VISOTI ' PUT 'VIDV. ' PUT 'BLUMA ' PUT 'Y=' PUT VC288
WRITE C
GOTO NEND

NP302
PUT '# ' PUT 'PROVERKA ' PUT 'VISOTI ' PUT 'VIDVIGENIJA ' PUT 'BLUMA ' 
WRITE C
PUT 'NEW VISOTA ' PUT 'Y=' PUT VC288 PUT '  IZM. ' PUT 'RAZNICA=' PUT PVKP
WRITE C
IF [VOK1 GE 1] GOTO NXT42
GOTO NEND
NXT42
PUT '###### ' PUT 'REZULTAT= ' PUT 'NE ' PUT 'V ' PUT 'DOPUSKE '
WRITE C
PUT 'DOPUSK= ' PUT PRQK
WRITE C
GOTO NEND

NP303
IF [PETN EQ 1] GOTO NP3031
GOTO NP3032
NP3031
PUT 'PROMIVKA ' PUT 'i ' PUT 'PRODUVKA ' PUT 'ETALONA ' PUT 'INSTR. ' PUT 'BLUM'
WRITE C
GOTO NEND
NP3032
PUT 'PROMIVKA ' PUT 'i ' PUT 'PRODUVKA ' PUT 'ETALONA ' PUT 'INSTR. ' PUT 'MC2'
WRITE C
GOTO NEND

NP503
CALL OPTF PTOL=0
PUT 'WRONG ' PUT 'INPUT ' PUT 'DATA ' PUT 'OPKLS ' PUT ' PETN '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
PUT 'TOOL=' PUT VC900 PUT '  GROUP=' PUT VTLGN[VTLCN]
WRITE C
GOTO NEND

NP304
IF [PETN EQ 1] GOTO NP3041
GOTO NP3042
NP3041
PUT 'PRODUVKA ' PUT 'ETALONA ' PUT 'INSTR. ' PUT 'BLUM'
WRITE C
GOTO NEND
NP3042
PUT 'PRODUVKA ' PUT 'ETALONA ' PUT 'INSTR. ' PUT 'MC2'
WRITE C
GOTO NEND

NP504
CALL OPTF PTOL=0
PUT 'WRONG ' PUT 'INPUT ' PUT 'DATA ' PUT 'OPKLW ' PUT ' PETN '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
PUT 'TOOL=' PUT VC900 PUT '  GROUP=' PUT VTLGN[VTLCN]
WRITE C
GOTO NEND

NP305
PUT 'PRODUVKA ' PUT 'BLUMA ' PUT 'T996 '
WRITE C
GOTO NEND

NP306
PUT '# ' PUT 'PROVERKA ' PUT 'BIENIJA ' PUT 'RENISHAW '
WRITE C
PUT '-X ' PUT 'TABL.=' PUT VSTOD[2] PUT '  FAKT.=' PUT PRF4 PUT '  RAZN.=' PUT PRQ4
WRITE C
PUT '+X ' PUT 'TABL.=' PUT VSTOD[1] PUT '  FAKT.=' PUT PRF2 PUT '  RAZN.=' PUT PRQ2
WRITE C
PUT '-Y ' PUT 'TABL.=' PUT VSTOD[4] PUT '  FAKT.=' PUT PRF1 PUT '  RAZN.=' PUT PRQ1
WRITE C
PUT '+Y ' PUT 'TABL.=' PUT VSTOD[3] PUT '  FAKT.=' PUT PRF3 PUT '  RAZN.=' PUT PRQ3
WRITE C
PUT 'CENTR ' PUT 'X=' PUT PRCX PUT '  CENTR ' PUT 'Y=' PUT PRCY
WRITE C
IF [VOK1 GE 1] GOTO NXT43
GOTO NEND
NXT43
PUT '###### ' PUT 'REZULTAT= ' PUT 'NE ' PUT 'V ' PUT 'DOPUSKE '
WRITE C
PUT 'DOPUSK=' PUT PRRQ
WRITE C
GOTO NEND

NP307
PUT 'PRODUVKA ' PUT 'SHARIKA ' PUT 'RENISHAW '
WRITE C
GOTO NEND

NP308
PUT 'PERE-OTKRITIE ' PUT 'KRISHKI ' PUT 'BLUMA ' PUT '-PRODUVKA'
WRITE C
GOTO NEND

NP309
CALL OPPOT PTG=998 PTS=1

PUT '# ' PUT 'PROVERKA ' PUT 'BIENIJA ' PUT 'SHPINDELJA '
WRITE C
IF [VC100 NE 0] GOTO NEZN9
PD4=PD1-PD3

PUT 'RADIUS ' PUT 'IZ ' PUT 'TABL.=' PUT VTOD3[VC903] 
WRITE C
PUT 'MIN. =' PUT PD3 PUT '  MAX. =' PUT PD1 PUT '  BIENIE=' PUT PD4
WRITE C
PUT 'X ' PUT 'GRAD 90 =' PUT PBK3 PUT '  GRAD 270=' PUT PBK7 PUT '  RAZN.=' PUT VC13
WRITE C
PUT 'Y ' PUT 'GRAD 0  =' PUT PBK1 PUT '  GRAD 180=' PUT PBK5 PUT '  RAZN.=' PUT VC11
WRITE C
PUT '/ ' PUT 'GRAD 135=' PUT PBK4 PUT '  GRAD 315=' PUT PBK8 PUT '  RAZN.=' PUT VC14
WRITE C
PUT '\ ' PUT 'GRAD 45 =' PUT PBK2 PUT '  GRAD 225=' PUT PBK6 PUT '  RAZN.=' PUT VC12
WRITE C
IF [VOK1 GE 1] GOTO NXT44
GOTO NEND
NXT44
PUT '###### ' PUT 'REZULTAT= ' PUT 'NE ' PUT 'V ' PUT 'DOPUSKE '
WRITE C
PUT 'DOPUSK=' PUT PKBQ
WRITE C
GOTO NEND

NEZN9
PUT 'ZAMER ' PUT 'NE ' PUT 'PROIZVEDEN '
WRITE C
PUT 'OSHIBKA ' PUT 'BLUM= ' PUT VC100
WRITE C
GOTO NEND

NP310
PUT '# ' PUT 'PROVERKA ' PUT 'BLUMA ' PUT 'PO ' PUT 'ETALONU ' PUT 'INSTR. '
CALL OPPOT PTG=998 PTS=1
WRITE C
PUT 'DLINA  ' PUT 'ETALONA=' PUT VTOH3[VC903] PUT '  IZM.=' PUT VTOFH[VC903] PUT '  RAZN.=' PUT PKLK
WRITE C
PUT 'DIAMETR ' PUT 'ETALONA=' PUT VTOD3[VC903] PUT '  IZM.=' PUT VTOFD[VC903] PUT '  RAZN.=' PUT PKDK
WRITE C
IF [VC100 NE 0] GOTO NEZN
IF [VOK1 GE 1] GOTO NXT45
GOTO NEND
NXT45
PUT 'REZULTAT= ' PUT 'NE ' PUT 'V ' PUT 'DOPUSKE '
WRITE C
PUT 'DOPUSK=' PUT PKKQ
WRITE C
GOTO NEND

NEZN
PUT 'ZAMER ' PUT 'NE ' PUT 'PROIZVEDEN '
WRITE C
PUT 'OSHIBKA ' PUT 'BLUM= ' PUT VC100
WRITE C
GOTO NEND

NP311
CALL OPPOT PTG=995 PTS=0
PUT '# ' PUT 'KALIBROVKA ' PUT 'BLUMA ' PUT 'T995 '
WRITE C
PUT 'TABL: ' PUT 'DLIN.=' PUT VTOH3[VC903] PUT '  DIAM. ' PUT VTOD3[VC903]
WRITE C
PUT 'X=' PUT VC105 PUT ' Y=' PUT VC95 PUT '  Z=' PUT VC94
WRITE C
IF [VC94 GT [VSZOZ[2]+0.01]] GOTO NEK1
IF [VC94 LT [VSZOZ[2]-0.01]] GOTO NEK1
IF [VC95 GT [VSZOY[2]+0.01]] GOTO NEK1
IF [VC95 LT [VSZOY[2]-0.01]] GOTO NEK1
GOTO NEND
NEK1
PUT 'KALIBROVKA ' PUT 'BLUMA ' PUT 'PREVISILA ' PUT 'OTKLONENIE ' PUT 'V ' PUT '0.01 MM'
VSZOZ[2]=VC94
VSZOY[2]=VC95
GOTO NEND

NP312
PUT 'PROPUSK ' PUT 'PROMIVKI ' PUT 'PALLET ' PUT 'NAGATA ' PUT 'KNOPKA ' PUT '/SKiP '
WRITE C
GOTO NEND

NP313
PUT 'ZAVERSHENIE ' PUT 'PROMIVKI ' PUT 'PALLET '
WRITE C
GOTO NEND

NP314
PUT 'PERE-VIZOV ' PUT 'INSTR. ' PUT 'POPITKA ' PUT 'PROCHISTIT ' PUT 'KONUS '
WRITE C
GOTO NEND

NP315
PUT 'ZAVERSHENIE ' PUT 'KALIBROVKI ' PUT 'STANKA ' 
WRITE C
GOTO NEND

NP316
PUT 'OBNULENIE ' PUT 'NULEVIH ' PUT 'TOCHEK '
WRITE C
GOTO NEND

NP317
PUT '# ' PUT 'PROV. ' PUT 'POVTOR. ' PUT 'ZAMERA ' PUT 'PROSTOi ' PUT 'SPOSOB '
WRITE C
IF [VC100 NE 0] GOTO NZN17
PUT 'RAD. ' PUT 'TABL.=' PUT PDT PUT '  MIN.=' PUT PD3 PUT '  MAX.=' PUT PD1
WRITE C
PD4=PD1-PD3
PUT 'RAZBROS ' PUT 'ZAMEROV=' PUT PD4
WRITE C
PUT 'ZAMER ' PUT 'No.1=' PUT PBK1
WRITE C
PUT 'ZAMER ' PUT 'No.2=' PUT PBK2
WRITE C
PUT 'ZAMER ' PUT 'No.3=' PUT PBK3
WRITE C
PUT 'ZAMER ' PUT 'No.4=' PUT PBK4
WRITE C
PUT 'ZAMER ' PUT 'No.5=' PUT PBK5
WRITE C
PUT 'ZAMER ' PUT 'No.6=' PUT PBK6
WRITE C
PUT 'ZAMER ' PUT 'No.7=' PUT PBK7
WRITE C
PUT 'ZAMER ' PUT 'No.8=' PUT PBK8
WRITE C
IF [VOK1 GE 1] GOTO NXT46
GOTO NEND
NXT46
PUT '###### ' PUT 'REZULTAT= ' PUT 'NE ' PUT 'V ' PUT 'DOPUSKE '
WRITE C
PUT 'DOPUSK=' PUT PKBQ
WRITE C
GOTO NEND
NZN17
PUT 'ZAMER ' PUT 'NE ' PUT 'PROIZVEDEN '
WRITE C
PUT 'OSHIBKA ' PUT 'BLUM= ' PUT VC100
WRITE C
GOTO NEND

NP318
PUT '# ' PUT 'PROV. ' PUT 'POVTOR. ' PUT 'ZAMER. ' PUT 'SPOSOB ' PUT 'PERE-OTKR. ' PUT 'KRISHKI '
WRITE C
IF [VC100 NE 0] NZN18
PUT 'RAD. ' PUT 'TABL.=' PUT PDT PUT '  MIN.=' PUT PD3 PUT '  MAX.=' PUT PD1
WRITE C
PD4=PD1-PD3
PUT 'RAZBROS ' PUT 'ZAMEROV=' PUT PD4
WRITE C
PUT 'ZAMER ' PUT 'No.1=' PUT PBK1
WRITE C
PUT 'ZAMER ' PUT 'No.2=' PUT PBK2
WRITE C
PUT 'ZAMER ' PUT 'No.3=' PUT PBK3
WRITE C
PUT 'ZAMER ' PUT 'No.4=' PUT PBK4
WRITE C
PUT 'ZAMER ' PUT 'No.5=' PUT PBK5
WRITE C
PUT 'ZAMER ' PUT 'No.6=' PUT PBK6
WRITE C
PUT 'ZAMER ' PUT 'No.7=' PUT PBK7
WRITE C
PUT 'ZAMER ' PUT 'No.8=' PUT PBK8
WRITE C
IF [VOK1 GE 1] GOTO NXT46
GOTO NEND
NXT46
PUT '###### ' PUT 'REZULTAT= ' PUT 'NE ' PUT 'V ' PUT 'DOPUSKE '
WRITE C
PUT 'DOPUSK=' PUT PKBQ
WRITE C
GOTO NEND
NZN18
PUT 'ZAMER ' PUT 'NE ' PUT 'PROIZVEDEN '
WRITE C
PUT 'OSHIBKA ' PUT 'BLUM= ' PUT VC100
WRITE C
GOTO NEND

NP319
PUT '# ' PUT 'PROV. ' PUT 'POVTOR. ' PUT 'ZAMER. ' PUT 'SPOSOB ' PUT 'PERE-VIZOV ' PUT 'INSTR. '
WRITE C
IF [VC100 NE 0] NZN19
PUT 'RAD. ' PUT 'TABL.=' PUT PDT PUT '  MIN.=' PUT PD3 PUT '  MAX.=' PUT PD1
WRITE C
PD4=PD1-PD3
PUT 'RAZBROS ' PUT 'ZAMEROV=' PUT PD4
WRITE C
PUT 'ZAMER ' PUT 'No.1=' PUT PBK1
WRITE C
PUT 'ZAMER ' PUT 'No.2=' PUT PBK2
WRITE C
PUT 'ZAMER ' PUT 'No.3=' PUT PBK3
WRITE C
PUT 'ZAMER ' PUT 'No.4=' PUT PBK4
WRITE C
PUT 'ZAMER ' PUT 'No.5=' PUT PBK5
WRITE C
PUT 'ZAMER ' PUT 'No.6=' PUT PBK6
WRITE C
PUT 'ZAMER ' PUT 'No.7=' PUT PBK7
WRITE C
PUT 'ZAMER ' PUT 'No.8=' PUT PBK8
WRITE C
IF [VOK1 GE 1] GOTO NXT46
GOTO NEND
NXT46
PUT '###### ' PUT 'REZULTAT= ' PUT 'NE ' PUT 'V ' PUT 'DOPUSKE '
WRITE C
PUT 'DOPUSK=' PUT PKBQ
WRITE C
GOTO NEND
NZN19
PUT 'ZAMER ' PUT 'NE ' PUT 'PROIZVEDEN '
WRITE C
PUT 'OSHIBKA ' PUT 'BLUM= ' PUT VC100
WRITE C
GOTO NEND

NP320
PUT 'PRODUVKA ' PUT 'KORPUSA ' PUT 'RENISHAW '
WRITE C
GOTO NEND

NP321
PUT 'PROMIVKA ' PUT 'i ' PUT 'PRODUVKA ' PUT 'KORPUSA ' PUT 'RENISHAW '
WRITE C
GOTO NEND

NP322
PUT 'CHEREZ ' PUT 'POD-PROGR. ' PUT 'AVTO-PRIV. ' PUT 'ZAPRESHENO ' PUT 'SBRASIVAT ' PUT 'POLOG. ' PUT 'NA ' PUT 'STOLE '
WRITE C
PUT 'ZNACHENIE ' PUT 'PARAMETRA ' PUT 'POLOGENIE ' PUT 'NA ' PUT 'STOLE ' PUT PPB
WRITE C
PUT 'NOMER ' PUT 'PALLETI ' PUT PNPP
WRITE C
GOTO NEND

NP323
PUT 'NE ' PUT 'VERNO ' PUT 'UKAZAN ' PUT 'NOMER ' PUT 'PALLETI '
WRITE C
PUT 'POLOGENIE ' PUT 'NA ' PUT 'STOLE ' PUT PPB
WRITE C
PUT 'NOMER ' PUT 'PALLETI ' PUT PNPP
WRITE C
GOTO NEND

NP324
PUT 'NE ' PUT 'VERNO ' PUT 'UKAZANO ' PUT 'POLOGENIE ' PUT 'NA ' PUT 'STOLE '
WRITE C
PUT 'POLOGENIE ' PUT 'NA ' PUT 'STOLE ' PUT PPB
WRITE C
PUT 'NOMER ' PUT 'PALLETI ' PUT PNPP
WRITE C
GOTO NEND

NP325
PUT 'PALLETA ' PUT 'No.=' PUT PNPP PUT '  PRIEHALA ' PUT 'PO ' PUT 'ZAKAZU '
WRITE C
PUT 'POLOGENIE ' PUT 'KREPLENIJA ' PUT 'NA ' PUT 'STOLE=' PUT PPB
WRITE C
GOTO NEND

NP326
PUT 'KALIB ' PUT 'RENISHAW ' PUT 'PO ' PUT 'KOLCU ' PUT 'DIAM.=' PUT PDI
WRITE C
PUT 'DO    ' PUT 'KALIB. ' PUT 'DIAM.=' PUT VC15 PUT '  CEN.X=' PUT VC11 PUT '  CEN.Y=' PUT VC12
WRITE C
PUT 'POSLE ' PUT 'KALIB. ' PUT 'DIAM.=' PUT VC16 PUT '  CEN.X=' PUT VC13 PUT '  CEN.Y=' PUT VC14
WRITE C
GOTO NEND

NP327
IF[VC100 NE 0]GOTO NERR1
IF [PLQF EQ EMPTY] GOTO NEND
IF [VC282 EQ 2] GOTO NZT1
PUT 'OSTANOVKA ' PUT 'STANKA ' PUT 'DLJA ' PUT 'OCHISTKI ' PUT 'STRUGKI '
WRITE C
GOTO NUVER1

NZT1
PUT 'INSTRUMENT ' PUT 'ZABLOKIROVAN ' 
WRITE C

NUVER1
IF[VC967 LE 0] GOTO NP01
IF[VC968 GE VC967] GOTO NP01
IF[VC967 GE VC969] GOTO NP02
GOTO NP04

NP01 
IF[VC968 GE VC969] GOTO NP03
NP04 PUT 'REZKOE ' PUT 'UVELICHENIE ' PUT 'RADIUSA ' PUT 'NA=' PUT VSTOD[39] PUT ' MM '
WRITE C
GOTO NRUI1

NP02
PUT 'REZKOE ' PUT 'UVELICHENIE ' PUT 'DLINbI2 ' PUT 'NA=' PUT VSTOD[39] PUT ' MM '
WRITE C
GOTO NRUI1

NP03
PUT 'REZKOE ' PUT 'UVELICHENIE ' PUT 'DLINbI ' PUT 'NA=' PUT VSTOD[39] PUT ' MM '
WRITE C

NRUI1
IF[VTLGN[VTLCN] EQ 999] NEND
IF [VIRD[01138] EQ 1] NPTU1
GOTO NPTF1

NERR1
PUT 'OSHIBKA ' PUT 'BLUM ' PUT VC100
WRITE C
IF [VIRD[01138] EQ 1] NPTU1
GOTO NPTF1


NP61
PUT 'POPITKA ' PUT 'REALIZOVAT ' PUT 'AVTOPRIVJAZKU ' 
WRITE C
PUT 'NE ' PUT 'IZ ' PUT 'TOCHKI ' PUT 'No.' PUT PP
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
GOTO NEND

NP57
PUT 'POPITKA ' PUT 'KOMPENSIROVAT ' PUT 'LUFT ' PUT 'NA ' PUT 'DANDREA ' PUT 'IZ ' PUT 'KORREKTORA ' PUT '*HC* '
WRITE C
PUT 'MAKSIMALNIi ' PUT 'DOPUSK ' PUT 'KOMPENSACII ' PUT 'LUFTA ' PUT PTUQ
WRITE C
PUT 'INSTRUMENT ' PUT 'ZABLOKIROVAN '
WRITE C
GOTO NPTU1

NP56
PUT '***' PUT 'PREVISHEN ' PUT 'DOPUSK ' PUT 'AVTOKOREKCII ' PUT 'DANDREA '
WRITE C
PUT '***' PUT 'PRI ' PUT 'IZMERENII ' PUT 'OTVERSTIJA ' PUT'/BOBISHKA ' PUT 'RENISHAW '
WRITE C
PUT 'INSTRUMENT ' PUT 'ZABLOKIROVAN, ' PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
PUT 'POPITKA ' PUT 'AVTOKOREKCII ' PUT 'DANDREA ' PUT 'NA=' PUT PUQR PUT ' MM '
WRITE C
PUT 'DOPUSK ' PUT 'AVTOKOREKCII ' PUT 'DIAMETRA ' PUT 'DANDREA=' PUT PPUX PUT ' MM '
WRITE C
PUT 'T.DIAM. =' PUT PND
WRITE C

IF [PZOZ LE 0] GOTO NOTV11
PUT 'F.D.BOBISHKI =' PUT PIUF
WRITE C
GOTO NBOBI1

NOTV11
PUT 'F.D.3T  =' PUT PIUF PUT '  C.X.3T=' PUT PICX PUT '  C.Y.3T=' PUT PICY
WRITE C
PUT 'F.D.2T.X=' PUT VC15 PUT '  C.X.2T=' PUT VC11
WRITE C
PUT 'F.D.2T.Y=' PUT VC16 PUT '         ' PUT '          ' PUT '  C.Y.2T=' PUT VC14
WRITE C

NBOBI1
PUT 'RAZN.DIA=' PUT VC20 PUT '  R.cenX=' PUT VC17 PUT '  R.cenY=' PUT VC18
WRITE C
PUT 'GL.IZM. =' PUT PZOZ PUT '  GL.PR.=' PUT PBLZ PUT '  PR.INSTR.=' PUT PTP
WRITE C
PUT 'TOOL=' PUT PSTN PUT '  GROUP=' PUT PSTG
WRITE C
PSV1=VTWOH[PTL]
PSV2=VIU1[PTL]
PSV5=VIU3[PTL]
PSV6=VIU4[PTL]
VTWOH[PTL]=0
VIU1[PTL]=0
VIU3[PTL]=0
VIU4[PTL]=0
PSV3=VTOFH[PTL]
PSV4=VTOH2[PTL]
PSV7=VTOH3[PTL]
PSV8=VTOD3[PTL]
VTWOH[PTL]=PSV1
VIU1[PTL]=PSV2
VIU3[PTL]=PSV5
VIU4[PTL]=PSV6
PUT 'D=' PUT PSV3
PUT ' NOVIY ' PUT 'IZNOS=' PUT VTWOH[PTL]
WRITE C
PUT 'iZNACHALNIi ' PUT 'IZNOS=' PUT VC295
WRITE C
PUT 'POSLE TEHN  ' PUT 'IZNOS=' PUT VC294
WRITE C
IF [PSV7 EQ 0] GOTO NXT13
PUT 'ZNACHENIE ' PUT 'KOMPENSACII ' PUT 'LUFTA ' PUT 'NA ' PUT 'DIAMETR=' PUT PSV7
WRITE C

NXT13
IF [PSV8 EQ 0] GOTO NXT27
PUT 'UGOL ' PUT 'ORIENTACII ' PUT 'PERVOGO ' PUT 'ZUBA=' PUT PSV8
WRITE C

NXT27
PUT 'OST.=' PUT VTLD8[PTL] PUT ' MINUT  IZ=' PUT VTLD7[PTL] PUT '  OTR. V OP.=' PUT VC296
WRITE C
GOTO NEND

NP201
PUT 'AVTOKOREKCIJA ' PUT 'DIAMETRA ' PUT 'DANDREA ' PUT 'NA=' PUT PUQR PUT ' MM '
WRITE C
PUT 'T.DIAM. =' PUT PND
WRITE C
IF [PZOZ LE 0] GOTO NOTV1
PUT 'F.D.BOBISHKI =' PUT PIUF
WRITE C
GOTO NBOBI

NOTV1
PUT 'F.D.3T  =' PUT PIUF PUT '  C.X.3T=' PUT PICX PUT '  C.Y.3T=' PUT PICY
WRITE C
PUT 'F.D.2T.X=' PUT VC15 PUT '  C.X.2T=' PUT VC11
WRITE C
PUT 'F.D.2T.Y=' PUT VC16 PUT '         ' PUT '          ' PUT '  C.Y.2T=' PUT VC14
WRITE C

NBOBI
PUT 'RAZN.DIA=' PUT VC20 PUT '  R.cenX=' PUT VC17 PUT '  R.cenY=' PUT VC18
WRITE C
PUT 'GL.IZM. =' PUT PZOZ PUT '  GL.PR.=' PUT PBLZ PUT '  PR.INSTR.=' PUT PTP
WRITE C
PSV1=VTWOH[PTL]
PSV2=VIU1[PTL]
PSV5=VIU3[PTL]
PSV6=VIU4[PTL]
VTWOH[PTL]=0
VIU1[PTL]=0
VIU3[PTL]=0
VIU4[PTL]=0
PSV3=VTOFH[PTL]
PSV4=VTOH2[PTL]
PSV7=VTOH3[PTL]
PSV8=VTOD3[PTL]
VTWOH[PTL]=PSV1
VIU1[PTL]=PSV2
VIU3[PTL]=PSV5
VIU4[PTL]=PSV6
PUT 'TOOL=' PUT PSTN PUT '  GROUP=' PUT PSTG
WRITE C
IF [VC900 LT 9000000] GOTO NXT32
PUT 'ZNACHENIE ' PUT 'KOMPENSACII ' PUT 'LUFTA ' PUT 'NA ' PUT 'DIAMETR='
PUT VC[800+PTL]
WRITE C

NXT32
IF [PSV8 EQ 0] GOTO NXT33
PUT 'UGOL ' PUT 'ORIENTACII ' PUT 'PERVOGO ' PUT 'ZUBA=' PUT PSV8
WRITE C

NXT33
PUT 'OST.=' PUT VTLD8[PTL] PUT ' MINUT  IZ=' PUT VTLD7[PTL] PUT '  OTR. V OP.=' PUT VC296
WRITE C
PUT 'D=' PUT PSV3
WRITE C
PUT 'iZNACHALNIi ' PUT 'IZNOS=' PUT VC295
WRITE C
PUT 'POSLE TEHN  ' PUT 'IZNOS=' PUT VC294
WRITE C
PUT 'NEW AVTOKOR ' PUT 'IZNOS=' PUT PSV1
WRITE C
GOTO NEND

NP203
PUT 'POSLE CHIST ' PUT 'IZNOS=' PUT PDU5
WRITE C
GOTO NEND

NP204
PUT 'NE DANDREA ' PUT 'V SPINDELE' 
WRITE C
GOTO NEND

NP39
PUT '***' PUT 'POPITKA ' PUT 'PEREZAPISAT ' PUT 'TEORETICHESKOE ' PUT 'POLOGENIE '
WRITE C
PUT 'NULEVOI ' PUT 'TOCHKI ' PUT 'NE ' PUT 'V ' PUT 'TOCHKU ' PUT 'No.1 '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
GOTO NEND

NP58
PUT '***' PUT 'POPITKA ' PUT 'REALIZOVAT ' PUT 'AVTOPRIVJAZKU ' 
WRITE C
PUT 'IZ ' PUT 'TOCHKI ' PUT 'No.' PUT PMCS PUT '  V ' PUT 'TOCHKU '  PUT 'No.' PUT PP
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
GOTO NEND

NP1
PUT '***' PUT 'NET ' PUT 'PODHODJASHEGO ' PUT 'INSTRUMENTA ' PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
PUT 'GRUPPA ' PUT 'INSTRUMENTA='  PUT PTG
WRITE C
PUT 'NEOBHODIMIi ' PUT 'SROK ' PUT 'SLUGBI ' PUT 'INSTRUMENTA=' PUT PMIN
WRITE C
GOTO NEND

NP2
PUT '***' PUT 'INSTRUMENT ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'BIENIJA ' PUT 'DIAMETRA '
WRITE C
PUT 'MAX ' PUT 'RADIUS=' PUT PD1
WRITE C
PUT 'MIN ' PUT 'RADIUS=' PUT PD3
WRITE C
PUT 'FAKT. ' PUT 'BIENIE ' PUT 'DIAMETRA=' PUT PBBF
WRITE C
PUT 'DOPUSK ' PUT 'BIENIJA=' PUT PBO
WRITE C
GOTO NPTF1

NP3
PUT '***' PUT 'POLOMKA ' PUT 'INSTRUMENTA ' PUT 'PO ' PUT 'DIAMETRU '
WRITE C 
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
GOTO NPTF1

NP4
PUT '***' PUT 'POLOMKA ' PUT 'INSTRUMENTA ' PUT 'PO ' PUT 'DIAMETRU '
WRITE C 
GOTO NPTF1

NP5
PUT '***' PUT 'IZNOS ' PUT 'INSTRUMENTA ' PUT 'PO ' PUT 'DIAMETRU '
WRITE C 
GOTO NPTF1

NP6
PUT '***' PUT 'NOVIi ' PUT 'INSTR. ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'BIENIJA ' PUT 'DIAMETRA '
WRITE C
PUT 'MAX ' PUT 'RADIUS=' PUT PD1
WRITE C
PUT 'MIN ' PUT 'RADIUS=' PUT PD3
WRITE C
PUT 'FAKT. ' PUT 'BIENIE ' PUT 'DIAMETRA=' PUT PBBF
WRITE C
PUT 'DOPUSK ' PUT 'BIENIJA=' PUT PBO
WRITE C
GOTO NPTF1

NP7
PUT '***' PUT 'NOVIi ' PUT 'INSTRUMENT ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DIAMETRA '
WRITE C
GOTO NPTF1

NP8
PUT '***' PUT 'NOVIi ' PUT 'INSTRUMENT ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DIAMETRA '
WRITE C
GOTO NPTF1

NP9
PUT '***' PUT 'NOVIi ' PUT 'INSTRUMENT ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DIAMETRA '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
GOTO NPTF1

NP10
PUT '***' PUT 'NOVIi ' PUT 'INSTRUMENT ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DIAMETRA '
WRITE C
GOTO NPTF1

NP60
PUT '***' PUT 'V ' PUT 'PROGRAMME ' PUT 'NE ' PUT 'VERNO ' PUT 'UKAZAN '
WRITE C
PUT 'SPOSOB ' PUT 'IZMERENIJA ' PUT 'INSTRUMENTA '
WRITE C
IF [VIRD[01138] EQ 1] GOTO NXT19
GOTO NPTF1

NXT19
GOTO NPTU1

NP13
PUT '***' PUT 'INSTRUMENT ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'BIENIJA ' PUT 'DLINNI '
WRITE C
PUT 'MAX ' PUT 'DLINNA=' PUT PL1
WRITE C
PUT 'MIN ' PUT 'DLINNA=' PUT PL3
WRITE C
PUT 'FAKT. ' PUT 'BIENIE=' PUT PBBF
WRITE C
PUT 'DOPUSK ' PUT 'BIENIJA=' PUT PBO
WRITE C
GOTO NPTF1

NP14
PUT '***' PUT 'POLOMKA ' PUT 'INSTRUMENTA ' PUT 'PO ' PUT 'DLINNE '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
GOTO NPTF1

NP15
PUT '***' PUT 'POLOMKA ' PUT 'INSTRUMENTA ' PUT 'PO ' PUT 'DLINNE '
WRITE C
GOTO NPTF1

NP16
PUT '***' PUT 'IZNOS ' PUT 'INSTRUMENTA ' PUT 'PO ' PUT 'DLINNE '
WRITE C
GOTO NPTF1

NP17
PUT '***' PUT 'NOVIi ' PUT 'INSTR. ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'BIENIJA ' PUT 'DLINNI '
WRITE C
PUT 'MAX ' PUT 'DLINNA=' PUT PL1
WRITE C
PUT 'MIN ' PUT 'DLINNA=' PUT PL3
WRITE C
PUT 'FAKT. ' PUT 'BIENIE ' PUT 'DLINNI=' PUT PBBF
WRITE C
PUT 'DOPUSK ' PUT 'BIENIJA=' PUT PBO
WRITE C
GOTO NPTF1

NP18
PUT '***' PUT 'NOVIi ' PUT 'INSTRUMENT ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DLINNI '
WRITE C
GOTO NPTF1

NP19
PUT '***' PUT 'NOVIi ' PUT 'INSTRUMENT ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DLINNI '
WRITE C
GOTO NPTF1

NP20
PUT '***' PUT 'NOVIi ' PUT 'INSTRUMENT ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DLINNI '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
GOTO NPTF1

NP21
PUT '***' PUT 'NOVIi ' PUT 'INSTRUMENT ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DLINNI '
WRITE C
GOTO NPTF1

NP62
PUT '***' PUT 'INSTRUMENT ' PUT 'NE ' PUT 'KOSNULSJA ' PUT 'A '
WRITE C
PUT '***' PUT 'VOZMOGNO ' PUT 'NE ' PUT 'VERNO ' PUT 'UKAZANA ' PUT 'DLINNA '
WRITE C
GOTO NPTF1

NP63
PUT '***' PUT 'INSTRUMENT ' PUT 'NE ' PUT 'KOSNULSJA ' PUT 'A '
WRITE C
PUT '***' PUT 'POLOMKA ' PUT 'PO ' PUT 'DLINNE '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
GOTO NPTF1

NP22
PUT '***' PUT 'V ' PUT 'TABLICE ' PUT 'NE ' PUT 'UKAZANA ' PUT 'DLINNA ' PUT 'DANDREA '
WRITE C
GOTO NPTU1

NP23
PUT '***' PUT 'V ' PUT 'TABLICE ' PUT 'NE ' PUT 'UKAZAN ' PUT 'DIAMETR ' PUT 'DANDREA '
WRITE C
GOTO NPTU1

NP38
PUT '***' PUT 'V ' PUT 'TABLICE ' PUT 'UKAZAN ' PUT 'SLISHKOM ' PUT 'BOLSHOI ' PUT 'UGOL '
WRITE C
PUT 'ORIENTACII ' PUT 'PERVOGO ' PUT 'ZUBA ' PUT 'DLJA ' PUT 'DANDREA '
WRITE C
GOTO NPTU1

NP59
PUT '***' PUT 'V ' PUT 'PROGRAMME ' PUT 'ZAMERA ' PUT 'NE ' PUT 'VERNO ' PUT 'UKAZAN '
WRITE C
PUT 'KORRECTOR ' PUT 'NA ' PUT 'DLINNU ' PUT 'INSTRUMENTA '
WRITE C
PUT 'TOOL=' PUT PTN PUT '  GROUP=' PUT PTG
WRITE C
PUT 'KORRECTOR=' PUT PH
WRITE C
GOTO NEND

NP24
PUT '***' PUT 'IZNOS ' PUT 'DANDREA ' PUT 'PO ' PUT 'DLINNE '
WRITE C
GOTO NPTU1

NP25
PUT '***' PUT 'POLOMKA ' PUT 'DANDREA ' PUT 'PO ' PUT 'DLINNE '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
GOTO NPTU1

NP26
PUT '***' PUT 'POLOMKA ' PUT 'DANDREA ' PUT 'PO ' PUT 'DLINNE '
WRITE C
GOTO NPTU1

NP27
PUT '***' PUT 'NOVIi ' PUT 'DANDREA ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DLINNI '
WRITE C
GOTO NPTU1

NP28
PUT '***' PUT 'POPITKA ' PUT 'OBMANUT ' PUT 'SISTEMU '
WRITE C
PUT 'PROGRAMMA ' PUT 'BILA ' PUT 'ZAPUSHENA ' PUT 'S ' PUT 'SEREDINI '
WRITE C
PUT '***' PUT 'NOVIi ' PUT 'DANDREA ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DLINNI '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
GOTO NPTU1

NP29
PUT '***' PUT 'NOVIi ' PUT 'DANDREA ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DLINNI '
WRITE C
GOTO NPTU1

NP30
PUT '***' PUT 'IZNOS ' PUT 'DANDREA ' PUT 'PO ' PUT 'DIAMETRU '
WRITE C
GOTO NPTU1

NP31
PUT '***' PUT 'POLOMKA ' PUT 'DANDREA ' PUT 'PO ' PUT 'DIAMETRU '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
GOTO NPTU1

NP32
PUT '***' PUT 'POLOMKA ' PUT 'DANDREA ' PUT 'PO ' PUT 'DIAMETRU '
WRITE C
GOTO NPTU1

NP33
PUT '***' PUT 'NOVIi ' PUT 'DANDREA ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DIAMETRA '
WRITE C
GOTO NPTU1

NP34
PUT '***' PUT 'POPITKA ' PUT 'OBMANUT ' PUT 'SISTEMU '
WRITE C
PUT 'PROGRAMMA ' PUT 'BILA ' PUT 'ZAPUSHENA ' PUT 'S ' PUT 'SEREDINI '
WRITE C
PUT '***' PUT 'NOVIi ' PUT 'DANDREA ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DIAMETRA '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
GOTO NPTU1

NP35
PUT '***' PUT 'NOVIi ' PUT 'DANDREA ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI ' PUT 'DIAMETRA '
WRITE C
GOTO NPTU1

NP36
PUT '***' PUT 'PREVISHENA ' PUT 'KONUSNOST ' PUT 'OTVERSTIJA ' PUT 'PRI ' PUT 'IZMERENII ' PUT 'RENISHAW '
WRITE C
GOTO NPRD1

NP47
PUT '***' PUT 'PREVISHEN ' PUT 'DOPUSK ' PUT 'AVTOKOREKCII ' PUT 'RADIUSA ' PUT 'FREZI '
WRITE C
PUT 'PRI ' PUT 'IZMERENII ' PUT 'OTVERSTIJA ' PUT 'RENISHAW '
WRITE C
GOTO NPRD1

NP40
PUT '***' PUT 'PREVISHENA ' PUT 'KONUSNOST ' PUT 'BOBISHKI ' PUT 'PRI ' PUT 'IZMERENII ' PUT 'RENISHAW '
WRITE C
GOTO NPRD1

NP48
PUT '***' PUT 'PREVISHEN ' PUT 'DOPUSK ' PUT 'AVTOKOREKCII ' PUT 'RADIUSA ' PUT 'FREZI '
WRITE C
PUT 'PRI ' PUT 'IZMERENII ' PUT 'BOBISHKI ' PUT 'RENISHAW '
WRITE C
GOTO NPRD1

NP41
PUT '***' PUT 'PREVISHENA ' PUT 'KONUSNOST ' PUT 'PAZA ' PUT 'PRI ' PUT 'IZMERENII '
WRITE C
PUT 'RENISHAW ' PUT 'VDOL ' PUT 'OSI ' PUT 'X '
WRITE C
GOTO NPRD2

NP49
PUT '***' PUT 'PREVISHEN ' PUT 'DOPUSK ' PUT 'AVTOKOREKCII ' PUT 'RADIUSA ' PUT 'FREZI '
WRITE C
PUT 'PRI ' PUT 'IZMERENII ' PUT 'PAZA ' PUT 'RENISHAW ' PUT 'VDOL ' PUT 'OSI ' PUT 'X '
WRITE C
GOTO NPRD2

NP42
PUT '***' PUT 'PREVISHENA ' PUT 'KONUSNOST ' PUT 'VISTUPA ' PUT 'PRI ' PUT 'IZMERENII '
WRITE C
PUT 'RENISHAW ' PUT 'VDOL ' PUT 'OSI ' PUT 'X '
WRITE C
GOTO NPRD2

NP50
PUT '***' PUT 'PREVISHEN ' PUT 'DOPUSK ' PUT 'AVTOKOREKCII ' PUT 'RADIUSA ' PUT 'FREZI '
WRITE C
PUT 'PRI ' PUT 'IZMERENII ' PUT 'VISTUPA ' PUT 'RENISHAW ' PUT 'VDOL ' PUT 'OSI ' PUT 'X '
WRITE C
GOTO NPRD2

NP43
PUT '***' PUT 'PREVISHENA ' PUT 'KONUSNOST ' PUT 'PAZA ' PUT 'PRI ' PUT 'IZMERENII '
WRITE C
PUT 'RENISHAW ' PUT 'VDOL ' PUT 'OSI ' PUT 'Y '
WRITE C
GOTO NPRD2

NP51
PUT '***' PUT 'PREVISHEN ' PUT 'DOPUSK ' PUT 'AVTOKOREKCII ' PUT 'RADIUSA ' PUT 'FREZI '
WRITE C
PUT 'PRI ' PUT 'IZMERENII ' PUT 'PAZA ' PUT 'RENISHAW ' PUT 'VDOL ' PUT 'OSI ' PUT 'Y '
WRITE C
GOTO NPRD2

NP44
PUT '***' PUT 'PREVISHENA ' PUT 'KONUSNOST ' PUT 'VISTUPA ' PUT 'PRI ' PUT 'IZMERENII '
WRITE C
PUT 'RENISHAW ' PUT 'VDOL ' PUT 'OSI ' PUT 'Y '
WRITE C
GOTO NPRD2

NP52
PUT '***' PUT 'PREVISHEN ' PUT 'DOPUSK ' PUT 'AVTOKOREKCII ' PUT 'RADIUSA ' PUT 'FREZI '
WRITE C
PUT 'PRI ' PUT 'IZMERENII ' PUT 'VISTUPA ' PUT 'RENISHAW ' PUT 'VDOL ' PUT 'OSI ' PUT 'Y '
WRITE C
GOTO NPRD2

NP45
PUT '***' PUT 'PREVISHENA ' PUT 'KONUSNOST ' PUT 'STENKI ' PUT 'PRI ' PUT 'IZMERENII '
WRITE C
PUT 'RENISHAW ' PUT 'VDOL ' PUT 'OSI ' PUT 'X '
WRITE C
GOTO NPRP1

NP53
PUT '***' PUT 'PREVISHEN ' PUT 'DOPUSK ' PUT 'AVTOKOREKCII ' PUT 'RADIUSA ' PUT 'FREZI '
WRITE C
PUT 'PRI ' PUT 'IZMERENII ' PUT 'STENKI ' PUT 'RENISHAW ' PUT 'VDOL ' PUT 'OSI ' PUT 'X '
WRITE C
GOTO NPRP1

NP46
PUT '***' PUT 'PREVISHENA ' PUT 'KONUSNOST ' PUT 'STENKI ' PUT 'PRI ' PUT 'IZMERENII '
WRITE C
PUT 'RENISHAW ' PUT 'VDOL ' PUT 'OSI ' PUT 'Y '
WRITE C
GOTO NPRP1

NP54
PUT '***' PUT 'PREVISHEN ' PUT 'DOPUSK ' PUT 'AVTOKOREKCII ' PUT 'RADIUSA ' PUT 'FREZI '
WRITE C
PUT 'PRI ' PUT 'IZMERENII ' PUT 'STENKI ' PUT 'RENISHAW ' PUT 'VDOL ' PUT 'OSI ' PUT 'Y '
WRITE C
GOTO NPRP1

NP55
PUT '***' PUT 'PREVISHEN ' PUT 'DOPUSK ' PUT 'AVTOKOREKCII ' PUT 'DLINNI ' PUT 'FREZI '
WRITE C
PUT 'PRI ' PUT 'IZMERENII ' PUT 'PLOSKOSTI ' PUT 'RENISHAW ' PUT 'VDOL ' PUT 'OSI ' PUT 'Z '
WRITE C
PUT 'INSTRUMENT ' PUT 'ZABLOKIROVAN, ' PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
PUT 'TEOR. ' PUT 'RAZMER ' PUT 'DLJA ' PUT 'IZMERENIJA ' PUT 'Z=' PUT PM
WRITE C
PUT 'FAKT. ' PUT 'RAZMER ' PUT 'Z=' PUT PZ3
WRITE C
PUT 'POPITKA ' PUT 'KOREKCII ' PUT 'DLINNI ' PUT 'FREZI ' PUT 'NA=' PUT PWZ PUT ' MM '
WRITE C
PUT 'DOPUSK ' PUT 'KOREKCII ' PUT 'DLINNI ' PUT 'FREZI=' PUT PWZ1 PUT ' MM '
WRITE C
PUT 'TOOL=' PUT PSTN PUT '  GROUP=' PUT PSTG
WRITE C
CALL OPHWR PH=PH PDH=1 PCW=2 PCT=PCT
G04 F0.1
PSV1=VC902
CALL OPHWR PH=PH PDH=2 PCW=2 PCT=PCT
G04 F0.1
PSV2=VC902

PSV5=VIU3[PCT]
PSV6=VIU4[PCT]
CALL OPHWW PH=PH PDH=1 PVAL=0 PCT=PCT
CALL OPHWW PH=PH PDH=2 PVAL=0 PCT=PCT

VIU1[PCT]=0
VIU2[PCT]=0
VIU3[PCT]=0
VIU4[PCT]=0

PSV3=VTOFH[PCT]
PSV4=VTOFD[PCT]

PSV7=VTOH3[PCT]
PSV8=VTOD3[PCT]

CALL OPHWW PH=PH PDH=1 PVAL=PSV1 PCT=PCT
CALL OPHWW PH=PH PDH=2 PVAL=PSV2 PCT=PCT
VIU3[PCT]=PSV5
VIU4[PCT]=PSV6
PUT 'L=' PUT PSV3 PUT '  IZNOS='  PUT PSV1
WRITE C
PUT 'D=' PUT PSV4 PUT '  IZNOS='  PUT PSV2
WRITE C
IF [PSV7 EQ 0] GOTO NXT11
PUT 'SMESHENIE ' PUT 'DLINNI ' PUT 'DO ' PUT 'VIRT. ' PUT 'PERESECHENIJA=' PUT PSV7
WRITE C

NXT11
IF [PSV8 EQ 0] GOTO NXT12

NXT12
PUT 'OST.=' PUT VTLD8[PCT] PUT ' MINUT  IZ=' PUT VTLD7[PCT] PUT '  OTR. V OP.=' PUT VC296
WRITE C
GOTO NEND

NP37
PUT '***' PUT 'NE ' PUT 'VOZMOGNO ' PUT 'ISPOLSOVAT ' PUT 'FREZERNII ' PUT 'VID '
WRITE C
PUT 'IZMERENIJA ' PUT 'RENISHAW ' PUT 'S ' PUT 'DANDREA '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
PUT 'TOOL=' PUT PSTN PUT '  GROUP=' PUT PSTG
WRITE C
GOTO NEND

NP64
CALL OPTF PTOL=0
PUT 'NEVERNIE ' PUT 'DLINA ' PUT 'ILI ' PUT 'DIAMETR ' PUT 'INSTRYMENTA'
WRITE C
PUT 'D= ' PUT VC555
WRITE C
PUT 'INSTRYMENT ' PUT 'ZABLOKIROVAN '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
PUT 'TOOL=' PUT VC900 PUT '  GROUP=' PUT VTLGN[VTLCN]
WRITE C
GOTO NEND

NP501
CALL OPTF PTOL=0
PUT 'WRONG ' PUT 'INPUT ' PUT 'DATA ' PUT 'OCRS ' PUT ' PH '
WRITE C
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
PUT 'TOOL=' PUT VC900 PUT '  GROUP=' PUT VTLGN[VTLCN]
WRITE C
GOTO NEND

NP202
IF [VC285 EQ 1] GOTO NPP1
IF [VC285 EQ 2] GOTO NPP2
IF [VC285 EQ 3] GOTO NPP3
IF [VC285 EQ 4] GOTO NPP4
IF [VC285 EQ 5] GOTO NPP5
IF [VC285 EQ 6] GOTO NPP6
GOTO NPP13

NPP1
PUT 'OTVERSTIE ' PUT 'ILI ' PUT 'BOBISHKA '
GOTO NPP13

NPP2
PUT 'PAZ ' PUT 'ILI ' PUT 'VISTUP ' PUT 'VDOL ' PUT 'OSI ' PUT 'X '
GOTO NPP13

NPP3
PUT 'PAZ ' PUT 'ILI ' PUT 'VISTUP ' PUT 'VDOL ' PUT 'OSI ' PUT 'Y '
GOTO NPP13

NPP4
PUT 'STENKA ' PUT 'IZMERENIE ' PUT 'VDOL ' PUT 'OSI ' PUT 'X '
GOTO NPP13

NPP5
PUT 'STENKA ' PUT 'IZMERENIE ' PUT 'VDOL ' PUT 'OSI ' PUT 'Y '
GOTO NPP13

NPP6
PUT 'PLOSKOST ' PUT 'IZMERENIE ' PUT 'VDOL ' PUT 'OSI ' PUT 'Z '
GOTO NPP13

NPP13
PUT 'AVTO-KOREKCIJA ' PUT 'RADIUSA ' PUT 'FREZI ' PUT 'NA=' PUT PDW PUT ' MM '
WRITE C
PUT 'TEOR. ' PUT 'RAZM. ' PUT 'DLJA ' PUT 'IZMERENIJA=' PUT PM
WRITE C
IF [PD1 EQ 9999] GOTO NXT72
PUT 'FAKT. ' PUT 'RAZM. ' PUT 'No.1=' PUT PD1 PUT '  NA ' PUT 'GLUBINE=' PUT PZ1
WRITE C
GOTO NXT91
NXT72
PUT 'FAKT. ' PUT 'RAZM. ' PUT 'No.1=' PUT PP1 PUT '  NA ' PUT 'GLUBINE=' PUT PZ1
WRITE C
NXT91
IF [VC11 EQ 9999] GOTO NXT85
PUT 'FAKT. ' PUT 'CENTR ' PUT '   X=' PUT VC11
WRITE C
NXT85
IF [VC12 EQ 9999] GOTO NXT86
PUT 'FAKT. ' PUT 'CENTR ' PUT '   Y=' PUT VC12
WRITE C
NXT86
IF [PZ2 EQ 0] GOTO NXT89
IF [PD1 EQ 9999] GOTO NXT92
PUT 'FAKT. ' PUT 'RAZM. ' PUT 'No.2=' PUT PD2 PUT '  NA ' PUT 'GLUBINE=' PUT PZ2
WRITE C
GOTO NXT93
NXT92
PUT 'FAKT. ' PUT 'RAZM. ' PUT 'No.2=' PUT PP2 PUT '  NA ' PUT 'GLUBINE=' PUT PZ2
WRITE C
NXT93
IF [VC13 EQ 9999] GOTO NXT87
PUT 'FAKT. ' PUT 'CENTR ' PUT '   X=' PUT VC13
WRITE C
NXT87
IF [VC14 EQ 9999] GOTO NXT88
PUT 'FAKT. ' PUT 'CENTR ' PUT '   Y=' PUT VC14
WRITE C
NXT88
PUT 'FAKT.  ' PUT 'KONUSNOST =' PUT PCO2
WRITE C
PUT 'DOPUSK ' PUT 'KONUSNOSTi=' PUT PCO1
WRITE C
IF [PD3 EQ 9999] GOTO NXT94
PUT 'FAKT. ' PUT 'SREDN ' PUT 'RAZM=' PUT PD3
WRITE C
GOTO NXT89
NXT94
IF [PP3 EQ 9999] GOTO NXT89
PUT 'FAKT. ' PUT 'SREDN ' PUT 'RAZM=' PUT PP3
WRITE C
NXT89
PUT 'TOOL=' PUT PSTN PUT '  GROUP=' PUT PSTG
WRITE C

CALL OPHWR PH=PH PDH=1 PCW=2 PCT=PCT
G04 F0.1
PSV1=VC902
CALL OPHWR PH=PH PDH=2 PCW=2 PCT=PCT
G04 F0.1
PSV2=VC902

PSV5=VIU3[VTLCN]
PSV6=VIU4[VTLCN]

CALL OPHWW PH=PH PDH=1 PVAL=0 PCT=PCT
CALL OPHWW PH=PH PDH=2 PVAL=0 PCT=PCT

VIU3[VTLCN]=0
VIU4[VTLCN]=0

CALL OPHWR PH=PH PDH=1 PCW=1 PCT=PCT
G04 F0.1
PSV3=VC902
CALL OPHWR PH=PH PDH=2 PCW=1 PCT=PCT
G04 F0.1
PSV4=VC902

PSV7=VTOH3[VTLCN]
PSV8=VIU4[VTLCN]

CALL OPHWW PH=PH PDH=1 PVAL=PSV1 PCT=PCT
CALL OPHWW PH=PH PDH=2 PVAL=PSV2 PCT=PCT

VIU3[VTLCN]=PSV5
VIU4[VTLCN]=PSV6
PUT 'D=' PUT PSV4 PUT '  IZNOS='  PUT PSV2
WRITE C
IF [PSV7 EQ 0] GOTO NXT34
PUT 'SMESCHENIE ' PUT 'DLINNI ' PUT 'DO ' PUT 'VIRT. ' PUT 'PERESECHENIJA=' PUT PSV7
WRITE C
NXT34
IF [PSV8 EQ 0] GOTO NXT35
PUT 'UGOL ' PUT 'ORIENTACII ' PUT 'PERVOGO ' PUT 'ZUBA=' PUT PSV8
WRITE C
NXT35
PUT 'OST.=' PUT VTLD8[VTLCN] PUT ' MINUT  IZ=' PUT VTLD7[VTLCN] PUT '  OTR. V OP.=' PUT VC296
WRITE C
GOTO NEND

NPTF1 (INF O FREZ INSTRUMENTE)
PSTN=PTN 
PSTG=PTG
PUT 'TOOL=' PUT PSTN PUT '  GROUP=' PUT PSTG
WRITE C

IF [VTWOH[VTLCN] NE 0] GOTO NPSV1
VTWOH[VTLCN]=VC971

NPSV1
VC964=PIZM
IF [PIZM GT 1] GOTO NIF12
GOTO NPSV2

NIF12
VC286=VC961
VC287=VC962
NPSV2
PSV1=VTWOH[VTLCN]
PSV2=VTWOD[VTLCN]

PSV5=VIU3[VTLCN]
PSV6=VIU4[VTLCN]

VTWOH[VTLCN]=0
VTWOD[VTLCN]=0
VIU3[VTLCN]=0
VIU4[VTLCN]=0

PSV3=VTOFH[VTLCN]
PSV4=VTOFD[VTLCN]

PSV7=VTOH3[VTLCN]
PSV8=VIU4[VTLCN]

VTWOH[VTLCN]=PSV1
VTWOD[VTLCN]=PSV2

VIU3[VTLCN]=PSV5
VIU4[VTLCN]=PSV6

PUT 'L=' PUT PSV3 PUT '  IZNOS ' PUT 'NEW=' PUT PSV1 PUT '  OLD=' PUT VC286
WRITE C
PUT 'D=' PUT PSV4 PUT '  IZNOS ' PUT 'NEW=' PUT PSV2 PUT '  OLD=' PUT VC287
WRITE C
IF [PSV7 EQ 0] GOTO NXT14
PUT 'SMESHENIE ' PUT 'DLINNI ' PUT 'DO ' PUT 'VIRT. ' PUT 'PERESECHENIJA=' PUT PSV7
WRITE C
NXT14
IF [PSV8 EQ 0] GOTO NXT20
PUT 'UGOL ' PUT 'ORIENTACII ' PUT 'PERVOGO ' PUT 'ZUBA=' PUT PSV8
WRITE C
NXT20
PUT 'DOPUSKI: ' PUT 'OPTIKA=' PUT VC221 PUT '  IZNOS=' PUT VC219 PUT '  POLOMKA=' PUT VC220
WRITE C
PUT 'OST.=' PUT VTLD8[VTLCN] PUT ' MINUT  IZ=' PUT VTLD7[VTLCN] PUT '  OTR. V OP.=' PUT VC296
WRITE C
GOTO NEND

NPTU1 (INF O DANDREA)
PUT 'TOOL=' PUT PSTN PUT '  GROUP=' PUT PSTG
WRITE C

VC964=PIZM
IF [PIZM GT 1] GOTO NIF13
GOTO NPSV3
NIF13
VC975=VC961
VC971=VC962
NPSV3
PSV1=VTWOH[VTLCN]
PSV2=VIU5[VTLCN]-VTOH2[VTLCN]
PSV5=VIU3[VTLCN]
PSV6=VIU4[VTLCN]
VTWOH[VTLCN]=0
VIU1[VTLCN]=0
VIU3[VTLCN]=0
VIU4[VTLCN]=0
PSV3=VTOFH[VTLCN]
PSV4=VIU5[VTLCN]
PSV7=VTOH3[VTLCN]
PSV8=VIU4[VTLCN]
VTWOH[VTLCN]=PSV1
VIU1[VTLCN]=PSV2
VIU3[VTLCN]=PSV5
VIU4[VTLCN]=PSV6

PUT 'L=' PUT PSV4 PUT '  IZNOS ' PUT 'NEW=' PUT PSV2 PUT '  OLD=' PUT VC975
WRITE C
PUT 'D=' PUT VC970 PUT '  IZNOS ' PUT 'NEW=' PUT PSV1 PUT '  OLD=' PUT VC971
WRITE C
IF [VC900 LT 9000000] GOTO NXT32
PUT 'ZNACHENIE ' PUT 'KOMPENSACII ' PUT 'LUFTA ' PUT 'NA ' PUT 'DIAMETR='
PUT VBLCU
WRITE C
NXT21
IF [PSV8 EQ 0] GOTO NXT22
PUT 'UGOL ' PUT 'ORIENTACII ' PUT 'PERVOGO ' PUT 'ZUBA=' PUT VSTOH[1]
WRITE C
NXT22
IF [PA EQ 57] GOTO NXT15
PUT 'DOPUSKI: ' PUT 'OPTIKA=' PUT VC221 PUT '  IZNOS=' PUT VC219 PUT '  POLOMKA=' PUT VC220
WRITE C
NXT15
PUT 'OST.=' PUT VTLD8[VTLCN] PUT ' MINUT  IZ=' PUT VTLD7[VTLCN] PUT '  OTR. V OP.=' PUT VC296
WRITE C
GOTO NEND

NPRD1 (INF OCRS DIAMETRI INF O FREZ INSTRUMENTE)
PUT 'INSTRUMENT ' PUT 'ZABLOKIROVAN, ' PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
PUT 'POPITKA ' PUT 'KOREKCII ' PUT 'RADIUSA ' PUT 'FREZI ' PUT 'NA=' PUT PDW PUT ' MM '
WRITE C
PUT 'DOPUSK  ' PUT 'KOREKCII ' PUT 'RADIUSA ' PUT 'FREZI=' PUT PWR1 PUT ' MM '
WRITE C
PUT 'TEOR. ' PUT 'DIAM. ' PUT 'DLJA ' PUT 'IZMERENIJA=' PUT PM
WRITE C
PUT 'FAKT. ' PUT 'DIAM. ' PUT 'No.1=' PUT PD1 PUT '  NA ' PUT 'GLUBINE=' PUT PZ1
WRITE C
PUT 'FAKT. ' PUT 'CENTR ' PUT 'No.1=' PUT 'X=' PUT VC11 PUT '  Y=' PUT VC12
WRITE C
IF [PZ2 EQ 0] GOTO NXT95
PUT 'FAKT. ' PUT 'DIAM. ' PUT 'No.2=' PUT PD2 PUT '  NA ' PUT 'GLUBINE=' PUT PZ2
WRITE C
PUT 'FAKT. ' PUT 'CENTR ' PUT 'No.2=' PUT 'X=' PUT VC13 PUT '  Y=' PUT VC14
WRITE C
PUT 'FAKT. ' PUT 'SREDNIi ' PUT 'DIAM.=' PUT PD3
WRITE C
PUT 'FAKT. ' PUT 'KONUSNOST=' PUT PCO2
WRITE C
PUT 'DOPUSK ' PUT 'KONUSNOSTI=' PUT PCO1
WRITE C
NXT95
PUT 'TOOL=' PUT PSTN PUT '  GROUP=' PUT PSTG
WRITE C

CALL OPHWR PH=PH PDH=1 PCW=2 PCT=PCT
G04 F0.1
PSV1=VC902
CALL OPHWR PH=PH PDH=2 PCW=2 PCT=PCT
G04 F0.1
PSV2=VC902

PSV5=VIU3[PCT]
PSV6=VIU4[PCT]

CALL OPHWW PH=PH PDH=1 PVAL=0 PCT=PCT
CALL OPHWW PH=PH PDH=2 PVAL=0 PCT=PCT

VIU3[PCT]=0
VIU4[PCT]=0

CALL OPHWR PH=PH PDH=1 PCW=1 PCT=PCT
G04 F0.1
PSV3=VC902
CALL OPHWR PH=PH PDH=2 PCW=1 PCT=PCT
G04 F0.1
PSV4=VC902

PSV7=VTOH3[PCT]
PSV8=VTOD3[PCT]

CALL OPHWW PH=PH PDH=1 PVAL=PSV1 PCT=PCT
CALL OPHWW PH=PH PDH=2 PVAL=PSV2 PCT=PCT

VIU3[PCT]=PSV5
VIU4[PCT]=PSV6
PUT 'L=' PUT PSV3 PUT '  IZNOS='  PUT PSV1
WRITE C
PUT 'D=' PUT PSV4 PUT '  IZNOS='  PUT PSV2
WRITE C
IF [PSV7 EQ 0] GOTO NXT23
PUT 'SMESHENIE ' PUT 'DLINNI ' PUT 'DO ' PUT 'VIRT. ' PUT 'PERESECHENIJA=' PUT PSV7
WRITE C
NXT23
IF [PSV8 EQ 0] GOTO NXT24
PUT 'UGOL ' PUT 'ORIENTACII ' PUT 'PERVOGO ' PUT 'ZUBA=' PUT PSV8
WRITE C
NXT24
PUT 'OST.=' PUT VTLD8[PCT] PUT ' MINUT  IZ=' PUT VTLD7[PCT] PUT '  OTR. V OP.=' PUT VC296
WRITE C
GOTO NEND

NPRD2 (INF OCRS PAZIKI INF O FREZ INSTRUMENTE)
PUT 'INSTRUMENT ' PUT 'ZABLOKIROVAN, ' PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
PUT 'POPITKA ' PUT 'KOREKCII ' PUT 'RADIUSA ' PUT 'FREZI ' PUT 'NA=' PUT PDW PUT ' MM '
WRITE C
PUT 'DOPUSK  ' PUT 'KOREKCII ' PUT 'RADIUSA ' PUT 'FREZI=' PUT PWR1 PUT ' MM '
WRITE C
PUT 'TEOR. ' PUT 'SHIRINA ' PUT 'DLJA ' PUT 'IZMERENIJA=' PUT PM
WRITE C
PUT 'FAKT. ' PUT 'SHIRINA ' PUT 'No.1=' PUT PP1 PUT '  NA ' PUT 'GLUBINE=' PUT PZ1
WRITE C
IF [VC11 EQ 9999] GOTO NX85
PUT 'FAKT. ' PUT 'CENTR ' PUT '   X=' PUT VC11
WRITE C
NX85
IF [VC12 EQ 9999] GOTO NX86
PUT 'FAKT. ' PUT 'CENTR ' PUT '   Y=' PUT VC12
WRITE C
NX86
IF [PZ2 EQ 0] GOTO NXT95
PUT 'FAKT. ' PUT 'SHIRINA ' PUT 'No.2=' PUT PP2 PUT '  NA ' PUT 'GLUBINE=' PUT PZ2
WRITE C
IF [VC13 EQ 9999] GOTO NX87
PUT 'FAKT. ' PUT 'CENTR ' PUT '   X=' PUT VC13
WRITE C
NX87
IF [VC14 EQ 9999] GOTO NX88
PUT 'FAKT. ' PUT 'CENTR ' PUT '   Y=' PUT VC14
WRITE C
NX88
PUT 'FAKT. ' PUT 'SRED. ' PUT 'SHIRINA=' PUT PP3 
WRITE C
PUT 'FAKT. ' PUT 'KONUSNOST=' PUT PCO2
WRITE C
PUT 'DOPUSK ' PUT 'KONUSNOSTI=' PUT PCO1
WRITE C
NXT95
PUT 'TOOL=' PUT PSTN PUT '  GROUP=' PUT PSTG
WRITE C

CALL OPHWR PH=PH PDH=1 PCW=2 PCT=PCT
G04 F0.1
PSV1=VC902
CALL OPHWR PH=PH PDH=2 PCW=2 PCT=PCT
G04 F0.1
PSV2=VC902

PSV5=VIU3[PCT]
PSV6=VIU4[PCT]

CALL OPHWW PH=PH PDH=1 PVAL=0 PCT=PCT
CALL OPHWW PH=PH PDH=2 PVAL=0 PCT=PCT

VIU3[PCT]=0
VIU4[PCT]=0

CALL OPHWR PH=PH PDH=1 PCW=1 PCT=PCT
G04 F0.1
PSV3=VC902
CALL OPHWR PH=PH PDH=2 PCW=1 PCT=PCT
G04 F0.1
PSV4=VC902

PSV7=VTOH3[PCT]
PSV8=VTOD3[PCT]

CALL OPHWW PH=PH PDH=1 PVAL=PSV1 PCT=PCT
CALL OPHWW PH=PH PDH=2 PVAL=PSV2 PCT=PCT

VIU3[PCT]=PSV5
VIU4[PCT]=PSV6
PUT 'L=' PUT PSV3 PUT '  IZNOS='  PUT PSV1
WRITE C
PUT 'D=' PUT PSV4 PUT '  IZNOS='  PUT PSV2
WRITE C
IF [PSV7 EQ 0] GOTO NXT23
PUT 'SMESHENIE ' PUT 'DLINNI ' PUT 'DO ' PUT 'VIRT. ' PUT 'PERESECHENIJA=' PUT PSV7
WRITE C
NXT23
IF [PSV8 EQ 0] GOTO NXT24
PUT 'UGOL ' PUT 'ORIENTACII ' PUT 'PERVOGO ' PUT 'ZUBA=' PUT PSV8
WRITE C
NXT24
PUT 'OST.=' PUT VTLD8[PCT] PUT ' MINUT  IZ=' PUT VTLD7[PCT] PUT '  OTR. V OP.=' PUT VC296
WRITE C
GOTO NEND

NPRP1 (INF OCRS STENKI INF O FREZ INSTRUMENTE)
PUT 'INSTRUMENT ' PUT 'ZABLOKIROVAN, ' PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
PUT 'POPITKA ' PUT 'KOREKCII ' PUT 'RADIUSA ' PUT 'FREZI ' PUT 'NA=' PUT PDW PUT ' MM '
WRITE C
PUT 'DOPUSK  ' PUT 'KOREKCII ' PUT 'RADIUSA ' PUT 'FREZI=' PUT PWR1 PUT ' MM '
WRITE C
PUT 'RAZMER ' PUT 'DLJA ' PUT 'IZMERENIJA=' PUT PM
WRITE C
PUT 'FAKT. ' PUT 'RAZMER ' PUT 'No.1=' PUT PP1 PUT '  NA ' PUT 'GLUBINE=' PUT PZ1
WRITE C
IF [PZ2 EQ 0] GOTO NXT9
PUT 'FAKT. ' PUT 'RAZMER ' PUT 'No.2=' PUT PP2 PUT '  NA ' PUT 'GLUBINE=' PUT PZ2
WRITE C
PUT 'FAKT. ' PUT 'SREDNIi ' PUT 'RAZMER=' PUT PP3
WRITE C
PUT 'DOPUSK ' PUT 'KONUSNOSTI=' PUT PCO1
WRITE C
PUT 'FAKT. ' PUT 'KONUSNOST=' PUT PCO2
WRITE C
NXT9
PUT 'TOOL=' PUT PSTN PUT '  GROUP=' PUT PSTG
WRITE C

CALL OPHWR PH=PH PDH=1 PCW=2 PCT=PCT
G04 F0.1
PSV1=VC902
CALL OPHWR PH=PH PDH=2 PCW=2 PCT=PCT
G04 F0.1
PSV2=VC902

PSV5=VIU3[PCT]
PSV6=VIU4[PCT]

CALL OPHWW PH=PH PDH=1 PVAL=0 PCT=PCT
CALL OPHWW PH=PH PDH=2 PVAL=0 PCT=PCT

VIU3[PCT]=0
VIU4[PCT]=0

CALL OPHWR PH=PH PDH=1 PCW=1 PCT=PCT
G04 F0.1
PSV3=VC902
CALL OPHWR PH=PH PDH=2 PCW=1 PCT=PCT
G04 F0.1
PSV4=VC902

PSV7=VTOH3[PCT]
PSV8=VTOD3[PCT]

CALL OPHWW PH=PH PDH=1 PVAL=PSV1 PCT=PCT
CALL OPHWW PH=PH PDH=2 PVAL=PSV2 PCT=PCT

VIU3[PCT]=PSV5
VIU4[PCT]=PSV6
PUT 'L=' PUT PSV3 PUT '  IZNOS='  PUT PSV1
WRITE C
PUT 'D=' PUT PSV4 PUT '  IZNOS='  PUT PSV2
WRITE C
IF [PSV7 EQ 0] GOTO NXT25
PUT 'SMESHENIE ' PUT 'DLINNI ' PUT 'DO ' PUT 'VIRT. ' PUT 'PERESECHENIJA=' PUT PSV7
WRITE C
NXT25
IF [PSV8 EQ 0] GOTO NXT26
PUT 'UGOL ' PUT 'ORIENTACII ' PUT 'PERVOGO ' PUT 'ZUBA=' PUT PSV8
WRITE C
NXT26
PUT 'OST.=' PUT VTLD8[PCT] PUT ' MINUT  IZ=' PUT VTLD7[PCT] PUT '  OTR. V OP.=' PUT VC296
WRITE C

NEND
IF [PA EQ 201] GOTO NEXT7
IF [PAA EQ 0] GOTO NEXT7
PUT '*************** ' PUT '*************** ' PUT '*************** ' PUT '*************** '

NEXT7
WRITE C
CLOSE C
RTS


N10053
OP01 (VIVOD OTCHETA OTOSL)
PMIN=VC212
PH=VC213
PTR=VC214
PX=VC215
PZ=VC216
PTZ=VC217
PTYP=VC218
PLE1=VC219
PLE2=VC220
PLE3=VC221
PA=VC222
PV=VC223
PTIM=VC224
PTN=VC225
PTG=VC226

VC1=PTN
VC2=PTG
VC3=PLE1
VC4=PLE2
VC5=PLE3
VC6=PTL
VC7=VTLCN

VPRT=12
MPR=1
PNPR=0 (NOMER PROGRAMMI)
VTWOH[1]=0
VTWOD[1]=0
CALL OPPOT PTG=998 PTS=1 (POISK V KAKOI JACHEIKE MAGAZINA INSTRUMENT, ZAPIS' V VC903)

IF [VTOH3[VC903] EQ 199.953] GOTO NMC1
IF [VTOH3[VC903] EQ 199.947] GOTO NMC2
GOTO NMC3
NMC1
FWRITC ALARM1.TXT;A
GOTO NEN2
NMC2
FWRITC ALARM2.TXT;A
GOTO NEN2
NMC3
FWRITC ALARM.TXT;A
NEN2
IF [PAA EQ 97] GOTO NP97 (OTOSL, FAKT IZNOS POSLE CHIST TOCHENIJA)

PUT 'Dat:' PUT VTIME[3] PUT '.' PUT VTIME[2] PUT '.' PUT VTIME[1]
PUT ' Tim:' PUT VTIME[4] PUT ':' PUT VTIME[5] PUT ':' PUT VTIME[6]
WRITE C
IF [VC292 EQ 0] GOTO NXT01
PUT '# ' PUT 'PALLETA ' PUT 'No. =' PUT VC292
WRITE C
NXT01

IF [VC289 EQ 0] GOTO NXT02
PUT 'NOMER ' PUT 'PEREHODA ' PUT 'IZ ' PUT 'NX CAM=' PUT VC289
WRITE C
NXT02

IF [PS EQ 0] GOTO NP000 (OCTS)
IF [PS EQ 1] GOTO NP001 (OCTE)
IF [PS EQ 2] GOTO NP002 (OCTI)

NP000
PUT 'DO ' PUT 'NACHALA ' PUT 'OBRABOTKI ' PUT 'V ' PUT 'CIKLE ' PUT '-> OCTS '
WRITE C
GOTO NPA

NP001
PUT 'POSLE ' PUT 'OBRABOTKI ' PUT 'V ' PUT 'CIKLE ' PUT '-> OCTE '
WRITE C
GOTO NPA

NP002
PUT '************** ' PUT '!!! OPASNO !!! ' PUT '************** '
WRITE C
PUT 'POSLE ' PUT 'OBRABOTKI ' PUT 'V ' PUT 'CIKLE ' PUT '-> OCTI '
WRITE C
IF [VIRD[01138] EQ 1] GOTO NP021 
IF [VIU4[VTLCN]EQ 0] GOTO  NP022
PUT 'FREZA ' PUT 'SLOMALAS ' PUT 'PRI ' PUT 'VIPOLNENII ' PUT 'CHISTOVOGO ' PUT 'RAZMERA '
WRITE C
GOTO NPA

NP022
PUT 'FREZA ' PUT 'SLOMALAS ' PUT 'PRI ' PUT 'VIPOLNENII ' PUT 'TEHNOLOGICHESK. ' PUT 'RAZMERA '
WRITE C
PUT 'DO ' PUT 'ZAMERA ' PUT 'RENISHAW '
WRITE C
GOTO NPA

NP021
IF [VIU4[VTLCN]EQ 0] GOTO NP023 
PUT 'POLOMKA ' PUT 'DANDREA ' PUT 'PRI ' PUT 'TOCHENII ' PUT 'CHISTOVOGO ' PUT 'DIAMETRA '
WRITE C
GOTO NPA

NP023
PUT 'POLOMKA ' PUT 'DANDREA ' PUT 'PRI ' PUT 'TOCHENII ' PUT 'TEHNOLOGICHESK. ' PUT 'DIAMETRA '
WRITE C
PUT 'DO ' PUT 'ZAMERA ' PUT 'RENISHAW '
WRITE C
GOTO NPA

NPA
IF [PAA EQ 1] GOTO NP01 (OTOSL, V TABLICE NE UKAZANA DLINA INSTRUMENTA, INSTRUMENT ZABLOKIROVAN)
IF [PAA EQ 2] GOTO NP02 (OTOSL, V TABLICE NE UKAZAN RADIUS INSTRUMENTA, INSTRUMENT ZABLOKIROVAN)
IF [PAA EQ 3] GOTO NP03 (OTOSL, V TABLICE NE UKAZANA DLINA DANDREA, INSTRUMENT ZABLOKIROVAN)
IF [PAA EQ 4] GOTO NP04 (OTOSL, V TABLICE NE UKAZAN DIAMETR DANDREA, INSTRUMENT ZABLOKIROVAN)
IF [PAA EQ 5] GOTO NP05 (OTOSL, POLOMKA ZUBA POSLE OCTE/OCTI)
IF [PAA EQ 6] GOTO NP06 (OTOSL, IZNOS ZUBA POSLE OCTS/OCTE)
IF [PAA EQ 7] GOTO NP07 (OTOSL, PREVISHEN DOPUSK OPTIKI OCTS)
IF [PAA EQ 8] GOTO NP08 (OTOSL, V PROGRAMME NE VERNO UKAZAN SPOSOB IZMERENIJA INSTRUMENTA, PAL. ZABL.)
IF [PAA EQ 9] GOTO NP09 (OTOSL, POLOMKA ZUBA POSLE OCTS)
IF [PAA EQ 11] GOTO NP11 (OPHWW, WRONG DATA INPUT)
IF [PAA EQ 12] GOTO NP12 (OPHWR, WRONG DATA INPUT)
IF [PAA EQ 98] GOTO NP98 (OMEAS, OSHIBKA BLUM)
IF [PAA EQ 99] GOTO NP99 (OCTS, NET PODHODJASHEGO INSTRUMENTA, PALLETA ZABLOKIROVANA)

(****************************)
NP01
PUT '***' PUT 'V ' PUT 'TABLICE ' PUT 'NEVERNO ' PUT 'UKAZANA ' PUT 'DLINA ' PUT 'INSTRUMENTA '
WRITE C
GOTO NPKR2
(****************************)
NP02
PUT '***' PUT 'V ' PUT 'TABLICE ' PUT 'NEVERNO ' PUT 'UKAZAN ' PUT 'RADIUS ' PUT 'INSTRUMENTA '
WRITE C
GOTO NPKR2
(****************************)

NP03
PUT '***' PUT 'V ' PUT 'TABLICE ' PUT 'NEVERNO ' PUT 'UKAZANA ' PUT 'DLINA ' PUT 'DANDREA '
WRITE C
GOTO NPKR2
(****************************)

NP04
PUT '***' PUT 'V ' PUT 'TABLICE ' PUT 'NEVERNO ' PUT 'UKAZAN ' PUT 'DIAMETR ' PUT 'DANDREA '
WRITE C
(****************************)

NPKR2
IF [VIRD[01138] EQ 1] GOTO NEX02
PUT 'MIN ' PUT 'DLINA= ' PUT '90'
WRITE C
PUT 'MAX ' PUT 'DLINA= ' PUT '400'
WRITE C
PUT 'MIN ' PUT 'RADIUS= ' PUT '0.25'
WRITE C
PUT 'MAX ' PUT 'RADIUS= ' PUT '120'
WRITE C
GOTO NPT
NEX02
PUT 'MIN ' PUT 'DLINA= ' PUT '280-OD/235-ID'
WRITE C
PUT 'MAX ' PUT 'DLINA= ' PUT '400'
WRITE C
PUT 'MIN ' PUT 'RADIUS= ' PUT '5-OD/-5-ID'
WRITE C
PUT 'MAX ' PUT 'RADIUS= ' PUT '120-OD/-150-ID'
WRITE C

GOTO NPT

NP05
IF [ABS[VC994] EQ ABS[VC980]] GOTO NVP994
PUT '***' PUT 'POLOMKA ' PUT 'INSTRUMENTA ' PUT 'PO ' PUT 'DLINE'
WRITE C
GOTO NIP5
NVP994
PUT '***' PUT 'POLOMKA ' PUT 'INSTRUMENTA ' PUT 'PO ' PUT 'RADIUSY'
WRITE C
NIP5
PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
GOTO NPT
(****************************)

NP06
PUT '***' PUT 'IZNOS ' PUT 'INSTRUMENTA ' PUT 'ZUBA ' 
WRITE C
GOTO NPT
(****************************)

NP07
PUT '***' PUT 'NOVIi ' PUT 'INSTRUMENT ' PUT 'PREVISIL ' PUT 'DOPUSK ' PUT 'OPTIKI '
WRITE C
GOTO NPT
(****************************)

NP08
PUT '***' PUT 'V ' PUT 'PROGRAMME ' PUT 'NE ' PUT 'VERNO ' PUT 'UKAZAN '
WRITE C
PUT 'SPOSOB ' PUT 'IZMERENIJA ' PUT 'INSTRUMENTA ' PUT 'TYPE=' VC991
WRITE C
PUT 'UKAZAN' PUT 'TYPE=' VC991
WRITE C
GOTO NPT
(****************************)

NP09
PUT '***' PUT 'POLOMKA ' PUT 'INSTRUMENTA ' 
WRITE C
GOTO NPT
(****************************)

NP11
PUT 'WRONG ' PUT 'DATA ' PUT 'INPUT ' PUT 'V ' PUT 'CIKLE ' PUT 'OPHWW'
WRITE C
IF [PVA EQ 1] GOTO NPVA1
IF [PVA EQ 2] GOTO NPVA2
IF [PVA EQ 3] GOTO NPVA3

NPVA1
PUT 'V ' PUT 'SPINDLE ' PUT 'NET ' PUT 'INSTRYMENTA'
WRITE C
GOTO NFN11
NPVA2
PUT 'NE ' PUT 'VERNO ' PUT 'YKAZAN ' PUT 'PH'
WRITE C
GOTO NFN11
NPVA3
PUT 'NE ' PUT 'VERNO ' PUT 'YKAZAN ' PUT 'PDH'
WRITE C
NFN11
GOTO NENDC
(****************************)

NP12
PUT 'WRONG ' PUT 'DATA ' PUT 'INPUT ' PUT 'V ' PUT 'CIKLE ' PUT 'OPHWR'
WRITE C
IF [PVA EQ 1] GOTO NPVA1
IF [PVA EQ 2] GOTO NPVA2
IF [PVA EQ 3] GOTO NPVA3
IF [PVA EQ 4] GOTO NPVA4

NPVA1
PUT 'V ' PUT 'SPINDLE ' PUT 'NET ' PUT 'INSTRYMENTA'
WRITE C
GOTO NFN12
NPVA2
PUT 'NE ' PUT 'VERNO ' PUT 'YKAZAN ' PUT 'PH'
WRITE C
GOTO NFN12
NPVA3
PUT 'NE ' PUT 'VERNO ' PUT 'YKAZAN ' PUT 'PDH'
WRITE C
GOTO NFN12
NPVA4
PUT 'NE ' PUT 'VERNO ' PUT 'YKAZAN ' PUT 'PCW'
WRITE C
NFN12
GOTO NENDC
(****************************)

NP97
PUT 'POSLE CHIST ' PUT 'IZNOS=' PUT PDU5
WRITE C
GOTO NENDC
(****************************)

NP98
PUT 'BLUM' PUT ' OSHIBKA' PUT ' NOMER=' PUT VC100 PUT ' PRI ZAMERE' PUT ' INSTRUMENTA ' 
WRITE C
GOTO NPT
(****************************)

NP99
PUT '***' PUT 'NET ' PUT 'PODHODJASHEGO ' PUT 'INSTRUMENTA ' PUT 'PALLETA ' PUT 'ZABLOKIROVANA '
WRITE C
PUT 'GRUPPA ' PUT 'INSTRUMENTA='  PUT PTG
WRITE C
PUT 'NEOBHODIMIi ' PUT 'SROK ' PUT 'SLUGBI ' PUT 'INSTRUMENTA=' PUT PMIN
WRITE C
GOTO NENDC
(****************************)

NETKA
(****************************)
NPT
IF [VIRD[01138] EQ 1] GOTO NPTU1
(****************************)
NPTF1 (INF O FREZ INSTRUMENTE)
CALL OPTF PTOL=0
PUT 'TOOL=' PUT VC900 PUT '  GROUP=' PUT VC899
WRITE C
VC964=PIZM
IF [PIZM GT 1] GOTO NIF12
GOTO NPSV2
NIF12
VC971=VC961
VC973=VC962
NPSV2
PUT 'L=' PUT VC970 PUT '  IZNOS ' PUT 'NEW=' PUT VC993 PUT '  OLD=' PUT VC971
WRITE C
VC994=VTWOD[VTLCN] (NEW WEAR DA FOR OP01)
PUT 'D=' PUT VC972 PUT '  IZNOS ' PUT 'NEW=' PUT VC994 PUT '  OLD=' PUT VC973
WRITE C
IF [VC991 NE 3] GOTO NWF1
PUT 'L2=' PUT VC974 PUT '  IZNOS ' PUT 'NEW=' PUT VIU1[VTLCN] PUT '  OLD=' PUT VC975
WRITE C
CALL OBIP
IF [ABS[VC985] GT ABS[VC986]] GOTO NWF1
IF [ABS[VC994] GT ABS[VC986]] GOTO NWF1
PUT 'MAX IZNOS' PUT ' PO' PUT ' L2=' PUT VIU1[VTLCN] 
WRITE C
GOTO NIF1
NWF1
IF [ABS[VC994] GT ABS[VC985]] GOTO NV994
PUT 'MAX IZNOS' PUT ' PO' PUT ' L=' PUT VC985 
WRITE C
GOTO NIF1
NV994
PUT 'MAX IZNOS' PUT ' PO' PUT ' D=' PUT VC994 
WRITE C

NIF1
IF [VC978 EQ 0] GOTO NTF2
PUT 'SMESHENIE ' PUT 'DLINNI ' PUT 'DO ' PUT 'VIRT. ' PUT 'PERESECHENIJA=' PUT VC978
WRITE C
NTF2
PUT 'DOPUSKI: ' PUT 'OPTIKA=' PUT PLE3 PUT '  IZNOS=' PUT PLE1 PUT '  POLOMKA=' PUT PLE2
WRITE C
PUT 'OST.=' PUT VTLD8[VTLCN] PUT ' MINUT  IZ=' PUT VTLD7[VTLCN] PUT '  OTR. V OP.=' PUT VC296
WRITE C
GOTO NEND

(****************************)
NPTU1 (INF O DANDREA)
PUT 'TOOL=' PUT VC900 PUT '  GROUP=' PUT PTG
WRITE C
IF [PIZM GT 1] GOTO NIF13
GOTO NPSV3
NIF13
VC975=VC961
VC971=VC962
NPSV3
PUT 'L=' PUT VC974 PUT '  IZNOS ' PUT 'NEW=' PUT VIU1[VTLCN] PUT '  OLD=' PUT VC975
WRITE C
PUT 'D=' PUT VC970 PUT '  IZNOS ' PUT 'NEW=' PUT VTWOH[VTLCN](VSTOD[40]) PUT '  OLD=' PUT VC971
WRITE C
IF [ABS[VSTOD[40]] GT ABS[VSTOD[42]]] GOTO NU994
VSTOD[38]=VTOH2[VTLCN]-VC974
PUT 'MAX IZNOS' PUT ' PO' PUT ' L=' PUT VSTOD[42]
WRITE C
GOTO NIFU1
NU994
VSTOD[38]=VTOFH[VTLCN]-VC970
PUT 'MAX IZNOS' PUT ' PO' PUT ' D=' PUT VSTOD[40]
WRITE C

NIFU1
IF [VC991 EQ 5] GOTO NTU1
IF [VC991 EQ 7] GOTO NTU1
GOTO NTU2
NTU1
PUT 'L2=' PUT VC978 PUT '  IZNOS ' PUT 'NEW=' PUT VIU3[VTLCN] PUT '  OLD=' PUT VC979
WRITE C
VSTOD[38]=VTOH3[VTLCN]-VC978
PUT 'MAX IZNOS' PUT ' PO' PUT ' L2=' PUT VSTOD[36]
WRITE C
NTU2
PUT 'ZNACHENIE ' PUT 'KOMPENSACII ' PUT 'LUFTA ' PUT 'NA ' PUT 'DIAMETR=' PUT VC[800+VTLCN]
WRITE C
PUT 'DOPUSKI: ' PUT 'OPTIKA=' PUT PLE3 PUT '  IZNOS=' PUT PLE1 PUT '  POLOMKA=' PUT PLE2
WRITE C
PUT 'OST.=' PUT VTLD8[VTLCN] PUT ' MINUT  IZ=' PUT VTLD7[VTLCN] PUT '  OTR. V OP.=' PUT VC296
WRITE C
(****************************)

NEND
IF [VC100 EQ 0] GOTO NENDA
IF [PAA EQ 98]GOTO NENDD
PUT 'BLUM ' PUT 'OSHIBKA ' PUT 'NOMER=' PUT VC100 PUT ' PRI ZAMERE' PUT ' INSTRUMENTA ' 
WRITE C
NENDD
PUT 'BLUM ' PUT 'ALARM- '
IF[VC100 EQ 1]GOTO N15
IF[VC100 EQ 2]GOTO N25
IF[VC100 EQ 3]GOTO N35
IF[VC100 EQ 4]GOTO N45
IF[VC100 EQ 5]GOTO N55
IF[VC100 EQ 6]GOTO N65
IF[VC100 EQ 7]GOTO N75
IF[VC100 EQ 8]GOTO N85
IF[VC100 EQ 9]GOTO N95
IF[VC100 EQ 10]GOTO N105
IF[VC100 EQ 11]GOTO N115
IF[VC100 EQ 12]GOTO N125
IF[VC100 EQ 13]GOTO N135
IF[VC100 EQ 14]GOTO N145
IF[VC100 EQ 15]GOTO N155
IF[VC100 EQ 16]GOTO N165
IF[VC100 EQ 17]GOTO N175
IF[VC100 EQ 18]GOTO N185
IF[VC100 EQ 19]GOTO N195
IF[VC100 EQ 20]GOTO N205
IF[VC100 EQ 21]GOTO N215
IF[VC100 EQ 22]GOTO N225
IF[VC100 EQ 23]GOTO N235
IF[VC100 GE 24]GOTO N245
IF[VC100 LT 0]GOTO N245
GOTO NOPRI1
N15  PUT 'Laser not ready'
GOTO NE999
N25  PUT 'No tool offset' PUT ' T0/D0'
GOTO NE999
N35  PUT 'Incorrect table' PUT ' parameter'
GOTO NE999
N45  PUT 'Incorrect call' PUT ' parameter'
GOTO NE999
N55  PUT 'Incorrect tool' PUT ' parameter'
GOTO NE999
N65  PUT 'Collision risk' PUT ' with Laser'
GOTO NE999

N75  PUT 'Tool data out' PUT ' of limit'
WRITE C
IF [VC555 GE 0] GOTO NE999 
PUT 'PRI ' PUT 'IZMERENII ' PUT 'OTRICATELNII ' PUT 'DIAMETR ' PUT 'INSTRYMENTA'
WRITE C
PUT 'D= ' PUT VC555
WRITE C
GOTO NE999

N85  PUT 'Error at start' PUT ' measuring block'
GOTO NE999
N95  PUT 'Measurement' PUT ' without' PUT ' trigger signal'
GOTO NE999
N105 PUT 'Deviation of' PUT ' meas. values' PUT ' > limit'
GOTO NE999
N115 PUT 'Thermal drift' PUT ' > limit'
GOTO NE999
N125 PUT 'Error during' PUT ' evaluation'
GOTO NE999
N135 PUT 'Incorrect' PUT ' spindle RPM'
GOTO NE999
N145 PUT 'Incorrect' PUT ' calibration-/' PUT 'TC-parameter'
GOTO NE999
N155 PUT 'Cutting edge' PUT ' broken'
GOTO NE999
N165 PUT 'Out of tolerance'
GOTO NE999
N175 PUT VC129 PUT 'invalid'
GOTO NE999
N185 PUT 'Incorrect scale' PUT ' unit G20/G21'
GOTO NE999
N195 PUT 'Tool broken'
GOTO NE999
N205 PUT 'Function not' PUT ' possible'
GOTO NE999
N215 PUT 'Unexpected' PUT ' trigger signal'
GOTO NE999
N225 PUT 'Reserved'
GOTO NE999
N235 PUT 'Reserved'
GOTO NE999
N245 PUT 'Incorrect ' PUT 'error number'

NE999
WRITE C
PUT 'BLUM -' PUT 'ZAMER ' PUT 'NE ' PUT 'PROIZVEDEN '
WRITE C
GOTO NENDC
NENDA
PUT 'BLUM-' PUT 'ZAMER '  PUT 'PROIZVEDEN ' PUT 'USPESHNO'
WRITE C
(****************************)
NENDC
PUT '*************** ' PUT '*************** ' PUT '*************** ' PUT '*************** '

WRITE C
CLOSE C
RTS
